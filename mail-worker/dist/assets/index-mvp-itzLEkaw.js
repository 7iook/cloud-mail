import{au as fl,av as Dl,aw as Tn,ax as Dn,ay as Rn,az as An,aA as Rl,aB as In,aC as Fn,b as He,a0 as Et,d as Fe,_ as lt,a as Ve,z as it,l as ie,c as Ze,aD as ya,V as Un,p as le,o as w,q as a,r as ze,j as Je,n as me,h as k,aj as Ea,w as Vt,aE as Xt,O as Ie,L as Jt,Y as Pn,e as P,g as s,Q as Ee,af as Te,a7 as e,aF as Nn,k as el,f as ee,i as _,t as G,H as na,m as tl,U as ba,N as aa,aG as Al,aH as Il,A,F as Ue,G as $e,aI as Fl,aJ as xa,J as Ot,K as Va,aK as Ul,X as ha,a1 as De,aL as Mn,aM as Ba,aN as zn,aO as On,aP as Bn,aQ as jn,aR as qn,aS as Pl,M as Tt,D as Ya,aT as Yn,aU as Wn,ak as Hn,aV as Gn,aW as Kn,C as Jn,E as _t,aX as Zn,I as al,aY as vl,aZ as Qn,P as Nl,at as Ct,ad as D,ag as st,a4 as Xn,a_ as Ml,a$ as ct,b0 as zl,B as Ol,b1 as ll,a6 as eo,b2 as to,b3 as ao,b4 as lo}from"./index-92mnh-J5.js";import{v as oa,u as no,g as oo,c as gl,r as Bl,a as so,b as St,d as Wa,e as jl,f as io,h as ql,i as ro,j as uo,k as mo,l as co,m as po,n as fo}from"./share-wibObi1U.js";import{E as ft}from"./el-overlay-jTA8uYnN.js";import{c as sa,k as nl,g as vo,a as Yl,b as go,d as yo,e as bo,i as ho,f as wo,E as Ca,h as $a}from"./el-table-column-uawMUA32.js";import{E as ka,a as ol}from"./el-checkbox-DpAuy9Ti.js";import"./el-tooltip-l0sNRNKZ.js";import{k as Wl,g as Hl,s as _o,b as Eo,c as sl,d as Gl,n as wa,i as xo,S as Vo,e as Co,a as Bt,E as $o}from"./el-tag-Dck20whD.js";import"./el-scrollbar-lgMH0mZQ.js";/* empty css                  *//* empty css                        */import{b as Kl,E as Jl,a as Zl}from"./el-dropdown-item-CgMmokvT.js";import{E as Sa,a as il,b as ko}from"./el-radio-DGAw60Lp.js";/* empty css                        *//* empty css                 */import{E as La}from"./el-input-number-Bip_U3ji.js";import{E as ia}from"./el-date-picker-panel-BKCkkkEQ.js";import{c as Ha,b as xt,E as jt,a as qt}from"./el-select-DGaDXl_M.js";import{I as oe}from"./iconify-VCTUy_UH.js";import{t as pt}from"./day-DI1_lKIq.js";import{a as So}from"./clipboard-utils-Bf-9Um4a.js";import{E as Lo}from"./el-splitter-panel-DXpPCo2G.js";import{E as ra}from"./el-empty-CKfYwwv3.js";import{u as To,E as Ql,a as Xl}from"./el-carousel-item-Bu3eEokz.js";import{E as da}from"./el-switch-CaWohBeo.js";import{E as Ta}from"./el-pagination-CxVfqRNt.js";import{g as en}from"./all-email-C1E0Fb3X.js";import{d as _a}from"./dayjs.min-BodJrPHb.js";import{E as rl}from"./el-alert-BN_NA9gX.js";import{_ as vt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{u as dl,f as ul,a as Ga,b as Do,E as gt,c as Ro}from"./index-CG9L6tLM.js";import{a as Ao,f as Io,d as Fo,t as Da}from"./index-ChZfA3gH.js";import{g as Uo,f as Po,U as tn,E as Dt}from"./vnode-DfneDD37.js";import{E as Xe}from"./index-B-u1Rqw0.js";import{e as an}from"./index-DzjioUTY.js";import{E as ln}from"./EmailDetailPane-CMJxr8Q_.js";import{u as nn}from"./email-9j19DGMK.js";import{E as No}from"./index-BZ5UP91G.js";import{E as Mo}from"./index-03zk_vof.js";import"./index-C8SbU5-9.js";import"./throttle-BQKBmdXm.js";import"./validator-Cw4sOcG_.js";import"./time-utils-8_bD8pZw.js";import"./index-UYGPyXpS.js";import"./el-skeleton-item-UTnpAQ6A.js";import"./email-highlight-utils-Dx-h0BtP.js";/* empty css                       */function zo(i,t){for(var l=-1,r=i==null?0:i.length;++l<r&&t(i[l],l,i)!==!1;);return i}function Oo(i,t,l){var r=-1,d=i.length;t<0&&(t=-t>d?0:d+t),l=l>d?d:l,l<0&&(l+=d),d=t>l?0:l-t>>>0,t>>>=0;for(var f=Array(d);++r<d;)f[r]=i[r+t];return f}function Bo(i,t){return i&&sa(t,Wl(t),i)}function jo(i,t){return i&&sa(t,nl(t),i)}function qo(i,t){return sa(i,Hl(i),t)}var Yo=Object.getOwnPropertySymbols,on=Yo?function(i){for(var t=[];i;)Ao(t,Hl(i)),i=vo(i);return t}:_o;function Wo(i,t){return sa(i,on(i),t)}function sn(i){return Eo(i,nl,on)}var Ho=Object.prototype,Go=Ho.hasOwnProperty;function Ko(i){var t=i.length,l=new i.constructor(t);return t&&typeof i[0]=="string"&&Go.call(i,"index")&&(l.index=i.index,l.input=i.input),l}function Jo(i,t){var l=t?Yl(i.buffer):i.buffer;return new i.constructor(l,i.byteOffset,i.byteLength)}var Zo=/\w*$/;function Qo(i){var t=new i.constructor(i.source,Zo.exec(i));return t.lastIndex=i.lastIndex,t}var yl=fl?fl.prototype:void 0,bl=yl?yl.valueOf:void 0;function Xo(i){return bl?Object(bl.call(i)):{}}var es="[object Boolean]",ts="[object Date]",as="[object Map]",ls="[object Number]",ns="[object RegExp]",os="[object Set]",ss="[object String]",is="[object Symbol]",rs="[object ArrayBuffer]",ds="[object DataView]",us="[object Float32Array]",ms="[object Float64Array]",cs="[object Int8Array]",ps="[object Int16Array]",fs="[object Int32Array]",vs="[object Uint8Array]",gs="[object Uint8ClampedArray]",ys="[object Uint16Array]",bs="[object Uint32Array]";function hs(i,t,l){var r=i.constructor;switch(t){case rs:return Yl(i);case es:case ts:return new r(+i);case ds:return Jo(i,l);case us:case ms:case cs:case ps:case fs:case vs:case gs:case ys:case bs:return go(i,l);case as:return new r;case ls:case ss:return new r(i);case ns:return Qo(i);case os:return new r;case is:return Xo(i)}}var ws="[object Map]";function _s(i){return Dl(i)&&sl(i)==ws}var hl=wa&&wa.isMap,Es=hl?Gl(hl):_s,xs="[object Set]";function Vs(i){return Dl(i)&&sl(i)==xs}var wl=wa&&wa.isSet,Cs=wl?Gl(wl):Vs,$s=1,ks=2,Ss=4,rn="[object Arguments]",Ls="[object Array]",Ts="[object Boolean]",Ds="[object Date]",Rs="[object Error]",dn="[object Function]",As="[object GeneratorFunction]",Is="[object Map]",Fs="[object Number]",un="[object Object]",Us="[object RegExp]",Ps="[object Set]",Ns="[object String]",Ms="[object Symbol]",zs="[object WeakMap]",Os="[object ArrayBuffer]",Bs="[object DataView]",js="[object Float32Array]",qs="[object Float64Array]",Ys="[object Int8Array]",Ws="[object Int16Array]",Hs="[object Int32Array]",Gs="[object Uint8Array]",Ks="[object Uint8ClampedArray]",Js="[object Uint16Array]",Zs="[object Uint32Array]",Ce={};Ce[rn]=Ce[Ls]=Ce[Os]=Ce[Bs]=Ce[Ts]=Ce[Ds]=Ce[js]=Ce[qs]=Ce[Ys]=Ce[Ws]=Ce[Hs]=Ce[Is]=Ce[Fs]=Ce[un]=Ce[Us]=Ce[Ps]=Ce[Ns]=Ce[Ms]=Ce[Gs]=Ce[Ks]=Ce[Js]=Ce[Zs]=!0;Ce[Rs]=Ce[dn]=Ce[zs]=!1;function ea(i,t,l,r,d,f){var v,g=t&$s,c=t&ks,x=t&Ss;if(l&&(v=d?l(i,r,d,f):l(i)),v!==void 0)return v;if(!Tn(i))return i;var E=Dn(i);if(E){if(v=Ko(i),!g)return yo(i,v)}else{var h=sl(i),N=h==dn||h==As;if(xo(i))return bo(i,g);if(h==un||h==rn||N&&!d){if(v=c||N?{}:ho(i),!g)return c?Wo(i,jo(v,i)):qo(i,Bo(v,i))}else{if(!Ce[h])return d?i:{};v=hs(i,h,g)}}f||(f=new Vo);var S=f.get(i);if(S)return S;f.set(i,v),Cs(i)?i.forEach(function(O){v.add(ea(O,t,l,O,i,f))}):Es(i)&&i.forEach(function(O,I){v.set(I,ea(O,t,l,I,i,f))});var W=x?c?sn:Co:c?nl:Wl,C=E?void 0:W(i);return zo(C||i,function(O,I){C&&(I=O,O=i[I]),Rn(v,I,ea(O,t,l,I,i,f))}),v}var Qs=4;function _l(i){return ea(i,Qs)}function Xs(i){var t=i==null?0:i.length;return t?i[t-1]:void 0}function ei(i,t){return t.length<2?i:An(i,Oo(t,0,-1))}function ti(i,t){return t=Rl(t,i),i=ei(i,t),i==null||delete i[In(Xs(t))]}function ai(i){return wo(i)?void 0:i}var li=1,ni=2,oi=4,si=Io(function(i,t){var l={};if(i==null)return l;var r=!1;t=Fn(t,function(f){return f=Rl(f,i),r||(r=f.length>1),f}),sa(i,sn(i),l),r&&(l=ea(l,li|ni|oi,ai));for(var d=t.length;d--;)ti(l,t[d]);return l});const ii=He({tag:{type:String,default:"div"},span:{type:Number,default:24},offset:{type:Number,default:0},pull:{type:Number,default:0},push:{type:Number,default:0},xs:{type:Fe([Number,Object]),default:()=>Et({})},sm:{type:Fe([Number,Object]),default:()=>Et({})},md:{type:Fe([Number,Object]),default:()=>Et({})},lg:{type:Fe([Number,Object]),default:()=>Et({})},xl:{type:Fe([Number,Object]),default:()=>Et({})}}),mn=Symbol("rowContextKey"),ri=Ve({name:"ElCol"}),di=Ve({...ri,props:ii,setup(i){const t=i,{gutter:l}=it(mn,{gutter:ie(()=>0)}),r=Ze("col"),d=ie(()=>{const v={};return l.value&&(v.paddingLeft=v.paddingRight=`${l.value/2}px`),v}),f=ie(()=>{const v=[];return["span","offset","pull","push"].forEach(x=>{const E=t[x];ya(E)&&(x==="span"?v.push(r.b(`${t[x]}`)):E>0&&v.push(r.b(`${x}-${t[x]}`)))}),["xs","sm","md","lg","xl"].forEach(x=>{ya(t[x])?v.push(r.b(`${x}-${t[x]}`)):Un(t[x])&&Object.entries(t[x]).forEach(([E,h])=>{v.push(E!=="span"?r.b(`${x}-${E}-${h}`):r.b(`${x}-${h}`))})}),l.value&&v.push(r.is("guttered")),[r.b(),v]});return(v,g)=>(w(),le(Ea(v.tag),{class:me(k(f)),style:Je(k(d))},{default:a(()=>[ze(v.$slots,"default")]),_:3},8,["class","style"]))}});var ui=lt(di,[["__file","col.vue"]]);const cn=Vt(ui),ml=Symbol("elDescriptions");var Zt=Ve({name:"ElDescriptionsCell",props:{cell:{type:Object},tag:{type:String,default:"td"},type:{type:String}},setup(){return{descriptions:it(ml,{})}},render(){var i;const t=Uo(this.cell),l=(((i=this.cell)==null?void 0:i.dirs)||[]).map(I=>{const{dir:T,arg:$,modifiers:y,value:q}=I;return[T,q,$,y]}),{border:r,direction:d}=this.descriptions,f=d==="vertical",v=()=>{var I,T,$;return(($=(T=(I=this.cell)==null?void 0:I.children)==null?void 0:T.label)==null?void 0:$.call(T))||t.label},g=()=>{var I,T,$;return($=(T=(I=this.cell)==null?void 0:I.children)==null?void 0:T.default)==null?void 0:$.call(T)},c=t.span,x=t.rowspan,E=t.align?`is-${t.align}`:"",h=t.labelAlign?`is-${t.labelAlign}`:E,N=t.className,S=t.labelClassName,W=this.type==="label"&&(t.labelWidth||this.descriptions.labelWidth)||t.width,C={width:Xt(W),minWidth:Xt(t.minWidth)},O=Ze("descriptions");switch(this.type){case"label":return Ie(Jt(this.tag,{style:C,class:[O.e("cell"),O.e("label"),O.is("bordered-label",r),O.is("vertical-label",f),h,S],colSpan:f?c:1,rowspan:f?1:x},v()),l);case"content":return Ie(Jt(this.tag,{style:C,class:[O.e("cell"),O.e("content"),O.is("bordered-content",r),O.is("vertical-content",f),E,N],colSpan:f?c:c*2-1,rowspan:f?x*2-1:x},g()),l);default:{const I=v(),T={},$=Xt(t.labelWidth||this.descriptions.labelWidth);return $&&(T.width=$,T.display="inline-block"),Ie(Jt("td",{style:C,class:[O.e("cell"),E],colSpan:c,rowspan:x},[Pn(I)?void 0:Jt("span",{style:T,class:[O.e("label"),S]},I),Jt("span",{class:[O.e("content"),N]},g())]),l)}}}});const mi=He({row:{type:Fe(Array),default:()=>[]}}),ci=Ve({name:"ElDescriptionsRow"}),pi=Ve({...ci,props:mi,setup(i){const t=it(ml,{});return(l,r)=>k(t).direction==="vertical"?(w(),P(Ee,{key:0},[s("tr",null,[(w(!0),P(Ee,null,Te(l.row,(d,f)=>(w(),le(k(Zt),{key:`tr1-${f}`,cell:d,tag:"th",type:"label"},null,8,["cell"]))),128))]),s("tr",null,[(w(!0),P(Ee,null,Te(l.row,(d,f)=>(w(),le(k(Zt),{key:`tr2-${f}`,cell:d,tag:"td",type:"content"},null,8,["cell"]))),128))])],64)):(w(),P("tr",{key:1},[(w(!0),P(Ee,null,Te(l.row,(d,f)=>(w(),P(Ee,{key:`tr3-${f}`},[k(t).border?(w(),P(Ee,{key:0},[e(k(Zt),{cell:d,tag:"td",type:"label"},null,8,["cell"]),e(k(Zt),{cell:d,tag:"td",type:"content"},null,8,["cell"])],64)):(w(),le(k(Zt),{key:1,cell:d,tag:"td",type:"both"},null,8,["cell"]))],64))),128))]))}});var fi=lt(pi,[["__file","descriptions-row.vue"]]);const vi=He({border:Boolean,column:{type:Number,default:3},direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},size:Nn,title:{type:String,default:""},extra:{type:String,default:""},labelWidth:{type:[String,Number],default:""}}),pn="ElDescriptionsItem",gi=Ve({name:"ElDescriptions"}),yi=Ve({...gi,props:vi,setup(i){const t=i,l=Ze("descriptions"),r=dl(),d=el();na(ml,t);const f=ie(()=>[l.b(),l.m(r.value)]),v=(c,x,E,h=!1)=>(c.props||(c.props={}),x>E&&(c.props.span=E),h&&(c.props.span=x),c),g=()=>{if(!d.default)return[];const c=Po(d.default()).filter(W=>{var C;return((C=W?.type)==null?void 0:C.name)===pn}),x=[];let E=[],h=t.column,N=0;const S=[];return c.forEach((W,C)=>{var O,I,T;const $=((O=W.props)==null?void 0:O.span)||1,y=((I=W.props)==null?void 0:I.rowspan)||1,q=x.length;if(S[q]||(S[q]=0),y>1)for(let Z=1;Z<y;Z++)S[T=q+Z]||(S[T]=0),S[q+Z]++,N++;if(S[q]>0&&(h-=S[q],S[q]=0),C<c.length-1&&(N+=$>h?h:$),C===c.length-1){const Z=t.column-N%t.column;E.push(v(W,Z,h,!0)),x.push(E);return}$<h?(h-=$,E.push(W)):(E.push(v(W,$,h)),x.push(E),h=t.column,E=[])}),x};return(c,x)=>(w(),P("div",{class:me(k(f))},[c.title||c.extra||c.$slots.title||c.$slots.extra?(w(),P("div",{key:0,class:me(k(l).e("header"))},[s("div",{class:me(k(l).e("title"))},[ze(c.$slots,"title",{},()=>[_(G(c.title),1)])],2),s("div",{class:me(k(l).e("extra"))},[ze(c.$slots,"extra",{},()=>[_(G(c.extra),1)])],2)],2)):ee("v-if",!0),s("div",{class:me(k(l).e("body"))},[s("table",{class:me([k(l).e("table"),k(l).is("bordered",c.border)])},[s("tbody",null,[(w(!0),P(Ee,null,Te(g(),(E,h)=>(w(),le(fi,{key:h,row:E},null,8,["row"]))),128))])],2)],2)],2))}});var bi=lt(yi,[["__file","description.vue"]]);const El=["left","center","right"],hi=He({label:{type:String,default:""},span:{type:Number,default:1},rowspan:{type:Number,default:1},width:{type:[String,Number],default:""},minWidth:{type:[String,Number],default:""},labelWidth:{type:[String,Number],default:""},align:{type:String,values:El,default:"left"},labelAlign:{type:String,values:El},className:{type:String,default:""},labelClassName:{type:String,default:""}}),fn=Ve({name:pn,props:hi}),vn=Vt(bi,{DescriptionsItem:fn}),gn=tl(fn),wi=He({direction:{type:String,values:["horizontal","vertical"],default:"horizontal"},contentPosition:{type:String,values:["left","center","right"],default:"center"},borderStyle:{type:Fe(String),default:"solid"}}),_i=Ve({name:"ElDivider"}),Ei=Ve({..._i,props:wi,setup(i){const t=i,l=Ze("divider"),r=ie(()=>l.cssVar({"border-style":t.borderStyle}));return(d,f)=>(w(),P("div",{class:me([k(l).b(),k(l).m(d.direction)]),style:Je(k(r)),role:"separator"},[d.$slots.default&&d.direction!=="vertical"?(w(),P("div",{key:0,class:me([k(l).e("text"),k(l).is(d.contentPosition)])},[ze(d.$slots,"default")],2)):ee("v-if",!0)],6))}});var xi=lt(Ei,[["__file","divider.vue"]]);const cl=Vt(xi),Vi=He({size:{type:String,values:Il},disabled:Boolean}),Ci=He({...Vi,model:Object,rules:{type:Fe(Object)},labelPosition:{type:String,values:["left","right","top"],default:"right"},requireAsteriskPosition:{type:String,values:["left","right"],default:"left"},labelWidth:{type:[String,Number],default:""},labelSuffix:{type:String,default:""},inline:Boolean,inlineMessage:Boolean,statusIcon:Boolean,showMessage:{type:Boolean,default:!0},validateOnRuleChange:{type:Boolean,default:!0},hideRequiredAsterisk:Boolean,scrollToError:Boolean,scrollIntoViewOptions:{type:Fe([Object,Boolean]),default:!0}}),$i={validate:(i,t,l)=>(ba(i)||aa(i))&&Al(t)&&aa(l)};function ki(){const i=A([]),t=ie(()=>{if(!i.value.length)return"0";const f=Math.max(...i.value);return f?`${f}px`:""});function l(f){const v=i.value.indexOf(f);return v===-1&&t.value,v}function r(f,v){if(f&&v){const g=l(v);i.value.splice(g,1,f)}else f&&i.value.push(f)}function d(f){const v=l(f);v>-1&&i.value.splice(v,1)}return{autoLabelWidth:t,registerLabelWidth:r,deregisterLabelWidth:d}}const fa=(i,t)=>{const l=Ha(t).map(r=>ba(r)?r.join("."):r);return l.length>0?i.filter(r=>r.propString&&l.includes(r.propString)):i},Si="ElForm",Li=Ve({name:Si}),Ti=Ve({...Li,props:Ci,emits:$i,setup(i,{expose:t,emit:l}){const r=i,d=A(),f=Ue([]),v=dl(),g=Ze("form"),c=ie(()=>{const{labelPosition:y,inline:q}=r;return[g.b(),g.m(v.value||"default"),{[g.m(`label-${y}`)]:y,[g.m("inline")]:q}]}),x=y=>fa(f,[y])[0],E=y=>{f.push(y)},h=y=>{y.prop&&f.splice(f.indexOf(y),1)},N=(y=[])=>{r.model&&fa(f,y).forEach(q=>q.resetField())},S=(y=[])=>{fa(f,y).forEach(q=>q.clearValidate())},W=ie(()=>!!r.model),C=y=>{if(f.length===0)return[];const q=fa(f,y);return q.length?q:[]},O=async y=>T(void 0,y),I=async(y=[])=>{if(!W.value)return!1;const q=C(y);if(q.length===0)return!0;let Z={};for(const z of q)try{await z.validate(""),z.validateState==="error"&&!z.error&&z.resetField()}catch(m){Z={...Z,...m}}return Object.keys(Z).length===0?!0:Promise.reject(Z)},T=async(y=[],q)=>{let Z=!1;const z=!xa(q);try{return Z=await I(y),Z===!0&&await q?.(Z),Z}catch(m){if(m instanceof Error)throw m;const M=m;if(r.scrollToError&&d.value){const R=d.value.querySelector(`.${g.b()}-item.is-error`);R?.scrollIntoView(r.scrollIntoViewOptions)}return!Z&&await q?.(!1,M),z&&Promise.reject(M)}},$=y=>{var q;const Z=x(y);Z&&((q=Z.$el)==null||q.scrollIntoView(r.scrollIntoViewOptions))};return $e(()=>r.rules,()=>{r.validateOnRuleChange&&O().catch(y=>Fo())},{deep:!0,flush:"post"}),na(ul,Ue({...Fl(r),emit:l,resetFields:N,clearValidate:S,validateField:T,getField:x,addField:E,removeField:h,...ki()})),t({validate:O,validateField:T,resetFields:N,clearValidate:S,scrollToField:$,getField:x,fields:f}),(y,q)=>(w(),P("form",{ref_key:"formRef",ref:d,class:me(k(c))},[ze(y.$slots,"default")],2))}});var Di=lt(Ti,[["__file","form.vue"]]);function Lt(){return Lt=Object.assign?Object.assign.bind():function(i){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var r in l)Object.prototype.hasOwnProperty.call(l,r)&&(i[r]=l[r])}return i},Lt.apply(this,arguments)}function Ri(i,t){i.prototype=Object.create(t.prototype),i.prototype.constructor=i,la(i,t)}function Ka(i){return Ka=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(l){return l.__proto__||Object.getPrototypeOf(l)},Ka(i)}function la(i,t){return la=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,d){return r.__proto__=d,r},la(i,t)}function Ai(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ga(i,t,l){return Ai()?ga=Reflect.construct.bind():ga=function(d,f,v){var g=[null];g.push.apply(g,f);var c=Function.bind.apply(d,g),x=new c;return v&&la(x,v.prototype),x},ga.apply(null,arguments)}function Ii(i){return Function.toString.call(i).indexOf("[native code]")!==-1}function Ja(i){var t=typeof Map=="function"?new Map:void 0;return Ja=function(r){if(r===null||!Ii(r))return r;if(typeof r!="function")throw new TypeError("Super expression must either be null or a function");if(typeof t<"u"){if(t.has(r))return t.get(r);t.set(r,d)}function d(){return ga(r,arguments,Ka(this).constructor)}return d.prototype=Object.create(r.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),la(d,r)},Ja(i)}var Fi=/%[sdj%]/g,Ui=function(){};function Za(i){if(!i||!i.length)return null;var t={};return i.forEach(function(l){var r=l.field;t[r]=t[r]||[],t[r].push(l)}),t}function Qe(i){for(var t=arguments.length,l=new Array(t>1?t-1:0),r=1;r<t;r++)l[r-1]=arguments[r];var d=0,f=l.length;if(typeof i=="function")return i.apply(null,l);if(typeof i=="string"){var v=i.replace(Fi,function(g){if(g==="%%")return"%";if(d>=f)return g;switch(g){case"%s":return String(l[d++]);case"%d":return Number(l[d++]);case"%j":try{return JSON.stringify(l[d++])}catch{return"[Circular]"}break;default:return g}});return v}return i}function Pi(i){return i==="string"||i==="url"||i==="hex"||i==="email"||i==="date"||i==="pattern"}function Ne(i,t){return!!(i==null||t==="array"&&Array.isArray(i)&&!i.length||Pi(t)&&typeof i=="string"&&!i)}function Ni(i,t,l){var r=[],d=0,f=i.length;function v(g){r.push.apply(r,g||[]),d++,d===f&&l(r)}i.forEach(function(g){t(g,v)})}function xl(i,t,l){var r=0,d=i.length;function f(v){if(v&&v.length){l(v);return}var g=r;r=r+1,g<d?t(i[g],f):l([])}f([])}function Mi(i){var t=[];return Object.keys(i).forEach(function(l){t.push.apply(t,i[l]||[])}),t}var Vl=(function(i){Ri(t,i);function t(l,r){var d;return d=i.call(this,"Async Validation Error")||this,d.errors=l,d.fields=r,d}return t})(Ja(Error));function zi(i,t,l,r,d){if(t.first){var f=new Promise(function(N,S){var W=function(I){return r(I),I.length?S(new Vl(I,Za(I))):N(d)},C=Mi(i);xl(C,l,W)});return f.catch(function(N){return N}),f}var v=t.firstFields===!0?Object.keys(i):t.firstFields||[],g=Object.keys(i),c=g.length,x=0,E=[],h=new Promise(function(N,S){var W=function(O){if(E.push.apply(E,O),x++,x===c)return r(E),E.length?S(new Vl(E,Za(E))):N(d)};g.length||(r(E),N(d)),g.forEach(function(C){var O=i[C];v.indexOf(C)!==-1?xl(O,l,W):Ni(O,l,W)})});return h.catch(function(N){return N}),h}function Oi(i){return!!(i&&i.message!==void 0)}function Bi(i,t){for(var l=i,r=0;r<t.length;r++){if(l==null)return l;l=l[t[r]]}return l}function Cl(i,t){return function(l){var r;return i.fullFields?r=Bi(t,i.fullFields):r=t[l.field||i.fullField],Oi(l)?(l.field=l.field||i.fullField,l.fieldValue=r,l):{message:typeof l=="function"?l():l,fieldValue:r,field:l.field||i.fullField}}}function $l(i,t){if(t){for(var l in t)if(t.hasOwnProperty(l)){var r=t[l];typeof r=="object"&&typeof i[l]=="object"?i[l]=Lt({},i[l],r):i[l]=r}}return i}var yn=function(t,l,r,d,f,v){t.required&&(!r.hasOwnProperty(t.field)||Ne(l,v||t.type))&&d.push(Qe(f.messages.required,t.fullField))},ji=function(t,l,r,d,f){(/^\s+$/.test(l)||l==="")&&d.push(Qe(f.messages.whitespace,t.fullField))},va,qi=(function(){if(va)return va;var i="[a-fA-F\\d:]",t=function(y){return y&&y.includeBoundaries?"(?:(?<=\\s|^)(?="+i+")|(?<="+i+")(?=\\s|$))":""},l="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",r="[a-fA-F\\d]{1,4}",d=(`
(?:
(?:`+r+":){7}(?:"+r+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+r+":){6}(?:"+l+"|:"+r+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+r+":){5}(?::"+l+"|(?::"+r+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+r+":){4}(?:(?::"+r+"){0,1}:"+l+"|(?::"+r+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+r+":){3}(?:(?::"+r+"){0,2}:"+l+"|(?::"+r+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+r+":){2}(?:(?::"+r+"){0,3}:"+l+"|(?::"+r+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+r+":){1}(?:(?::"+r+"){0,4}:"+l+"|(?::"+r+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+r+"){0,5}:"+l+"|(?::"+r+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),f=new RegExp("(?:^"+l+"$)|(?:^"+d+"$)"),v=new RegExp("^"+l+"$"),g=new RegExp("^"+d+"$"),c=function(y){return y&&y.exact?f:new RegExp("(?:"+t(y)+l+t(y)+")|(?:"+t(y)+d+t(y)+")","g")};c.v4=function($){return $&&$.exact?v:new RegExp(""+t($)+l+t($),"g")},c.v6=function($){return $&&$.exact?g:new RegExp(""+t($)+d+t($),"g")};var x="(?:(?:[a-z]+:)?//)",E="(?:\\S+(?::\\S*)?@)?",h=c.v4().source,N=c.v6().source,S="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",W="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",C="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",O="(?::\\d{2,5})?",I='(?:[/?#][^\\s"]*)?',T="(?:"+x+"|www\\.)"+E+"(?:localhost|"+h+"|"+N+"|"+S+W+C+")"+O+I;return va=new RegExp("(?:^"+T+"$)","i"),va}),kl={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},Qt={integer:function(t){return Qt.number(t)&&parseInt(t,10)===t},float:function(t){return Qt.number(t)&&!Qt.integer(t)},array:function(t){return Array.isArray(t)},regexp:function(t){if(t instanceof RegExp)return!0;try{return!!new RegExp(t)}catch{return!1}},date:function(t){return typeof t.getTime=="function"&&typeof t.getMonth=="function"&&typeof t.getYear=="function"&&!isNaN(t.getTime())},number:function(t){return isNaN(t)?!1:typeof t=="number"},object:function(t){return typeof t=="object"&&!Qt.array(t)},method:function(t){return typeof t=="function"},email:function(t){return typeof t=="string"&&t.length<=320&&!!t.match(kl.email)},url:function(t){return typeof t=="string"&&t.length<=2048&&!!t.match(qi())},hex:function(t){return typeof t=="string"&&!!t.match(kl.hex)}},Yi=function(t,l,r,d,f){if(t.required&&l===void 0){yn(t,l,r,d,f);return}var v=["integer","float","array","regexp","object","method","email","number","date","url","hex"],g=t.type;v.indexOf(g)>-1?Qt[g](l)||d.push(Qe(f.messages.types[g],t.fullField,t.type)):g&&typeof l!==t.type&&d.push(Qe(f.messages.types[g],t.fullField,t.type))},Wi=function(t,l,r,d,f){var v=typeof t.len=="number",g=typeof t.min=="number",c=typeof t.max=="number",x=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,E=l,h=null,N=typeof l=="number",S=typeof l=="string",W=Array.isArray(l);if(N?h="number":S?h="string":W&&(h="array"),!h)return!1;W&&(E=l.length),S&&(E=l.replace(x,"_").length),v?E!==t.len&&d.push(Qe(f.messages[h].len,t.fullField,t.len)):g&&!c&&E<t.min?d.push(Qe(f.messages[h].min,t.fullField,t.min)):c&&!g&&E>t.max?d.push(Qe(f.messages[h].max,t.fullField,t.max)):g&&c&&(E<t.min||E>t.max)&&d.push(Qe(f.messages[h].range,t.fullField,t.min,t.max))},zt="enum",Hi=function(t,l,r,d,f){t[zt]=Array.isArray(t[zt])?t[zt]:[],t[zt].indexOf(l)===-1&&d.push(Qe(f.messages[zt],t.fullField,t[zt].join(", ")))},Gi=function(t,l,r,d,f){if(t.pattern){if(t.pattern instanceof RegExp)t.pattern.lastIndex=0,t.pattern.test(l)||d.push(Qe(f.messages.pattern.mismatch,t.fullField,l,t.pattern));else if(typeof t.pattern=="string"){var v=new RegExp(t.pattern);v.test(l)||d.push(Qe(f.messages.pattern.mismatch,t.fullField,l,t.pattern))}}},he={required:yn,whitespace:ji,type:Yi,range:Wi,enum:Hi,pattern:Gi},Ki=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(Ne(l,"string")&&!t.required)return r();he.required(t,l,d,v,f,"string"),Ne(l,"string")||(he.type(t,l,d,v,f),he.range(t,l,d,v,f),he.pattern(t,l,d,v,f),t.whitespace===!0&&he.whitespace(t,l,d,v,f))}r(v)},Ji=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(Ne(l)&&!t.required)return r();he.required(t,l,d,v,f),l!==void 0&&he.type(t,l,d,v,f)}r(v)},Zi=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(l===""&&(l=void 0),Ne(l)&&!t.required)return r();he.required(t,l,d,v,f),l!==void 0&&(he.type(t,l,d,v,f),he.range(t,l,d,v,f))}r(v)},Qi=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(Ne(l)&&!t.required)return r();he.required(t,l,d,v,f),l!==void 0&&he.type(t,l,d,v,f)}r(v)},Xi=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(Ne(l)&&!t.required)return r();he.required(t,l,d,v,f),Ne(l)||he.type(t,l,d,v,f)}r(v)},er=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(Ne(l)&&!t.required)return r();he.required(t,l,d,v,f),l!==void 0&&(he.type(t,l,d,v,f),he.range(t,l,d,v,f))}r(v)},tr=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(Ne(l)&&!t.required)return r();he.required(t,l,d,v,f),l!==void 0&&(he.type(t,l,d,v,f),he.range(t,l,d,v,f))}r(v)},ar=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(l==null&&!t.required)return r();he.required(t,l,d,v,f,"array"),l!=null&&(he.type(t,l,d,v,f),he.range(t,l,d,v,f))}r(v)},lr=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(Ne(l)&&!t.required)return r();he.required(t,l,d,v,f),l!==void 0&&he.type(t,l,d,v,f)}r(v)},nr="enum",or=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(Ne(l)&&!t.required)return r();he.required(t,l,d,v,f),l!==void 0&&he[nr](t,l,d,v,f)}r(v)},sr=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(Ne(l,"string")&&!t.required)return r();he.required(t,l,d,v,f),Ne(l,"string")||he.pattern(t,l,d,v,f)}r(v)},ir=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(Ne(l,"date")&&!t.required)return r();if(he.required(t,l,d,v,f),!Ne(l,"date")){var c;l instanceof Date?c=l:c=new Date(l),he.type(t,c,d,v,f),c&&he.range(t,c.getTime(),d,v,f)}}r(v)},rr=function(t,l,r,d,f){var v=[],g=Array.isArray(l)?"array":typeof l;he.required(t,l,d,v,f,g),r(v)},ja=function(t,l,r,d,f){var v=t.type,g=[],c=t.required||!t.required&&d.hasOwnProperty(t.field);if(c){if(Ne(l,v)&&!t.required)return r();he.required(t,l,d,g,f,v),Ne(l,v)||he.type(t,l,d,g,f)}r(g)},dr=function(t,l,r,d,f){var v=[],g=t.required||!t.required&&d.hasOwnProperty(t.field);if(g){if(Ne(l)&&!t.required)return r();he.required(t,l,d,v,f)}r(v)},ta={string:Ki,method:Ji,number:Zi,boolean:Qi,regexp:Xi,integer:er,float:tr,array:ar,object:lr,enum:or,pattern:sr,date:ir,url:ja,hex:ja,email:ja,required:rr,any:dr};function Qa(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var t=JSON.parse(JSON.stringify(this));return t.clone=this.clone,t}}}var Xa=Qa(),ua=(function(){function i(l){this.rules=null,this._messages=Xa,this.define(l)}var t=i.prototype;return t.define=function(r){var d=this;if(!r)throw new Error("Cannot configure a schema with no rules");if(typeof r!="object"||Array.isArray(r))throw new Error("Rules must be an object");this.rules={},Object.keys(r).forEach(function(f){var v=r[f];d.rules[f]=Array.isArray(v)?v:[v]})},t.messages=function(r){return r&&(this._messages=$l(Qa(),r)),this._messages},t.validate=function(r,d,f){var v=this;d===void 0&&(d={}),f===void 0&&(f=function(){});var g=r,c=d,x=f;if(typeof c=="function"&&(x=c,c={}),!this.rules||Object.keys(this.rules).length===0)return x&&x(null,g),Promise.resolve(g);function E(C){var O=[],I={};function T(y){if(Array.isArray(y)){var q;O=(q=O).concat.apply(q,y)}else O.push(y)}for(var $=0;$<C.length;$++)T(C[$]);O.length?(I=Za(O),x(O,I)):x(null,g)}if(c.messages){var h=this.messages();h===Xa&&(h=Qa()),$l(h,c.messages),c.messages=h}else c.messages=this.messages();var N={},S=c.keys||Object.keys(this.rules);S.forEach(function(C){var O=v.rules[C],I=g[C];O.forEach(function(T){var $=T;typeof $.transform=="function"&&(g===r&&(g=Lt({},g)),I=g[C]=$.transform(I)),typeof $=="function"?$={validator:$}:$=Lt({},$),$.validator=v.getValidationMethod($),$.validator&&($.field=C,$.fullField=$.fullField||C,$.type=v.getType($),N[C]=N[C]||[],N[C].push({rule:$,value:I,source:g,field:C}))})});var W={};return zi(N,c,function(C,O){var I=C.rule,T=(I.type==="object"||I.type==="array")&&(typeof I.fields=="object"||typeof I.defaultField=="object");T=T&&(I.required||!I.required&&C.value),I.field=C.field;function $(Z,z){return Lt({},z,{fullField:I.fullField+"."+Z,fullFields:I.fullFields?[].concat(I.fullFields,[Z]):[Z]})}function y(Z){Z===void 0&&(Z=[]);var z=Array.isArray(Z)?Z:[Z];!c.suppressWarning&&z.length&&i.warning("async-validator:",z),z.length&&I.message!==void 0&&(z=[].concat(I.message));var m=z.map(Cl(I,g));if(c.first&&m.length)return W[I.field]=1,O(m);if(!T)O(m);else{if(I.required&&!C.value)return I.message!==void 0?m=[].concat(I.message).map(Cl(I,g)):c.error&&(m=[c.error(I,Qe(c.messages.required,I.field))]),O(m);var M={};I.defaultField&&Object.keys(C.value).map(function(B){M[B]=I.defaultField}),M=Lt({},M,C.rule.fields);var R={};Object.keys(M).forEach(function(B){var H=M[B],K=Array.isArray(H)?H:[H];R[B]=K.map($.bind(null,B))});var se=new i(R);se.messages(c.messages),C.rule.options&&(C.rule.options.messages=c.messages,C.rule.options.error=c.error),se.validate(C.value,C.rule.options||c,function(B){var H=[];m&&m.length&&H.push.apply(H,m),B&&B.length&&H.push.apply(H,B),O(H.length?H:null)})}}var q;if(I.asyncValidator)q=I.asyncValidator(I,C.value,y,C.source,c);else if(I.validator){try{q=I.validator(I,C.value,y,C.source,c)}catch(Z){console.error?.(Z),c.suppressValidatorError||setTimeout(function(){throw Z},0),y(Z.message)}q===!0?y():q===!1?y(typeof I.message=="function"?I.message(I.fullField||I.field):I.message||(I.fullField||I.field)+" fails"):q instanceof Array?y(q):q instanceof Error&&y(q.message)}q&&q.then&&q.then(function(){return y()},function(Z){return y(Z)})},function(C){E(C)},g)},t.getType=function(r){if(r.type===void 0&&r.pattern instanceof RegExp&&(r.type="pattern"),typeof r.validator!="function"&&r.type&&!ta.hasOwnProperty(r.type))throw new Error(Qe("Unknown rule type %s",r.type));return r.type||"string"},t.getValidationMethod=function(r){if(typeof r.validator=="function")return r.validator;var d=Object.keys(r),f=d.indexOf("message");return f!==-1&&d.splice(f,1),d.length===1&&d[0]==="required"?ta.required:ta[this.getType(r)]||void 0},i})();ua.register=function(t,l){if(typeof l!="function")throw new Error("Cannot register a validator by type, validator is not a function");ta[t]=l};ua.warning=Ui;ua.messages=Xa;ua.validators=ta;const ur=["","error","validating","success"],mr=He({label:String,labelWidth:{type:[String,Number],default:""},labelPosition:{type:String,values:["left","right","top",""],default:""},prop:{type:Fe([String,Array])},required:{type:Boolean,default:void 0},rules:{type:Fe([Object,Array])},error:String,validateStatus:{type:String,values:ur},for:String,inlineMessage:{type:[String,Boolean],default:""},showMessage:{type:Boolean,default:!0},size:{type:String,values:Il}}),Sl="ElLabelWrap";var cr=Ve({name:Sl,props:{isAutoWidth:Boolean,updateAll:Boolean},setup(i,{slots:t}){const l=it(ul,void 0),r=it(Ga);r||Da(Sl,"usage: <el-form-item><label-wrap /></el-form-item>");const d=Ze("form"),f=A(),v=A(0),g=()=>{var E;if((E=f.value)!=null&&E.firstElementChild){const h=window.getComputedStyle(f.value.firstElementChild).width;return Math.ceil(Number.parseFloat(h))}else return 0},c=(E="update")=>{De(()=>{t.default&&i.isAutoWidth&&(E==="update"?v.value=g():E==="remove"&&l?.deregisterLabelWidth(v.value))})},x=()=>c("update");return Ot(()=>{x()}),Va(()=>{c("remove")}),Ul(()=>x()),$e(v,(E,h)=>{i.updateAll&&l?.registerLabelWidth(E,h)}),ha(ie(()=>{var E,h;return(h=(E=f.value)==null?void 0:E.firstElementChild)!=null?h:null}),x),()=>{var E,h;if(!t)return null;const{isAutoWidth:N}=i;if(N){const S=l?.autoLabelWidth,W=r?.hasLabel,C={};if(W&&S&&S!=="auto"){const O=Math.max(0,Number.parseInt(S,10)-v.value),T=(r.labelPosition||l.labelPosition)==="left"?"marginRight":"marginLeft";O&&(C[T]=`${O}px`)}return e("div",{ref:f,class:[d.be("item","label-wrap")],style:C},[(E=t.default)==null?void 0:E.call(t)])}else return e(Ee,{ref:f},[(h=t.default)==null?void 0:h.call(t)])}}});const pr=Ve({name:"ElFormItem"}),fr=Ve({...pr,props:mr,setup(i,{expose:t}){const l=i,r=el(),d=it(ul,void 0),f=it(Ga,void 0),v=dl(void 0,{formItem:!1}),g=Ze("form-item"),c=Do().value,x=A([]),E=A(""),h=Mn(E,100),N=A(""),S=A();let W,C=!1;const O=ie(()=>l.labelPosition||d?.labelPosition),I=ie(()=>{if(O.value==="top")return{};const J=Xt(l.labelWidth||d?.labelWidth||"");return J?{width:J}:{}}),T=ie(()=>{if(O.value==="top"||d?.inline)return{};if(!l.label&&!l.labelWidth&&R)return{};const J=Xt(l.labelWidth||d?.labelWidth||"");return!l.label&&!r.label?{marginLeft:J}:{}}),$=ie(()=>[g.b(),g.m(v.value),g.is("error",E.value==="error"),g.is("validating",E.value==="validating"),g.is("success",E.value==="success"),g.is("required",ge.value||l.required),g.is("no-asterisk",d?.hideRequiredAsterisk),d?.requireAsteriskPosition==="right"?"asterisk-right":"asterisk-left",{[g.m("feedback")]:d?.statusIcon,[g.m(`label-${O.value}`)]:O.value}]),y=ie(()=>Al(l.inlineMessage)?l.inlineMessage:d?.inlineMessage||!1),q=ie(()=>[g.e("error"),{[g.em("error","inline")]:y.value}]),Z=ie(()=>l.prop?ba(l.prop)?l.prop.join("."):l.prop:""),z=ie(()=>!!(l.label||r.label)),m=ie(()=>{var J;return(J=l.for)!=null?J:x.value.length===1?x.value[0]:void 0}),M=ie(()=>!m.value&&z.value),R=!!f,se=ie(()=>{const J=d?.model;if(!(!J||!l.prop))return Ba(J,l.prop).value}),B=ie(()=>{const{required:J}=l,ue=[];l.rules&&ue.push(...Ha(l.rules));const _e=d?.rules;if(_e&&l.prop){const pe=Ba(_e,l.prop).value;pe&&ue.push(...Ha(pe))}if(J!==void 0){const pe=ue.map((Ae,Se)=>[Ae,Se]).filter(([Ae])=>Object.keys(Ae).includes("required"));if(pe.length>0)for(const[Ae,Se]of pe)Ae.required!==J&&(ue[Se]={...Ae,required:J});else ue.push({required:J})}return ue}),H=ie(()=>B.value.length>0),K=J=>B.value.filter(_e=>!_e.trigger||!J?!0:ba(_e.trigger)?_e.trigger.includes(J):_e.trigger===J).map(({trigger:_e,...pe})=>pe),ge=ie(()=>B.value.some(J=>J.required)),ce=ie(()=>{var J;return h.value==="error"&&l.showMessage&&((J=d?.showMessage)!=null?J:!0)}),Y=ie(()=>`${l.label||""}${d?.labelSuffix||""}`),V=J=>{E.value=J},xe=J=>{var ue,_e;const{errors:pe,fields:Ae}=J;(!pe||!Ae)&&console.error(J),V("error"),N.value=pe?(_e=(ue=pe?.[0])==null?void 0:ue.message)!=null?_e:`${l.prop} is required`:"",d?.emit("validate",l.prop,!1,N.value)},ye=()=>{V("success"),d?.emit("validate",l.prop,!0,"")},we=async J=>{const ue=Z.value;return new ua({[ue]:J}).validate({[ue]:se.value},{firstFields:!0}).then(()=>(ye(),!0)).catch(pe=>(xe(pe),Promise.reject(pe)))},ne=async(J,ue)=>{if(C||!l.prop)return!1;const _e=xa(ue);if(!H.value)return ue?.(!1),!1;const pe=K(J);return pe.length===0?(ue?.(!0),!0):(V("validating"),we(pe).then(()=>(ue?.(!0),!0)).catch(Ae=>{const{fields:Se}=Ae;return ue?.(!1,Se),_e?!1:Promise.reject(Se)}))},L=()=>{V(""),N.value="",C=!1},u=async()=>{const J=d?.model;if(!J||!l.prop)return;const ue=Ba(J,l.prop);C=!0,ue.value=_l(W),await De(),L(),C=!1},p=J=>{x.value.includes(J)||x.value.push(J)},re=J=>{x.value=x.value.filter(ue=>ue!==J)};$e(()=>l.error,J=>{N.value=J||"",V(J?"error":"")},{immediate:!0}),$e(()=>l.validateStatus,J=>V(J||""));const ae=Ue({...Fl(l),$el:S,size:v,validateMessage:N,validateState:E,labelId:c,inputIds:x,isGroup:M,hasLabel:z,fieldValue:se,addInputId:p,removeInputId:re,resetField:u,clearValidate:L,validate:ne,propString:Z});return na(Ga,ae),Ot(()=>{l.prop&&(d?.addField(ae),W=_l(se.value))}),Va(()=>{d?.removeField(ae)}),t({size:v,validateMessage:N,validateState:E,validate:ne,clearValidate:L,resetField:u}),(J,ue)=>{var _e;return w(),P("div",{ref_key:"formItemRef",ref:S,class:me(k($)),role:k(M)?"group":void 0,"aria-labelledby":k(M)?k(c):void 0},[e(k(cr),{"is-auto-width":k(I).width==="auto","update-all":((_e=k(d))==null?void 0:_e.labelWidth)==="auto"},{default:a(()=>[k(z)?(w(),le(Ea(k(m)?"label":"div"),{key:0,id:k(c),for:k(m),class:me(k(g).e("label")),style:Je(k(I))},{default:a(()=>[ze(J.$slots,"label",{label:k(Y)},()=>[_(G(k(Y)),1)])]),_:3},8,["id","for","class","style"])):ee("v-if",!0)]),_:3},8,["is-auto-width","update-all"]),s("div",{class:me(k(g).e("content")),style:Je(k(T))},[ze(J.$slots,"default"),e(zn,{name:`${k(g).namespace.value}-zoom-in-top`},{default:a(()=>[k(ce)?ze(J.$slots,"error",{key:0,error:N.value},()=>[s("div",{class:me(k(q))},G(N.value),3)]):ee("v-if",!0)]),_:3},8,["name"])],6)],10,["role","aria-labelledby"])}}});var bn=lt(fr,[["__file","form-item.vue"]]);const Rt=Vt(Di,{FormItem:bn}),At=tl(bn),vr=He({type:{type:String,default:"line",values:["line","circle","dashboard"]},percentage:{type:Number,default:0,validator:i=>i>=0&&i<=100},status:{type:String,default:"",values:["","success","exception","warning"]},indeterminate:Boolean,duration:{type:Number,default:3},strokeWidth:{type:Number,default:6},strokeLinecap:{type:Fe(String),default:"round"},textInside:Boolean,width:{type:Number,default:126},showText:{type:Boolean,default:!0},color:{type:Fe([String,Array,Function]),default:""},striped:Boolean,stripedFlow:Boolean,format:{type:Fe(Function),default:i=>`${i}%`}}),gr=Ve({name:"ElProgress"}),yr=Ve({...gr,props:vr,setup(i){const t=i,l={success:"#13ce66",exception:"#ff4949",warning:"#e6a23c",default:"#20a0ff"},r=Ze("progress"),d=ie(()=>{const $={width:`${t.percentage}%`,animationDuration:`${t.duration}s`},y=T(t.percentage);return y.includes("gradient")?$.background=y:$.backgroundColor=y,$}),f=ie(()=>(t.strokeWidth/t.width*100).toFixed(1)),v=ie(()=>["circle","dashboard"].includes(t.type)?Number.parseInt(`${50-Number.parseFloat(f.value)/2}`,10):0),g=ie(()=>{const $=v.value,y=t.type==="dashboard";return`
          M 50 50
          m 0 ${y?"":"-"}${$}
          a ${$} ${$} 0 1 1 0 ${y?"-":""}${$*2}
          a ${$} ${$} 0 1 1 0 ${y?"":"-"}${$*2}
          `}),c=ie(()=>2*Math.PI*v.value),x=ie(()=>t.type==="dashboard"?.75:1),E=ie(()=>`${-1*c.value*(1-x.value)/2}px`),h=ie(()=>({strokeDasharray:`${c.value*x.value}px, ${c.value}px`,strokeDashoffset:E.value})),N=ie(()=>({strokeDasharray:`${c.value*x.value*(t.percentage/100)}px, ${c.value}px`,strokeDashoffset:E.value,transition:"stroke-dasharray 0.6s ease 0s, stroke 0.6s ease, opacity ease 0.6s"})),S=ie(()=>{let $;return t.color?$=T(t.percentage):$=l[t.status]||l.default,$}),W=ie(()=>t.status==="warning"?On:t.type==="line"?t.status==="success"?Bn:jn:t.status==="success"?qn:Pl),C=ie(()=>t.type==="line"?12+t.strokeWidth*.4:t.width*.111111+2),O=ie(()=>t.format(t.percentage));function I($){const y=100/$.length;return $.map((Z,z)=>aa(Z)?{color:Z,percentage:(z+1)*y}:Z).sort((Z,z)=>Z.percentage-z.percentage)}const T=$=>{var y;const{color:q}=t;if(xa(q))return q($);if(aa(q))return q;{const Z=I(q);for(const z of Z)if(z.percentage>$)return z.color;return(y=Z[Z.length-1])==null?void 0:y.color}};return($,y)=>(w(),P("div",{class:me([k(r).b(),k(r).m($.type),k(r).is($.status),{[k(r).m("without-text")]:!$.showText,[k(r).m("text-inside")]:$.textInside}]),role:"progressbar","aria-valuenow":$.percentage,"aria-valuemin":"0","aria-valuemax":"100"},[$.type==="line"?(w(),P("div",{key:0,class:me(k(r).b("bar"))},[s("div",{class:me(k(r).be("bar","outer")),style:Je({height:`${$.strokeWidth}px`})},[s("div",{class:me([k(r).be("bar","inner"),{[k(r).bem("bar","inner","indeterminate")]:$.indeterminate},{[k(r).bem("bar","inner","striped")]:$.striped},{[k(r).bem("bar","inner","striped-flow")]:$.stripedFlow}]),style:Je(k(d))},[($.showText||$.$slots.default)&&$.textInside?(w(),P("div",{key:0,class:me(k(r).be("bar","innerText"))},[ze($.$slots,"default",{percentage:$.percentage},()=>[s("span",null,G(k(O)),1)])],2)):ee("v-if",!0)],6)],6)],2)):(w(),P("div",{key:1,class:me(k(r).b("circle")),style:Je({height:`${$.width}px`,width:`${$.width}px`})},[(w(),P("svg",{viewBox:"0 0 100 100"},[s("path",{class:me(k(r).be("circle","track")),d:k(g),stroke:`var(${k(r).cssVarName("fill-color-light")}, #e5e9f2)`,"stroke-linecap":$.strokeLinecap,"stroke-width":k(f),fill:"none",style:Je(k(h))},null,14,["d","stroke","stroke-linecap","stroke-width"]),s("path",{class:me(k(r).be("circle","path")),d:k(g),stroke:k(S),fill:"none",opacity:$.percentage?1:0,"stroke-linecap":$.strokeLinecap,"stroke-width":k(f),style:Je(k(N))},null,14,["d","stroke","opacity","stroke-linecap","stroke-width"])]))],6)),($.showText||$.$slots.default)&&!$.textInside?(w(),P("div",{key:2,class:me(k(r).e("text")),style:Je({fontSize:`${k(C)}px`})},[ze($.$slots,"default",{percentage:$.percentage},()=>[$.status?(w(),le(k(Tt),{key:1},{default:a(()=>[(w(),le(Ea(k(W))))]),_:1})):(w(),P("span",{key:0},G(k(O)),1))])],6)):ee("v-if",!0)],10,["aria-valuenow"]))}});var br=lt(yr,[["__file","progress.vue"]]);const hr=Vt(br),wr=["start","center","end","space-around","space-between","space-evenly"],_r=["top","middle","bottom"],Er=He({tag:{type:String,default:"div"},gutter:{type:Number,default:0},justify:{type:String,values:wr,default:"start"},align:{type:String,values:_r}}),xr=Ve({name:"ElRow"}),Vr=Ve({...xr,props:Er,setup(i){const t=i,l=Ze("row"),r=ie(()=>t.gutter);na(mn,{gutter:r});const d=ie(()=>{const v={};return t.gutter&&(v.marginRight=v.marginLeft=`-${t.gutter/2}px`),v}),f=ie(()=>[l.b(),l.is(`justify-${t.justify}`,t.justify!=="start"),l.is(`align-${t.align}`,!!t.align)]);return(v,g)=>(w(),le(Ea(v.tag),{class:me(k(f)),style:Je(k(d))},{default:a(()=>[ze(v.$slots,"default")]),_:3},8,["class","style"]))}});var Cr=lt(Vr,[["__file","row.vue"]]);const hn=Vt(Cr),$r=He({decimalSeparator:{type:String,default:"."},groupSeparator:{type:String,default:","},precision:{type:Number,default:0},formatter:Function,value:{type:Fe([Number,Object]),default:0},prefix:String,suffix:String,title:String,valueStyle:{type:Fe([String,Object,Array])}}),kr=Ve({name:"ElStatistic"}),Sr=Ve({...kr,props:$r,setup(i,{expose:t}){const l=i,r=Ze("statistic"),d=ie(()=>{const{value:f,formatter:v,precision:g,decimalSeparator:c,groupSeparator:x}=l;if(xa(v))return v(f);if(!ya(f)||Number.isNaN(f))return f;let[E,h=""]=String(f).split(".");return h=h.padEnd(g,"0").slice(0,g>0?g:0),E=E.replace(/\B(?=(\d{3})+(?!\d))/g,x),[E,h].join(h?c:"")});return t({displayValue:d}),(f,v)=>(w(),P("div",{class:me(k(r).b())},[f.$slots.title||f.title?(w(),P("div",{key:0,class:me(k(r).e("head"))},[ze(f.$slots,"title",{},()=>[_(G(f.title),1)])],2)):ee("v-if",!0),s("div",{class:me(k(r).e("content"))},[f.$slots.prefix||f.prefix?(w(),P("div",{key:0,class:me(k(r).e("prefix"))},[ze(f.$slots,"prefix",{},()=>[s("span",null,G(f.prefix),1)])],2)):ee("v-if",!0),s("span",{class:me(k(r).e("number")),style:Je(f.valueStyle)},G(k(d)),7),f.$slots.suffix||f.suffix?(w(),P("div",{key:1,class:me(k(r).e("suffix"))},[ze(f.$slots,"suffix",{},()=>[s("span",null,G(f.suffix),1)])],2)):ee("v-if",!0)],2)],2))}});var Lr=lt(Sr,[["__file","statistic.vue"]]);const Tr=Vt(Lr),Ra=Symbol("tabsRootContextKey"),Dr=He({tabs:{type:Fe(Array),default:()=>Et([])},tabRefs:{type:Fe(Object),default:()=>Et({})}}),wn="ElTabBar",Rr=Ve({name:wn}),Ar=Ve({...Rr,props:Dr,setup(i,{expose:t}){const l=i,r=it(Ra);r||Da(wn,"<el-tabs><el-tab-bar /></el-tabs>");const d=Ze("tabs"),f=A(),v=A(),g=()=>{let N=0,S=0;const W=["top","bottom"].includes(r.props.tabPosition)?"width":"height",C=W==="width"?"x":"y",O=C==="x"?"left":"top";return l.tabs.every(I=>{if(Ya(I.paneName))return!1;const T=l.tabRefs[I.paneName];if(!T)return!1;if(!I.active)return!0;N=T[`offset${xt(O)}`],S=T[`client${xt(W)}`];const $=window.getComputedStyle(T);return W==="width"&&(S-=Number.parseFloat($.paddingLeft)+Number.parseFloat($.paddingRight),N+=Number.parseFloat($.paddingLeft)),!1}),{[W]:`${S}px`,transform:`translate${xt(C)}(${N}px)`}},c=()=>v.value=g(),x=[],E=()=>{x.forEach(N=>N.stop()),x.length=0,Object.values(l.tabRefs).forEach(N=>{x.push(ha(N,c))})};$e(()=>l.tabs,async()=>{await De(),c(),E()},{immediate:!0});const h=ha(f,()=>c());return Va(()=>{x.forEach(N=>N.stop()),x.length=0,h.stop()}),t({ref:f,update:c}),(N,S)=>(w(),P("div",{ref_key:"barRef",ref:f,class:me([k(d).e("active-bar"),k(d).is(k(r).props.tabPosition)]),style:Je(v.value)},null,6))}});var Ir=lt(Ar,[["__file","tab-bar.vue"]]);const Fr=He({panes:{type:Fe(Array),default:()=>Et([])},currentName:{type:[String,Number],default:""},editable:Boolean,type:{type:String,values:["card","border-card",""],default:""},stretch:Boolean}),Ur={tabClick:(i,t,l)=>l instanceof Event,tabRemove:(i,t)=>t instanceof Event},Ll="ElTabNav",Pr=Ve({name:Ll,props:Fr,emits:Ur,setup(i,{expose:t,emit:l}){const r=it(Ra);r||Da(Ll,"<el-tabs><tab-nav /></el-tabs>");const d=Ze("tabs"),f=Yn(),v=Wn(),g=A(),c=A(),x=A(),E=A({}),h=A(),N=A(!1),S=A(0),W=A(!1),C=A(!0),O=Hn(),I=ie(()=>["top","bottom"].includes(r.props.tabPosition)?"width":"height"),T=ie(()=>({transform:`translate${I.value==="width"?"X":"Y"}(-${S.value}px)`})),$=()=>{if(!g.value)return;const B=g.value[`offset${xt(I.value)}`],H=S.value;if(!H)return;const K=H>B?H-B:0;S.value=K},y=()=>{if(!g.value||!c.value)return;const B=c.value[`offset${xt(I.value)}`],H=g.value[`offset${xt(I.value)}`],K=S.value;if(B-K<=H)return;const ge=B-K>H*2?K+H:B-H;S.value=ge},q=async()=>{const B=c.value;if(!N.value||!x.value||!g.value||!B)return;await De();const H=E.value[i.currentName];if(!H)return;const K=g.value,ge=["top","bottom"].includes(r.props.tabPosition),ce=H.getBoundingClientRect(),Y=K.getBoundingClientRect(),V=ge?B.offsetWidth-Y.width:B.offsetHeight-Y.height,xe=S.value;let ye=xe;ge?(ce.left<Y.left&&(ye=xe-(Y.left-ce.left)),ce.right>Y.right&&(ye=xe+ce.right-Y.right)):(ce.top<Y.top&&(ye=xe-(Y.top-ce.top)),ce.bottom>Y.bottom&&(ye=xe+(ce.bottom-Y.bottom))),ye=Math.max(ye,0),S.value=Math.min(ye,V)},Z=()=>{var B;if(!c.value||!g.value)return;i.stretch&&((B=h.value)==null||B.update());const H=c.value[`offset${xt(I.value)}`],K=g.value[`offset${xt(I.value)}`],ge=S.value;K<H?(N.value=N.value||{},N.value.prev=ge,N.value.next=ge+K<H,H-ge<K&&(S.value=H-K)):(N.value=!1,ge>0&&(S.value=0))},z=B=>{let H=0;switch(B.code){case _t.left:case _t.up:H=-1;break;case _t.right:case _t.down:H=1;break;default:return}const K=Array.from(B.currentTarget.querySelectorAll("[role=tab]:not(.is-disabled)"));let ce=K.indexOf(B.target)+H;ce<0?ce=K.length-1:ce>=K.length&&(ce=0),K[ce].focus({preventScroll:!0}),K[ce].click(),m()},m=()=>{C.value&&(W.value=!0)},M=()=>W.value=!1,R=(B,H)=>{E.value[H]=B},se=async()=>{await De();const B=E.value[i.currentName];B?.focus({preventScroll:!0})};return $e(f,B=>{B==="hidden"?C.value=!1:B==="visible"&&setTimeout(()=>C.value=!0,50)}),$e(v,B=>{B?setTimeout(()=>C.value=!0,50):C.value=!1}),ha(x,Z),Ot(()=>setTimeout(()=>q(),0)),Ul(()=>Z()),t({scrollToActiveTab:q,removeFocus:M,focusActiveTab:se,tabListRef:c,tabBarRef:h,scheduleRender:()=>Gn(O)}),()=>{const B=N.value?[e("span",{class:[d.e("nav-prev"),d.is("disabled",!N.value.prev)],onClick:$},[e(Tt,null,{default:()=>[e(Kn,null,null)]})]),e("span",{class:[d.e("nav-next"),d.is("disabled",!N.value.next)],onClick:y},[e(Tt,null,{default:()=>[e(Jn,null,null)]})])]:null,H=i.panes.map((K,ge)=>{var ce,Y,V,xe;const ye=K.uid,we=K.props.disabled,ne=(Y=(ce=K.props.name)!=null?ce:K.index)!=null?Y:`${ge}`,L=!we&&(K.isClosable||i.editable);K.index=`${ge}`;const u=L?e(Tt,{class:"is-icon-close",onClick:ae=>l("tabRemove",K,ae)},{default:()=>[e(Pl,null,null)]}):null,p=((xe=(V=K.slots).label)==null?void 0:xe.call(V))||K.props.label,re=!we&&K.active?0:-1;return e("div",{ref:ae=>R(ae,ne),class:[d.e("item"),d.is(r.props.tabPosition),d.is("active",K.active),d.is("disabled",we),d.is("closable",L),d.is("focus",W.value)],id:`tab-${ne}`,key:`tab-${ye}`,"aria-controls":`pane-${ne}`,role:"tab","aria-selected":K.active,tabindex:re,onFocus:()=>m(),onBlur:()=>M(),onClick:ae=>{M(),l("tabClick",K,ne,ae)},onKeydown:ae=>{L&&(ae.code===_t.delete||ae.code===_t.backspace)&&l("tabRemove",K,ae)}},[p,u])});return O.value,e("div",{ref:x,class:[d.e("nav-wrap"),d.is("scrollable",!!N.value),d.is(r.props.tabPosition)]},[B,e("div",{class:d.e("nav-scroll"),ref:g},[i.panes.length>0?e("div",{class:[d.e("nav"),d.is(r.props.tabPosition),d.is("stretch",i.stretch&&["top","bottom"].includes(r.props.tabPosition))],ref:c,style:T.value,role:"tablist",onKeydown:z},[i.type?null:e(Ir,{ref:h,tabs:[...i.panes],tabRefs:E.value},null),H]):null])])}}}),Nr=He({type:{type:String,values:["card","border-card",""],default:""},closable:Boolean,addable:Boolean,modelValue:{type:[String,Number]},editable:Boolean,tabPosition:{type:String,values:["top","right","bottom","left"],default:"top"},beforeLeave:{type:Fe(Function),default:()=>!0},stretch:Boolean}),qa=i=>aa(i)||ya(i),Mr={[tn]:i=>qa(i),tabClick:(i,t)=>t instanceof Event,tabChange:i=>qa(i),edit:(i,t)=>["remove","add"].includes(t),tabRemove:i=>qa(i),tabAdd:()=>!0},zr=Ve({name:"ElTabs",props:Nr,emits:Mr,setup(i,{emit:t,slots:l,expose:r}){var d;const f=Ze("tabs"),v=ie(()=>["left","right"].includes(i.tabPosition)),{children:g,addChild:c,removeChild:x,ChildrenSorter:E}=To(al(),"ElTabPane"),h=A(),N=A((d=i.modelValue)!=null?d:"0"),S=async(T,$=!1)=>{var y,q,Z,z;if(!(N.value===T||Ya(T)))try{let m;if(i.beforeLeave){const M=i.beforeLeave(T,N.value);m=M instanceof Promise?await M:M}else m=!0;if(m!==!1){const M=(y=g.value.find(R=>R.paneName===N.value))==null?void 0:y.isFocusInsidePane();N.value=T,$&&(t(tn,T),t("tabChange",T)),(Z=(q=h.value)==null?void 0:q.removeFocus)==null||Z.call(q),M&&((z=h.value)==null||z.focusActiveTab())}}catch{}},W=(T,$,y)=>{T.props.disabled||(t("tabClick",T,y),S($,!0))},C=(T,$)=>{T.props.disabled||Ya(T.props.name)||($.stopPropagation(),t("edit",T.props.name,"remove"),t("tabRemove",T.props.name))},O=()=>{t("edit",void 0,"add"),t("tabAdd")},I=T=>{const $=T.el.firstChild,y=["bottom","right"].includes(i.tabPosition)?T.children[0].el:T.children[1].el;$!==y&&$.before(y)};return $e(()=>i.modelValue,T=>S(T)),$e(N,async()=>{var T;await De(),(T=h.value)==null||T.scrollToActiveTab()}),na(Ra,{props:i,currentName:N,registerPane:c,unregisterPane:x,nav$:h}),r({currentName:N,get tabNavRef(){return si(h.value,["scheduleRender"])}}),()=>{const T=l["add-icon"],$=i.editable||i.addable?e("div",{class:[f.e("new-tab"),v.value&&f.e("new-tab-vertical")],tabindex:"0",onClick:O,onKeydown:z=>{[_t.enter,_t.numpadEnter].includes(z.code)&&O()}},[T?ze(l,"add-icon"):e(Tt,{class:f.is("icon-plus")},{default:()=>[e(Zn,null,null)]})]):null,y=()=>e(Pr,{ref:h,currentName:N.value,editable:i.editable,type:i.type,panes:g.value,stretch:i.stretch,onTabClick:W,onTabRemove:C},null),q=e("div",{class:[f.e("header"),v.value&&f.e("header-vertical"),f.is(i.tabPosition)]},[e(E,null,{default:y,$stable:!0}),$]),Z=e("div",{class:f.e("content")},[ze(l,"default")]);return e("div",{class:[f.b(),f.m(i.tabPosition),{[f.m("card")]:i.type==="card",[f.m("border-card")]:i.type==="border-card"}],onVnodeMounted:I,onVnodeUpdated:I},[Z,q])}}});var Or=zr;const Br=He({label:{type:String,default:""},name:{type:[String,Number]},closable:Boolean,disabled:Boolean,lazy:Boolean}),_n="ElTabPane",jr=Ve({name:_n}),qr=Ve({...jr,props:Br,setup(i){const t=i,l=al(),r=el(),d=it(Ra);d||Da(_n,"usage: <el-tabs><el-tab-pane /></el-tabs/>");const f=Ze("tab-pane"),v=A(),g=A(),c=ie(()=>t.closable||d.props.closable),x=vl(()=>{var C;return d.currentName.value===((C=t.name)!=null?C:g.value)}),E=A(x.value),h=ie(()=>{var C;return(C=t.name)!=null?C:g.value}),N=vl(()=>!t.lazy||E.value||x.value),S=()=>{var C;return(C=v.value)==null?void 0:C.contains(document.activeElement)};$e(x,C=>{C&&(E.value=!0)});const W=Ue({uid:l.uid,getVnode:()=>l.vnode,slots:r,props:t,paneName:h,active:x,index:g,isClosable:c,isFocusInsidePane:S});return d.registerPane(W),Va(()=>{d.unregisterPane(W)}),Qn(()=>{var C;r.label&&((C=d.nav$.value)==null||C.scheduleRender())}),(C,O)=>k(N)?Ie((w(),P("div",{key:0,id:`pane-${k(h)}`,ref_key:"paneRef",ref:v,class:me(k(f).b()),role:"tabpanel","aria-hidden":!k(x),"aria-labelledby":`tab-${k(h)}`},[ze(C.$slots,"default")],10,["id","aria-hidden","aria-labelledby"])),[[Nl,k(x)]]):ee("v-if",!0)}});var En=lt(qr,[["__file","tab-pane.vue"]]);const xn=Vt(Or,{TabPane:En}),Vn=tl(En),Yr=(i={})=>Ct.get("/email-template/list",{params:i}),Wr=()=>Ct.get("/email-template/available"),Hr=i=>Ct.post("/email-template/create",i),Gr=(i,t)=>Ct.put(`/email-template/${i}`,t),Kr=i=>Ct.delete(`/email-template/${i}`),Jr=()=>Ct.post("/email-template/initialize-presets"),Zr=i=>Ct.post(`/email-template/${i}/toggle-active`),Tl=(i,t)=>Ct.post("/email-template/batch-update-active",{templateIds:i,isActive:t}),Qr={class:"whitelist-content"},Xr={class:"alert-title"},ed={class:"whitelist-header"},td={class:"header-actions"},ad={class:"whitelist-list"},ld={class:"list-header"},nd={class:"email-tags"},od={key:0,class:"empty-state"},sd={class:"import-container"},id={class:"search-bar"},rd={class:"batch-actions"},dd={class:"selected-info"},ud={class:"email-list"},md={class:"email-item-content"},cd={class:"email-address"},pd={class:"email-text"},fd={class:"email-stats"},vd={class:"stat-item"},gd={class:"stat-item"},yd={key:0,class:"empty-result"},bd={class:"pagination"},hd={class:"dialog-footer"},wd={__name:"ShareWhitelistDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","updated"],setup(i,{emit:t}){const l=i,r=t,d=A(!1),f=A(!1),v=A([]),g=A(!1),c=A(""),x=A(!1),E=A(!1),h=A(!1),N=A(""),S=A("email"),W=A(1),C=A(50),O=A(0);A([]);const I=A([]),T=A(new Set),$=A([]),y=A(!1),q=ie(()=>{const ne=$.value.length;return ne>0&&ne<I.value.length});$e(()=>l.modelValue,ne=>{d.value=ne,ne&&Z()}),$e(d,ne=>{r("update:modelValue",ne)}),$e(x,ne=>{ne?z():(N.value="",W.value=1,T.value.clear(),$.value=[])});const Z=async()=>{try{v.value=await oo()}catch{D.error("加载白名单失败")}},z=async()=>{h.value=!0;try{const ne=await en({search:N.value,page:W.value,pageSize:C.value,orderBy:S.value}),L=ne.data||ne;I.value=L.list||[],O.value=L.total||0,B()}catch(ne){console.error("Load emails error:",ne),D.error("加载邮箱列表失败")}finally{h.value=!1}},m=()=>{W.value=1,z()},M=()=>{z()},R=()=>{W.value=1,z()},se=()=>{y.value?I.value.forEach(ne=>{v.value.includes(ne.email)||(T.value.add(ne.email),$.value.includes(ne.email)||$.value.push(ne.email))}):I.value.forEach(ne=>{T.value.delete(ne.email);const L=$.value.indexOf(ne.email);L>-1&&$.value.splice(L,1)})},B=()=>{const ne=I.value.filter(u=>!v.value.includes(u.email)),L=ne.filter(u=>T.value.has(u.email));y.value=ne.length>0&&L.length===ne.length},H=ne=>{T.value.clear(),ne.forEach(L=>T.value.add(L)),B()},K=()=>{const ne=Array.from(T.value).filter(L=>!v.value.includes(L));if(ne.length===0){D.warning("没有可添加的新邮箱");return}v.value.push(...ne),D.success(`成功添加 ${ne.length} 个邮箱到白名单`),T.value.clear(),$.value=[],y.value=!1,z()},ge=async()=>{try{const{value:ne}=await Xe.prompt("请输入邮箱地址","添加邮箱",{inputPattern:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,inputErrorMessage:"请输入有效的邮箱地址"});if(v.value.includes(ne)){D.warning("该邮箱已存在");return}v.value.push(ne),D.success("添加成功")}catch{}},ce=()=>{const ne=c.value.split(`
`).map(u=>u.trim()).filter(u=>u).filter(u=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(u));if(ne.length===0){D.warning("请输入有效的邮箱地址");return}const L=ne.filter(u=>!v.value.includes(u));v.value.push(...L),D.success(`成功添加 ${L.length} 个邮箱`),g.value=!1,c.value=""},Y=ne=>{v.value.splice(ne,1)},V=async()=>{try{await Xe.confirm("确定要清空所有邮箱吗?此操作不可恢复。","确认清空",{type:"warning"}),v.value=[],D.success("已清空所有邮箱")}catch{}},xe=ne=>ne?_a(ne).format("YYYY-MM-DD HH:mm"):"-",ye=async()=>{f.value=!0;try{await no(v.value),r("updated"),D.success("保存成功"),we()}catch{D.error("保存失败")}finally{f.value=!1}},we=()=>{d.value=!1};return(ne,L)=>{const u=rl,p=gt,re=Bt,ae=ra,J=Dt,ue=At,_e=Rt,pe=ft,Ae=qt,Se=jt,Me=ka,Ge=ol,Le=Ta,Oe=oa;return w(),le(pe,{modelValue:d.value,"onUpdate:modelValue":L[13]||(L[13]=ve=>d.value=ve),title:"邮箱白名单管理",width:"1200px","close-on-click-modal":!1,onClose:we,class:"whitelist-dialog"},{footer:a(()=>[s("div",hd,[e(p,{onClick:we},{default:a(()=>[...L[26]||(L[26]=[_("取消",-1)])]),_:1}),e(p,{type:"primary",onClick:ye,loading:f.value},{default:a(()=>[...L[27]||(L[27]=[_(" 保存设置 ",-1)])]),_:1},8,["loading"])])]),default:a(()=>[s("div",Qr,[e(u,{type:"info",closable:!1,class:"info-alert"},{title:a(()=>[s("div",Xr,[e(k(oe),{icon:"material-symbols:security",class:"alert-icon"}),L[14]||(L[14]=s("span",null,"白名单安全控制说明",-1))])]),default:a(()=>[L[15]||(L[15]=s("div",{class:"alert-content"},[s("p",null,[_("• "),s("strong",null,"核心作用"),_(": 只有白名单中的邮箱才能创建验证码分享链接,保护验证码安全")]),s("p",null,[_("• "),s("strong",null,"访问控制"),_(": 分享链接访问时会二次验证白名单,防止未授权访问")]),s("p",null,[_("• "),s("strong",null,"使用建议"),_(": 仅添加需要接收验证码的邮箱,建议100个左右")])],-1))]),_:1}),s("div",ed,[s("div",td,[e(p,{onClick:L[0]||(L[0]=ve=>g.value=!0)},{default:a(()=>[e(k(oe),{icon:"material-symbols:add-box"}),L[16]||(L[16]=_(" 批量添加 ",-1))]),_:1}),e(p,{onClick:ge},{default:a(()=>[e(k(oe),{icon:"material-symbols:add"}),L[17]||(L[17]=_(" 添加邮箱 ",-1))]),_:1}),e(p,{type:"primary",onClick:L[1]||(L[1]=ve=>x.value=!0),loading:E.value},{default:a(()=>[e(k(oe),{icon:"material-symbols:mail-outline"}),L[18]||(L[18]=_(" 从全部邮件导入 ",-1))]),_:1},8,["loading"])])]),s("div",ad,[s("div",ld,[s("span",null,"已添加邮箱 ("+G(v.value.length)+")",1),e(p,{type:"danger",size:"small",onClick:V,disabled:v.value.length===0},{default:a(()=>[e(k(oe),{icon:"material-symbols:delete-outline"}),L[19]||(L[19]=_(" 清空全部 ",-1))]),_:1},8,["disabled"])]),s("div",nd,[(w(!0),P(Ee,null,Te(v.value,(ve,et)=>(w(),le(re,{key:et,closable:"",onClose:Be=>Y(et),class:"email-tag",size:"large",type:"info"},{default:a(()=>[e(k(oe),{icon:"material-symbols:email",class:"tag-icon"}),_(" "+G(ve),1)]),_:2},1032,["onClose"]))),128)),v.value.length===0?(w(),P("div",od,[e(ae,{description:"暂无邮箱,点击上方按钮添加"})])):ee("",!0)])])]),e(pe,{modelValue:g.value,"onUpdate:modelValue":L[4]||(L[4]=ve=>g.value=ve),title:"批量添加邮箱",width:"600px","append-to-body":""},{footer:a(()=>[e(p,{onClick:L[3]||(L[3]=ve=>g.value=!1)},{default:a(()=>[...L[21]||(L[21]=[_("取消",-1)])]),_:1}),e(p,{type:"primary",onClick:ce},{default:a(()=>[...L[22]||(L[22]=[_("确认添加",-1)])]),_:1})]),default:a(()=>[e(_e,null,{default:a(()=>[e(ue,{label:"邮箱列表"},{default:a(()=>[e(J,{modelValue:c.value,"onUpdate:modelValue":L[2]||(L[2]=ve=>c.value=ve),type:"textarea",rows:10,placeholder:`请输入邮箱地址,每行一个:
user1@example.com
user2@example.com
user3@example.com`},null,8,["modelValue"]),L[20]||(L[20]=s("div",{class:"form-tip"}," 每行输入一个邮箱地址,系统会自动验证格式并去重 ",-1))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(pe,{modelValue:x.value,"onUpdate:modelValue":L[12]||(L[12]=ve=>x.value=ve),title:"从全部邮件导入邮箱",width:"900px","append-to-body":"","close-on-click-modal":!1},{footer:a(()=>[e(p,{onClick:L[11]||(L[11]=ve=>x.value=!1)},{default:a(()=>[...L[25]||(L[25]=[_("关闭",-1)])]),_:1}),e(p,{type:"primary",onClick:K,disabled:T.value.size===0},{default:a(()=>[_(" 添加选中项 ("+G(T.value.size)+") ",1)]),_:1},8,["disabled"])]),default:a(()=>[s("div",sd,[s("div",id,[e(J,{modelValue:N.value,"onUpdate:modelValue":L[5]||(L[5]=ve=>N.value=ve),placeholder:"搜索邮箱地址...",clearable:"",onInput:m,class:"search-input"},{prefix:a(()=>[e(k(oe),{icon:"material-symbols:search"})]),_:1},8,["modelValue"]),e(Se,{modelValue:S.value,"onUpdate:modelValue":L[6]||(L[6]=ve=>S.value=ve),onChange:z,class:"sort-select"},{default:a(()=>[e(Ae,{label:"按邮箱排序",value:"email"}),e(Ae,{label:"按邮件数量排序",value:"count"})]),_:1},8,["modelValue"])]),s("div",rd,[e(Me,{modelValue:y.value,"onUpdate:modelValue":L[7]||(L[7]=ve=>y.value=ve),onChange:se,indeterminate:q.value},{default:a(()=>[...L[23]||(L[23]=[_(" 全选本页 ",-1)])]),_:1},8,["modelValue","indeterminate"]),s("span",dd," 已选择 "+G(T.value.size)+" / "+G(O.value)+" 个邮箱 ",1),e(p,{type:"primary",size:"small",onClick:K,disabled:T.value.size===0},{default:a(()=>[e(k(oe),{icon:"material-symbols:add"}),_(" 添加选中项 ("+G(T.value.size)+") ",1)]),_:1},8,["disabled"])]),Ie((w(),P("div",ud,[e(Ge,{modelValue:$.value,"onUpdate:modelValue":L[8]||(L[8]=ve=>$.value=ve),onChange:H},{default:a(()=>[(w(!0),P(Ee,null,Te(I.value,ve=>(w(),P("div",{key:ve.email,class:me(["email-item",{"in-whitelist":v.value.includes(ve.email),selected:T.value.has(ve.email)}])},[e(Me,{label:ve.email,disabled:v.value.includes(ve.email)},{default:a(()=>[s("div",md,[s("div",cd,[e(k(oe),{icon:"material-symbols:email",class:"email-icon"}),s("span",pd,G(ve.email),1),v.value.includes(ve.email)?(w(),le(re,{key:0,size:"small",type:"success"},{default:a(()=>[...L[24]||(L[24]=[_(" 已在白名单 ",-1)])]),_:1})):ee("",!0)]),s("div",fd,[s("span",vd,[e(k(oe),{icon:"material-symbols:mail"}),_(" "+G(ve.emailCount)+" 封邮件 ",1)]),s("span",gd,[e(k(oe),{icon:"material-symbols:schedule"}),_(" "+G(xe(ve.latestReceiveTime)),1)])])])]),_:2},1032,["label","disabled"])],2))),128))]),_:1},8,["modelValue"]),I.value.length===0?(w(),P("div",yd,[e(ae,{description:"未找到符合条件的邮箱"})])):ee("",!0)])),[[Oe,h.value]]),s("div",bd,[e(Le,{"current-page":W.value,"onUpdate:currentPage":L[9]||(L[9]=ve=>W.value=ve),"page-size":C.value,"onUpdate:pageSize":L[10]||(L[10]=ve=>C.value=ve),"page-sizes":[50,100,200],total:O.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:M,onSizeChange:R},null,8,["current-page","page-size","total"])])])]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}},Cn=vt(wd,[["__scopeId","data-v-c0d2345d"]]),_d={class:"form-tip",style:{"margin-left":"12px"}},Ed={class:"dialog-footer"},xd={__name:"TemplateFormDialog",props:{modelValue:{type:Boolean,default:!1},mode:{type:String,default:"create",validator:i=>["create","edit"].includes(i)},templateData:{type:Object,default:null}},emits:["update:modelValue","created","updated"],setup(i,{emit:t}){const l=i,r=t,d=A(!1),f=A(),v=A(!1),g=Ue({name:"",description:"",senderPattern:"",subjectPattern:"",bodyPattern:"",extractionRegex:"",codeFormat:"",exampleEmail:"",exampleCode:"",isActive:1}),c=(W,C,O)=>{if(!C){O();return}try{new RegExp(C),O()}catch{O(new Error("请输入有效的正则表达式"))}},x={name:[{required:!0,message:"请输入模板名称",trigger:"blur"},{min:1,max:50,message:"长度在 1 到 50 个字符",trigger:"blur"}],extractionRegex:[{required:!0,message:"请输入提取正则表达式",trigger:"blur"},{validator:c,trigger:"blur"}],senderPattern:[{validator:c,trigger:"blur"}],subjectPattern:[{validator:c,trigger:"blur"}],bodyPattern:[{validator:c,trigger:"blur"}]};$e(()=>l.modelValue,W=>{d.value=W,W&&E()}),$e(d,W=>{r("update:modelValue",W)});const E=()=>{l.templateData?Object.assign(g,{name:l.templateData.name||"",description:l.templateData.description||"",senderPattern:l.templateData.senderPattern||"",subjectPattern:l.templateData.subjectPattern||"",bodyPattern:l.templateData.bodyPattern||"",extractionRegex:l.templateData.extractionRegex||"",codeFormat:l.templateData.codeFormat||"",exampleEmail:l.templateData.exampleEmail||"",exampleCode:l.templateData.exampleCode||"",isActive:l.templateData.isActive??1}):h(),De(()=>{f.value?.clearValidate()})},h=()=>{g.name="",g.description="",g.senderPattern="",g.subjectPattern="",g.bodyPattern="",g.extractionRegex="",g.codeFormat="",g.exampleEmail="",g.exampleCode="",g.isActive=1},N=async()=>{try{await f.value.validate(),v.value=!0;const W={name:g.name,description:g.description||null,senderPattern:g.senderPattern||null,subjectPattern:g.subjectPattern||null,bodyPattern:g.bodyPattern||null,extractionRegex:g.extractionRegex,codeFormat:g.codeFormat||null,exampleEmail:g.exampleEmail||null,exampleCode:g.exampleCode||null,isActive:g.isActive};l.mode==="create"?(await Hr(W),D.success("模板创建成功"),r("created")):(await Gr(l.templateData.id,W),D.success("模板更新成功"),r("updated")),S()}catch(W){console.error("Submit template error:",W),W.message&&!W.message.includes("validation")&&D.error(W.message||"操作失败")}finally{v.value=!1}},S=()=>{d.value=!1};return(W,C)=>{const O=Dt,I=At,T=cl,$=da,y=Rt,q=gt,Z=ft;return w(),le(Z,{modelValue:d.value,"onUpdate:modelValue":C[11]||(C[11]=z=>d.value=z),title:i.mode==="create"?"创建邮件模板":"编辑邮件模板",width:"700px","close-on-click-modal":!1,onClose:S},{footer:a(()=>[s("div",Ed,[e(q,{onClick:S},{default:a(()=>[...C[20]||(C[20]=[_("取消",-1)])]),_:1}),e(q,{type:"primary",onClick:N,loading:v.value},{default:a(()=>[_(G(i.mode==="create"?"创建":"保存"),1)]),_:1},8,["loading"])])]),default:a(()=>[e(y,{ref_key:"formRef",ref:f,model:g,rules:x,"label-width":"140px",onSubmit:C[10]||(C[10]=st(()=>{},["prevent"]))},{default:a(()=>[e(I,{label:"模板名称",prop:"name"},{default:a(()=>[e(O,{modelValue:g.name,"onUpdate:modelValue":C[0]||(C[0]=z=>g.name=z),placeholder:"例如: GitHub验证码",maxlength:"50","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(I,{label:"模板描述",prop:"description"},{default:a(()=>[e(O,{modelValue:g.description,"onUpdate:modelValue":C[1]||(C[1]=z=>g.description=z),type:"textarea",rows:2,placeholder:"简要描述此模板的用途",maxlength:"200","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(T,{"content-position":"left"},{default:a(()=>[...C[12]||(C[12]=[_("匹配规则 (可选)",-1)])]),_:1}),e(I,{label:"发件人匹配规则",prop:"senderPattern"},{default:a(()=>[e(O,{modelValue:g.senderPattern,"onUpdate:modelValue":C[2]||(C[2]=z=>g.senderPattern=z),placeholder:"例如: noreply@github\\\\.com"},null,8,["modelValue"]),C[13]||(C[13]=s("div",{class:"form-tip"}," 使用正则表达式匹配发件人邮箱,留空表示不限制 ",-1))]),_:1}),e(I,{label:"主题匹配规则",prop:"subjectPattern"},{default:a(()=>[e(O,{modelValue:g.subjectPattern,"onUpdate:modelValue":C[3]||(C[3]=z=>g.subjectPattern=z),placeholder:"例如: verification|verify|code"},null,8,["modelValue"]),C[14]||(C[14]=s("div",{class:"form-tip"}," 使用正则表达式匹配邮件主题,留空表示不限制 ",-1))]),_:1}),e(I,{label:"正文匹配规则",prop:"bodyPattern"},{default:a(()=>[e(O,{modelValue:g.bodyPattern,"onUpdate:modelValue":C[4]||(C[4]=z=>g.bodyPattern=z),placeholder:"例如: verification code|验证码"},null,8,["modelValue"]),C[15]||(C[15]=s("div",{class:"form-tip"}," 使用正则表达式匹配邮件正文,留空表示不限制 ",-1))]),_:1}),e(T,{"content-position":"left"},{default:a(()=>[...C[16]||(C[16]=[_("验证码提取 (必填)",-1)])]),_:1}),e(I,{label:"提取正则表达式",prop:"extractionRegex"},{default:a(()=>[e(O,{modelValue:g.extractionRegex,"onUpdate:modelValue":C[5]||(C[5]=z=>g.extractionRegex=z),placeholder:"例如: \\\\b\\\\d{6}\\\\b"},null,8,["modelValue"]),C[17]||(C[17]=s("div",{class:"form-tip"}," 用于从邮件正文中提取验证码的正则表达式 ",-1))]),_:1}),e(I,{label:"验证码格式说明",prop:"codeFormat"},{default:a(()=>[e(O,{modelValue:g.codeFormat,"onUpdate:modelValue":C[6]||(C[6]=z=>g.codeFormat=z),placeholder:"例如: 6位数字"},null,8,["modelValue"]),C[18]||(C[18]=s("div",{class:"form-tip"}," 描述验证码的格式,帮助用户理解 ",-1))]),_:1}),e(T,{"content-position":"left"},{default:a(()=>[...C[19]||(C[19]=[_("示例 (可选)",-1)])]),_:1}),e(I,{label:"示例邮件内容",prop:"exampleEmail"},{default:a(()=>[e(O,{modelValue:g.exampleEmail,"onUpdate:modelValue":C[7]||(C[7]=z=>g.exampleEmail=z),type:"textarea",rows:3,placeholder:"粘贴一封示例邮件的内容"},null,8,["modelValue"])]),_:1}),e(I,{label:"示例验证码",prop:"exampleCode"},{default:a(()=>[e(O,{modelValue:g.exampleCode,"onUpdate:modelValue":C[8]||(C[8]=z=>g.exampleCode=z),placeholder:"例如: 123456"},null,8,["modelValue"])]),_:1}),e(I,{label:"启用状态",prop:"isActive"},{default:a(()=>[e($,{modelValue:g.isActive,"onUpdate:modelValue":C[9]||(C[9]=z=>g.isActive=z),"active-value":1,"inactive-value":0},null,8,["modelValue"]),s("span",_d,G(g.isActive===1?"已启用":"已禁用"),1)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}},Vd=vt(xd,[["__scopeId","data-v-078384e9"]]),Cd={class:"toolbar"},$d={class:"toolbar-left"},kd={key:0,class:"toolbar-right"},Sd={class:"selected-count"},Ld={class:"template-name"},Td={key:0,class:"empty-state"},Dd={class:"empty-actions"},Rd={class:"dialog-footer"},Ad={__name:"TemplateManagementDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","updated"],setup(i,{emit:t}){const l=i,r=t,d=A(!1),f=A(!1),v=A(!1),g=A([]),c=A(!1),x=A("create"),E=A(null),h=A([]);$e(()=>l.modelValue,M=>{d.value=M,M&&S()}),$e(d,M=>{r("update:modelValue",M)});const N=M=>M?_a(M).format("YYYY-MM-DD HH:mm:ss"):"-",S=async()=>{f.value=!0;try{const M=await Yr(),R=M.data||M,se=R.data||R||[];console.log("Load templates response:",R),console.log("New templates count:",se.length),g.value=[...se],console.log("Templates updated:",g.value.length)}catch(M){console.error("Load templates error:",M),D.error("加载模板列表失败")}finally{f.value=!1}},W=async()=>{v.value=!0;try{const M=await Jr();console.log("Initialize presets response:",M),M&&M.success?(D.success(`成功加载 ${M.count} 个预设模板`),await S(),r("updated")):M&&M.message?(D.info(M.message),await S()):D.error("加载预设模板失败")}catch(M){console.error("Initialize presets error:",M),D.error(M.message||"加载预设模板失败")}finally{v.value=!1}},C=()=>{x.value="create",E.value=null,c.value=!0},O=M=>{x.value="edit",E.value={...M},c.value=!0},I=async M=>{try{await Xe.confirm(`确定要删除模板 "${M.name}" 吗?此操作不可恢复。`,"确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await Kr(M.id),D.success("模板删除成功"),S(),r("updated")}catch(R){R!=="cancel"&&(console.error("Delete template error:",R),D.error(R.message||"删除模板失败"))}},T=async M=>{M._toggling=!0;try{const R=await Zr(M.id);console.log("Toggle result:",R),R&&R.success?(M.isActive=R.isActive,D.success(R.isActive===1?"模板已启用":"模板已禁用"),await S(),r("updated")):(console.error("Toggle failed:",R),D.error("切换状态失败"),await S())}catch(R){console.error("Toggle active error:",R),D.error(R.message||"切换状态失败"),await S()}finally{M._toggling=!1}},$=M=>{h.value=M},y=async()=>{if(h.value.length===0){D.warning("请先选择要启用的模板");return}try{const M=h.value.map(se=>se.id);console.log("Batch enable IDs:",M);const R=await Tl(M,!0);console.log("Batch enable result:",R),R&&R.success?(D.success(`成功启用 ${R.count} 个模板`),await S(),h.value=[],r("updated")):(console.error("Batch enable failed:",R),D.error("批量启用失败"))}catch(M){console.error("Batch enable error:",M),D.error(M.message||"批量启用失败")}},q=async()=>{if(h.value.length===0){D.warning("请先选择要禁用的模板");return}try{const M=h.value.map(se=>se.id);console.log("Batch disable IDs:",M);const R=await Tl(M,!1);console.log("Batch disable result:",R),R&&R.success?(D.success(`成功禁用 ${R.count} 个模板`),await S(),h.value=[],r("updated")):(console.error("Batch disable failed:",R),D.error("批量禁用失败"))}catch(M){console.error("Batch disable error:",M),D.error(M.message||"批量禁用失败")}},Z=()=>{S(),r("updated")},z=()=>{S(),r("updated")},m=()=>{d.value=!1};return Ot(()=>{d.value&&S()}),(M,R)=>{const se=gt,B=$a,H=da,K=Ca,ge=ft,ce=oa;return w(),P(Ee,null,[e(ge,{modelValue:d.value,"onUpdate:modelValue":R[0]||(R[0]=Y=>d.value=Y),title:"邮件模板管理",width:"900px","close-on-click-modal":!1,onClose:m},{footer:a(()=>[s("div",Rd,[e(se,{onClick:m},{default:a(()=>[...R[12]||(R[12]=[_("关闭",-1)])]),_:1})])]),default:a(()=>[s("div",Cd,[s("div",$d,[e(se,{type:"primary",onClick:C},{default:a(()=>[e(k(oe),{icon:"material-symbols:add"}),R[2]||(R[2]=_(" 创建模板 ",-1))]),_:1}),e(se,{onClick:S},{default:a(()=>[e(k(oe),{icon:"ion:reload"}),R[3]||(R[3]=_(" 刷新 ",-1))]),_:1}),e(se,{type:"success",onClick:W,loading:v.value},{default:a(()=>[e(k(oe),{icon:"material-symbols:stars"}),R[4]||(R[4]=_(" 加载预设模板 ",-1))]),_:1},8,["loading"])]),h.value.length>0?(w(),P("div",kd,[s("span",Sd,"已选择 "+G(h.value.length)+" 个模板",1),e(se,{size:"small",onClick:y},{default:a(()=>[...R[5]||(R[5]=[_("批量启用",-1)])]),_:1}),e(se,{size:"small",onClick:q},{default:a(()=>[...R[6]||(R[6]=[_("批量禁用",-1)])]),_:1})])):ee("",!0)]),Ie((w(),le(K,{data:g.value,stripe:"",style:{width:"100%","margin-top":"16px"},"max-height":"500px",onSelectionChange:$},{default:a(()=>[e(B,{type:"selection",width:"55"}),e(B,{prop:"name",label:"模板名称","min-width":"150"},{default:a(({row:Y})=>[s("div",Ld,G(Y.name),1)]),_:1}),e(B,{prop:"description",label:"描述","min-width":"180","show-overflow-tooltip":""}),e(B,{prop:"codeFormat",label:"验证码格式","min-width":"100","show-overflow-tooltip":""}),e(B,{label:"启用状态",width:"100",align:"center"},{default:a(({row:Y})=>[e(H,{"model-value":Y.isActive===1,onChange:V=>T(Y),loading:Y._toggling},null,8,["model-value","onChange","loading"])]),_:1}),e(B,{prop:"createdAt",label:"创建时间",width:"160"},{default:a(({row:Y})=>[_(G(N(Y.createdAt)),1)]),_:1}),e(B,{label:"操作",width:"150",fixed:"right"},{default:a(({row:Y})=>[e(se,{type:"primary",size:"small",onClick:V=>O(Y),link:""},{default:a(()=>[...R[7]||(R[7]=[_(" 编辑 ",-1)])]),_:2},1032,["onClick"]),e(se,{type:"danger",size:"small",onClick:V=>I(Y),link:""},{default:a(()=>[...R[8]||(R[8]=[_(" 删除 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[ce,f.value]]),!f.value&&g.value.length===0?(w(),P("div",Td,[e(k(oe),{icon:"material-symbols:inbox-outline",width:"64",height:"64"}),R[11]||(R[11]=s("p",null,"暂无模板",-1)),s("div",Dd,[e(se,{type:"primary",onClick:C},{default:a(()=>[...R[9]||(R[9]=[_("创建模板",-1)])]),_:1}),e(se,{type:"success",onClick:W,loading:v.value},{default:a(()=>[e(k(oe),{icon:"material-symbols:stars"}),R[10]||(R[10]=_(" 加载预设模板 ",-1))]),_:1},8,["loading"])])])):ee("",!0)]),_:1},8,["modelValue"]),e(Vd,{modelValue:c.value,"onUpdate:modelValue":R[1]||(R[1]=Y=>c.value=Y),mode:x.value,"template-data":E.value,onCreated:Z,onUpdated:z},null,8,["modelValue","mode","template-data"])],64)}}},Id=vt(Ad,[["__scopeId","data-v-8b29779b"]]),Fd={class:"email-select-container"},Ud={class:"email-selection-mode"},Pd={key:0,class:"select-actions"},Nd={class:"selected-count"},Md={class:"selected-emails-display"},zd={class:"selected-emails-header"},Od={class:"header-title"},Bd={class:"selected-emails-grid"},jd={key:0,class:"empty-selection-hint"},qd={key:1,class:"email-selector"},Yd={class:"search-bar"},Wd={class:"email-list"},Hd={key:0,class:"skeleton-grid"},Gd=["aria-checked","aria-label","onKeydown"],Kd={class:"email-item-content"},Jd={class:"email-address"},Zd={class:"email-text"},Qd={class:"email-stats"},Xd={class:"stat-item"},eu={class:"stat-item"},tu={key:2,class:"batch-input-container"},au={class:"batch-input-header"},lu={class:"batch-input-tip"},nu={key:3,class:"single-input-container"},ou={class:"form-tip"},su={key:0},iu={key:1},ru={key:2},du={class:"template-selector-container"},uu={style:{"font-size":"12px",color:"#999"}},mu={class:"limit-control"},cu={key:0,style:{display:"flex",gap:"20px","align-items":"center","margin-top":"12px"}},pu={style:{flex:"1"}},fu={style:{flex:"1"}},vu={class:"limit-control"},gu={class:"limit-control"},yu={class:"limit-control"},bu={class:"limit-control"},hu={key:0,class:"form-error"},wu={class:"limit-control"},_u={class:"limit-control"},Eu={class:"announcement-mode-selector"},xu={class:"announcement-editor"},Vu={class:"announcement-section"},Cu={class:"announcement-header"},$u={class:"announcement-section",style:{flex:"1"}},ku={class:"announcement-section"},Su={class:"announcement-section"},Lu={class:"upload-content"},Tu={class:"upload-text"},Du={key:0,class:"images-list"},Ru={class:"image-preview"},Au=["src","alt"],Iu={class:"image-info"},Fu={class:"image-actions"},Uu={key:0,class:"captcha-container"},Pu={class:"dialog-footer"},Nu={class:"preview-content"},Mu={key:0,class:"preview-title"},zu={key:1,class:"preview-images-carousel"},Ou={class:"carousel-item"},Bu=["src","alt"],ju={key:0,class:"image-caption"},qu={class:"carousel-info"},Yu={key:2,class:"preview-text"},Wu={key:3,class:"preview-empty"},Hu={class:"random-generator-content"},Gu={class:"dialog-footer"},Ku={__name:"ShareCreateDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","created"],setup(i,{emit:t}){const l=i,r=t,d=Xn(),f=A(!1),v=A(),g=A(!1),c=A(!1),x=A(!1),E=A(""),h=A(!1),N=A("fromAllEmails"),S=A(!1),W=A([]),C=A(!1),O=A(!1),I=A([]),T=A([]),$=A(0),y=A(1),q=A(20),Z=A(""),z=A("email"),m=A(""),M=A(""),R=A(!1),se=Ue({domain:"",count:10}),B=A("auto"),H=A(null),K=A(""),ge=A(!1),ce=A(0),Y=Ue({title:"",content:"",images:[],displayMode:"always"}),V=Ue({shareType:1,targetEmails:[],shareName:"",shareDomain:"",keywordFilter:"验证码|verification|code|otp",expireTime:"",rateLimitEnabled:!0,rateLimitPerSecond:5,autoRecoverySeconds:60,verificationCodeLimit:100,verificationCodeLimitEnabled:!0,otpLimitDaily:100,otpLimitEnabled:!0,filterMode:1,templateId:"",showFullEmail:!0,latestEmailCount:null,autoRefreshEnabled:!1,autoRefreshInterval:30,cooldownEnabled:!0,cooldownSeconds:10,enableCaptcha:!1,announcementContent:"",useGlobalAnnouncement:!0}),xe=ie(()=>({shareType:[{required:!0,message:"请选择分享类型",trigger:"change"}],targetEmails:[{required:!0,message:"请选择目标邮箱",trigger:"change"},{type:"array",min:1,message:"至少选择一个邮箱",trigger:"change"}],shareName:[{max:100,message:"分享名称长度不能超过 100 个字符",trigger:"blur"}],cooldownSeconds:[{type:"number",min:1,max:300,message:"冷却时间必须在 1-300 秒之间",trigger:"blur"}]}));ie(()=>I.value.filter(n=>!V.targetEmails.includes(n.email))),$e(()=>l.modelValue,n=>{f.value=n,n&&($t(),De(()=>{ae.value.length>0&&(V.shareDomain=ae.value[0].value,console.log("初始化默认域名:",V.shareDomain))}),N.value==="fromAllEmails"&&ye())}),$e(f,n=>{r("update:modelValue",n)});const ye=async()=>{S.value=!0;try{const n=await en({search:Z.value,page:y.value,pageSize:q.value,orderBy:z.value}),o=n.data||n;I.value=o.list||[],$.value=o.total||0}catch(n){console.error("Load emails error:",n),D.error("加载邮箱列表失败")}finally{S.value=!1}},we=n=>{V.targetEmails=[],T.value=[],m.value="",M.value="",n==="fromAllEmails"&&ye()},ne=n=>{const o=n.filter(j=>re(j)?!0:(D.warning(`邮箱格式无效: ${j}`),!1));V.targetEmails=[...o]},L=()=>{N.value==="fromAllEmails"&&(T.value=I.value.map(n=>n.email),V.targetEmails=[...T.value])},u=n=>{const o=T.value.indexOf(n);o>-1?T.value.splice(o,1):T.value.push(n),V.targetEmails=[...T.value]},p=()=>{V.targetEmails=[],T.value=[],m.value="",M.value=""},re=n=>!n||n.length>254?!1:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(n),ae=ie(()=>{const n=[];if(d.domainList&&d.domainList.length>0&&d.domainList.forEach(o=>{const j=o.replace(/^@/,"");n.push({label:`https://${j}`,value:j})}),n.length===0){const o=window.location.host;n.push({label:`${window.location.protocol}//${o} (默认)`,value:o})}return n}),J=(n,o=1)=>{const j=["快速","安全","便捷","智能","高效","专业","可靠","简单"],te=["验证码","邮件","分享","服务","通道","接收"],Q=j[Math.floor(Math.random()*j.length)],de=te[Math.floor(Math.random()*te.length)],je=new Date().toLocaleString("zh-CN",{month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).replace(/[\/\s:]/g,"");return n===2?`${Q}${de}分享-${o}邮箱-${je}`:`${Q}${de}接收-${je}`},ue=()=>{if(!m.value.trim())return;const n=254,o=m.value.split(`
`).map(te=>te.trim()).filter(te=>te).filter(te=>te.length>n?(D.warning(`邮箱地址过长（最多${n}个字符）: ${te}`),!1):re(te));if(o.length===0){D.warning("请输入有效的邮箱地址");return}const j=o.filter(te=>!V.targetEmails.includes(te));V.targetEmails.push(...j),D.success(`成功添加 ${j.length} 个邮箱`)},_e=()=>{M.value.trim()&&re(M.value.trim())&&pe()},pe=()=>{const n=M.value.trim(),o=254;if(!n){D.warning("请输入邮箱地址");return}if(n.length>o){D.warning(`邮箱地址过长（最多${o}个字符）`);return}if(!re(n)){D.warning("请输入有效的邮箱地址");return}if(V.targetEmails.includes(n)){D.warning("该邮箱已存在");return}V.targetEmails.push(n),M.value="",D.success("邮箱添加成功")},Ae=n=>{const o=V.targetEmails.indexOf(n);o>-1&&V.targetEmails.splice(o,1);const j=T.value.indexOf(n);j>-1&&T.value.splice(j,1)},Se=()=>{y.value=1,ye()},Me=n=>{y.value=n,ye()},Ge=n=>{q.value=n,y.value=1,ye()},Le=n=>n?_a(n).format("MM-DD HH:mm"):"未知",Oe=()=>{N.value==="fromAllEmails"&&ye(),D.success("邮箱白名单更新成功")},ve=n=>{De(()=>{v.value?.clearValidate()})},et=n=>{n&&(Y.title="",Y.content="",Y.images=[],Y.displayMode="always",V.announcementContent="")},Be=n=>{if(!n||n.length===0)return null;const o={};n.forEach(Q=>{const de=Q.split("@")[1];de&&(o[de]=(o[de]||0)+1)});let j=null,te=0;for(const[Q,de]of Object.entries(o))de>te&&(te=de,j=Q);return j},yt=n=>{if(!n||n.length===0)return[];const o=new Set;return n.forEach(j=>{const te=j.split("@")[1];te&&o.add(te)}),Array.from(o).sort()},bt=n=>{if(!n||n.length===0)return{};const o={};return n.forEach(j=>{const te=j.split("@")[1];te&&(o[te]=(o[te]||0)+1)}),o},ht=()=>{K.value="",V.autoRefreshInterval===0&&(H.value=null)},rt=()=>{if(K.value="",H.value===null||H.value==="")return K.value="请输入刷新间隔",!1;const n=parseInt(H.value);return isNaN(n)?(K.value="请输入有效的数字",!1):n<1||n>3600?(K.value="刷新间隔必须在1-3600秒之间",!1):!0},fe=()=>{if(V.autoRefreshInterval===0){if(!rt())throw new Error(K.value);return parseInt(H.value)}return V.autoRefreshInterval},$t=()=>{V.shareType=1,V.targetEmails=[],V.shareName="",V.shareDomain="",V.keywordFilter="验证码|verification|code|otp",V.expireTime="",V.verificationCodeLimit=100,V.verificationCodeLimitEnabled=!0,V.otpLimitDaily=100,V.otpLimitEnabled=!0,V.latestEmailCount=null,V.autoRefreshEnabled=!1,V.autoRefreshInterval=30,H.value=null,K.value="",V.filterMode=1,V.templateId="",V.showFullEmail=!0,B.value="auto",T.value=[],m.value="",M.value="",V.announcementContent="",Y.title="",Y.content="",Y.images=[],ge.value=!1,ce.value=0,De(()=>{v.value?.clearValidate()})},It=()=>{if(!Y.title&&!Y.content&&Y.images.length===0)return null;if(!Y.title&&Y.images.length===0&&Y.content)return Y.content;const n={type:"rich",title:Y.title||"",content:Y.content||"",images:Y.images||[],displayMode:Y.displayMode||"always"};return JSON.stringify(n)},Ft=async n=>{const o=Array.from(n.target.files);await Pe(o),n.target.value=""},X=async n=>{const o=Array.from(n.dataTransfer.files);await Pe(o)},Pe=async n=>{const o=n.filter(j=>j.type.startsWith("image/"));if(o.length===0){D.warning("请选择图片文件");return}if(Y.images.length+o.length>10){D.error("公告图片最多10张，当前已有 "+Y.images.length+" 张");return}for(const j of o){if(j.size>500*1024){D.error(`图片 ${j.name} 超过500KB限制`);continue}try{const te=await dt(j);Y.images.push({base64:te,caption:""})}catch(te){D.error(`处理图片 ${j.name} 失败: ${te.message}`)}}},dt=n=>new Promise((o,j)=>{const te=new FileReader;te.onload=()=>o(te.result),te.onerror=j,te.readAsDataURL(n)}),Yt=async n=>{const o=n.clipboardData?.items;if(!o)return;const j=[];for(let te=0;te<o.length;te++){const Q=o[te];if(Q.type.startsWith("image/")){const de=Q.getAsFile();de&&j.push(de)}}j.length>0&&(n.preventDefault(),await Pe(j))},Ut=n=>{Y.images.splice(n,1)},Pt=n=>{if(n>0){const o=Y.images[n];Y.images[n]=Y.images[n-1],Y.images[n-1]=o}},Aa=n=>{if(n<Y.images.length-1){const o=Y.images[n];Y.images[n]=Y.images[n+1],Y.images[n+1]=o}},Wt=async()=>{try{if(await v.value.validate(),V.enableCaptcha&&!E.value)if(x.value){D.error("请先完成人机验证");return}else{x.value=!0,await De(),ma(),D.info("请完成人机验证");return}g.value=!0,console.log("=== 创建分享调试信息 ==="),console.log("域名选择模式:",B.value),console.log("用户选择的域名:",V.shareDomain),console.log("可用域名列表:",ae.value),console.log("表单数据:",JSON.stringify(V,null,2));const n=V.expireTime||_a().add(7,"day").toISOString(),o=[];let j=V.autoRefreshInterval;if(V.autoRefreshEnabled&&V.autoRefreshInterval===0)try{j=fe()}catch(de){D.error(de.message);return}if(V.shareType===2){if(V.targetEmails.length===0){D.warning("请至少选择一个邮箱");return}const de=[...new Set(V.targetEmails.map(qe=>qe.trim().toLowerCase()))];if(de.length===0){D.warning("去重后没有有效的邮箱");return}const je=yt(de),Re=bt(de),ke=je.length>1;let Ke=V.shareDomain;if(B.value==="auto"){const qe=Be(de);if(qe){const ut=ae.value.find(nt=>nt.value.includes(qe));if(ut&&(Ke=ut.value,console.log("自动匹配域名:",qe,"-> 完整值:",Ke),ke)){const nt=je.map(tt=>`${tt} (${Re[tt]}个)`).join("、");D.warning({message:`检测到多个邮箱域名: ${nt}。系统将使用最频繁的域名 "${qe}" 作为分享链接域名，其他域名的邮箱也可以正常访问。`,duration:5e3})}}}else if(ke){const qe=je.map(ut=>`${ut} (${Re[ut]}个)`).join("、");D.info({message:`邮箱列表包含多个域名: ${qe}。所有域名的邮箱都可以访问此分享链接。`,duration:4e3})}const Nt={targetEmail:de[0],authorizedEmails:de,shareName:V.shareName||J(2,de.length),shareDomain:Ke,keywordFilter:V.keywordFilter,expireTime:n,shareType:2,rateLimitPerSecond:V.rateLimitEnabled?V.rateLimitPerSecond:0,autoRecoverySeconds:V.autoRecoverySeconds,verificationCodeLimit:V.verificationCodeLimit,verificationCodeLimitEnabled:V.verificationCodeLimitEnabled,otpLimitDaily:V.otpLimitDaily,otpLimitEnabled:V.otpLimitEnabled,latestEmailCount:V.latestEmailCount,autoRefreshEnabled:V.autoRefreshEnabled,autoRefreshInterval:j,filterMode:V.filterMode,templateId:V.templateId,showFullEmail:V.showFullEmail,cooldownEnabled:V.cooldownEnabled,cooldownSeconds:V.cooldownSeconds,announcementContent:V.useGlobalAnnouncement?null:It(),useGlobalAnnouncement:V.useGlobalAnnouncement,captchaToken:V.enableCaptcha?E.value:void 0};try{const qe=await gl(Nt);o.push({email:`多邮箱分享 (${V.targetEmails.length}个)`,success:!0,result:qe})}catch(qe){o.push({email:"多邮箱分享",success:!1,error:qe.message})}}else for(const de of V.targetEmails){const je={targetEmail:de,shareName:V.shareName||J(1),shareDomain:V.shareDomain,keywordFilter:V.keywordFilter,expireTime:n,shareType:1,verificationCodeLimit:V.verificationCodeLimit,verificationCodeLimitEnabled:V.verificationCodeLimitEnabled,otpLimitDaily:V.otpLimitDaily,otpLimitEnabled:V.otpLimitEnabled,latestEmailCount:V.latestEmailCount,autoRefreshEnabled:V.autoRefreshEnabled,autoRefreshInterval:j,filterMode:V.filterMode,templateId:V.templateId,showFullEmail:V.showFullEmail,rateLimitPerSecond:V.rateLimitEnabled?V.rateLimitPerSecond:0,autoRecoverySeconds:V.autoRecoverySeconds,cooldownEnabled:V.cooldownEnabled,cooldownSeconds:V.cooldownSeconds,announcementContent:V.useGlobalAnnouncement?null:It(),useGlobalAnnouncement:V.useGlobalAnnouncement,captchaToken:V.enableCaptcha?E.value:void 0};try{console.log("发送给后端的数据:",JSON.stringify(je,null,2));const Re=await gl(je);o.push({email:de,success:!0,result:Re})}catch(Re){console.error("创建分享失败:",Re),o.push({email:de,success:!1,error:Re.message})}}const te=o.filter(de=>de.success).length,Q=o.length-te;te>0&&D.success(`成功创建 ${te} 个邮箱分享`),Q>0&&D.warning(`${Q} 个邮箱分享创建失败`),r("created",o),Gt()}catch(n){n.message&&D.error(n.message)}finally{g.value=!1}},Ht=n=>{const o="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let j="";for(let te=0;te<n;te++)j+=o.charAt(Math.floor(Math.random()*o.length));return j},Ia=(n,o)=>{const j=new Set,te=o*10;let Q=0;for(;j.size<o&&Q<te;){const de=Math.floor(Math.random()*22)+4,Re=`${Ht(de)}@${n}`;j.add(Re),Q++}return Array.from(j)},Fa=()=>{if(!se.domain){D.warning("请选择域名");return}try{const n=Ia(se.domain,se.count),j=[...m.value.trim()?m.value.trim().split(`
`):[],...n],te=[...new Set(j.map(Q=>Q.toLowerCase()))];m.value=te.join(`
`),ue(),D.success(`成功生成 ${n.length} 个随机邮箱`),R.value=!1}catch(n){D.error("生成随机邮箱失败: "+n.message)}},Ua=()=>{se.domain="",se.count=10},kt=async()=>{O.value=!0;try{const n=await Wr(),o=n.data||n;W.value=o.data||o||[]}catch(n){console.error("Load templates error:",n),D.error("加载模板列表失败")}finally{O.value=!1}},Pa=n=>{n===2?kt():V.templateId=""},Na=n=>{console.log("Selected template:",n)},Ma=()=>{kt()},Gt=()=>{f.value=!1,x.value=!1,E.value="",h.value=!1},ma=()=>{const n=d.settings?.siteKey||"1x00000000000000000000AA";if(window.turnstile)window.turnstile.render("#cf-turnstile-create",{sitekey:n,theme:"light",callback:ca,"error-callback":b});else{const o=document.createElement("script");o.src="https://challenges.cloudflare.com/turnstile/v0/api.js",o.async=!0,o.defer=!0,o.onload=()=>{window.turnstile.render("#cf-turnstile-create",{sitekey:n,theme:"light",callback:ca,"error-callback":b})},o.onerror=()=>{D.error("Turnstile 脚本加载失败，请重试"),x.value=!1},document.head.appendChild(o)}},ca=n=>{console.log("Turnstile 验证成功，token:",n),E.value=n,D.success("人机验证成功")},b=()=>{console.error("Turnstile 验证失败"),D.error("人机验证失败，请重试"),E.value=""};return(n,o)=>{const j=il,te=Sa,Q=At,de=gt,je=Bt,Re=Dt,ke=qt,Ke=jt,Nt=ka,qe=ol,ut=Ta,nt=ia,tt=da,ot=La,Mt=Tt,at=Rt,Kt=ft,pa=Xl,Ye=Ql,za=ra,Oa=Lo;return w(),P(Ee,null,[e(Kt,{modelValue:f.value,"onUpdate:modelValue":o[41]||(o[41]=U=>f.value=U),title:"创建邮箱分享",width:"1200px","close-on-click-modal":!1,onClose:Gt,class:"create-share-dialog"},{footer:a(()=>[s("div",Pu,[e(de,{onClick:Gt},{default:a(()=>[...o[106]||(o[106]=[_("取消",-1)])]),_:1}),e(de,{type:"primary",onClick:Wt,loading:g.value},{default:a(()=>[_(G(x.value?"验证后创建分享":"创建分享"),1)]),_:1},8,["loading"])])]),default:a(()=>[e(at,{ref_key:"formRef",ref:v,model:V,rules:xe.value,"label-width":"120px",onSubmit:o[40]||(o[40]=st(()=>{},["prevent"]))},{default:a(()=>[e(Q,{label:"分享类型",prop:"shareType"},{default:a(()=>[e(te,{modelValue:V.shareType,"onUpdate:modelValue":o[0]||(o[0]=U=>V.shareType=U),onChange:ve},{default:a(()=>[e(j,{value:1},{default:a(()=>[...o[49]||(o[49]=[s("div",{class:"share-type-option"},[s("div",{class:"option-title"},"单邮箱分享"),s("div",{class:"option-desc"},"为指定邮箱创建专用分享链接")],-1)])]),_:1}),e(j,{value:2},{default:a(()=>[...o[50]||(o[50]=[s("div",{class:"share-type-option"},[s("div",{class:"option-title"},"邮箱输入分享"),s("div",{class:"option-desc"},"访问者需输入指定邮箱进行验证")],-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(Q,{label:"目标邮箱",prop:"targetEmails"},{default:a(()=>[s("div",Fd,[s("div",Ud,[e(te,{modelValue:N.value,"onUpdate:modelValue":o[1]||(o[1]=U=>N.value=U),onChange:we},{default:a(()=>[e(j,{value:"fromAllEmails"},{default:a(()=>[...o[51]||(o[51]=[_("从全部邮件选择",-1)])]),_:1}),e(j,{value:"batchInput"},{default:a(()=>[...o[52]||(o[52]=[_("批量输入",-1)])]),_:1}),e(j,{value:"singleInput"},{default:a(()=>[...o[53]||(o[53]=[_("单个输入",-1)])]),_:1})]),_:1},8,["modelValue"])]),N.value==="fromAllEmails"?(w(),P("div",Pd,[e(de,{size:"small",onClick:L,disabled:S.value},{default:a(()=>[e(k(oe),{icon:"material-symbols:select-all"}),o[54]||(o[54]=_(" 全选 ",-1))]),_:1},8,["disabled"]),e(de,{size:"small",onClick:p,disabled:S.value},{default:a(()=>[e(k(oe),{icon:"material-symbols:clear-all"}),o[55]||(o[55]=_(" 清空 ",-1))]),_:1},8,["disabled"]),s("span",Nd,"已选择 "+G(V.targetEmails.length)+" 个邮箱",1)])):ee("",!0),s("div",Md,[s("div",zd,[s("span",Od,"已选择的邮箱 ("+G(V.targetEmails.length)+")",1)]),s("div",Bd,[(w(!0),P(Ee,null,Te(V.targetEmails,U=>(w(),le(je,{key:U,closable:"",onClose:We=>Ae(U),class:"selected-email-tag",size:"large",type:"primary"},{default:a(()=>[e(k(oe),{icon:"material-symbols:email",class:"email-icon"}),_(" "+G(U),1)]),_:2},1032,["onClose"]))),128)),V.targetEmails.length===0?(w(),P("div",jd,[e(k(oe),{icon:"material-symbols:info-outline"}),o[56]||(o[56]=s("span",null,"请从下方列表中选择邮箱",-1))])):ee("",!0)])]),N.value==="fromAllEmails"?(w(),P("div",qd,[s("div",Yd,[e(Re,{modelValue:Z.value,"onUpdate:modelValue":o[2]||(o[2]=U=>Z.value=U),placeholder:"搜索邮箱地址...",clearable:"",onInput:Se,class:"search-input"},{prefix:a(()=>[e(k(oe),{icon:"material-symbols:search"})]),_:1},8,["modelValue"]),e(Ke,{modelValue:z.value,"onUpdate:modelValue":o[3]||(o[3]=U=>z.value=U),onChange:ye,class:"sort-select"},{default:a(()=>[e(ke,{label:"按邮箱排序",value:"email"}),e(ke,{label:"按邮件数量排序",value:"count"}),e(ke,{label:"按最后来件时间排序",value:"time"})]),_:1},8,["modelValue"])]),s("div",Wd,[S.value?(w(),P("div",Hd,[(w(),P(Ee,null,Te(10,U=>s("div",{key:`skeleton-${U}`,class:"skeleton-item"},[...o[57]||(o[57]=[s("div",{class:"skeleton-checkbox"},null,-1),s("div",{class:"skeleton-content"},[s("div",{class:"skeleton-email"}),s("div",{class:"skeleton-stats"},[s("div",{class:"skeleton-stat"}),s("div",{class:"skeleton-stat"})])],-1)])])),64))])):(w(),le(qe,{key:1,modelValue:T.value,"onUpdate:modelValue":o[4]||(o[4]=U=>T.value=U),onChange:ne},{default:a(()=>[(w(!0),P(Ee,null,Te(I.value,(U,We)=>(w(),P("div",{key:U.email,class:me(["email-item",{selected:T.value.includes(U.email)}]),tabindex:"0",role:"checkbox","aria-checked":T.value.includes(U.email),"aria-label":`${U.email}, ${U.emailCount} 封邮件`,onKeydown:[ct(st(wt=>u(U.email),["prevent"]),["space"]),ct(st(wt=>u(U.email),["prevent"]),["enter"])]},[e(Nt,{label:U.email},{default:a(()=>[s("div",Kd,[s("div",Jd,[e(k(oe),{icon:"material-symbols:email",class:"email-icon"}),s("span",Zd,G(U.email),1)]),s("div",Qd,[s("span",Xd,[e(k(oe),{icon:"material-symbols:mail"}),_(" "+G(U.emailCount)+" 封邮件 ",1)]),s("span",eu,[e(k(oe),{icon:"material-symbols:schedule"}),_(" "+G(Le(U.latestReceiveTime)),1)])])])]),_:2},1032,["label"])],42,Gd))),128))]),_:1},8,["modelValue"]))]),$.value>q.value?(w(),le(ut,{key:0,"current-page":y.value,"onUpdate:currentPage":o[5]||(o[5]=U=>y.value=U),"page-size":q.value,"onUpdate:pageSize":o[6]||(o[6]=U=>q.value=U),total:$.value,"page-sizes":[20,50,100],layout:"total, sizes, prev, pager, next",onCurrentChange:Me,onSizeChange:Ge,class:"pagination"},null,8,["current-page","page-size","total"])):ee("",!0)])):ee("",!0),N.value==="batchInput"?(w(),P("div",tu,[s("div",au,[o[59]||(o[59]=s("span",{class:"batch-input-title"},"邮箱列表",-1)),e(de,{type:"primary",size:"small",onClick:o[7]||(o[7]=U=>R.value=!0),icon:k(oe)},{default:a(()=>[e(k(oe),{icon:"material-symbols:auto-awesome"}),o[58]||(o[58]=_(" 随机生成 ",-1))]),_:1},8,["icon"])]),e(Re,{modelValue:m.value,"onUpdate:modelValue":o[8]||(o[8]=U=>m.value=U),type:"textarea",rows:8,placeholder:`请输入邮箱地址，一行一个：
user1@example.com
user2@example.com
user3@example.com`,onBlur:ue},null,8,["modelValue"]),s("div",lu,[e(k(oe),{icon:"material-symbols:info"}),o[60]||(o[60]=_(" 支持粘贴多个邮箱地址，一行一个，系统会自动去重和格式验证 ",-1))])])):ee("",!0),N.value==="singleInput"?(w(),P("div",nu,[e(Re,{modelValue:M.value,"onUpdate:modelValue":o[9]||(o[9]=U=>M.value=U),placeholder:"请输入邮箱地址，如：user@example.com",onBlur:_e},{prefix:a(()=>[e(k(oe),{icon:"material-symbols:email"})]),append:a(()=>[e(de,{onClick:pe,disabled:!re(M.value)},{default:a(()=>[...o[61]||(o[61]=[_(" 添加 ",-1)])]),_:1},8,["disabled"])]),_:1},8,["modelValue"])])):ee("",!0)]),s("div",ou,[V.shareType===1?(w(),P("span",su,'从邮箱白名单中选择要分享的邮箱。如需添加新邮箱，请点击"管理邮箱白名单"按钮。')):(w(),P("span",iu,"选择允许访问的目标邮箱。访问者需要输入这些邮箱地址才能查看验证码。"))])]),_:1}),e(Q,{label:"分享名称",prop:"shareName"},{default:a(()=>[e(Re,{modelValue:V.shareName,"onUpdate:modelValue":o[10]||(o[10]=U=>V.shareName=U),placeholder:"留空将自动生成分享名称",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(Q,{label:"域名选择方式"},{default:a(()=>[e(te,{modelValue:B.value,"onUpdate:modelValue":o[11]||(o[11]=U=>B.value=U)},{default:a(()=>[e(j,{value:"auto"},{default:a(()=>[...o[62]||(o[62]=[_("自动匹配邮箱域名",-1)])]),_:1}),e(j,{value:"manual"},{default:a(()=>[...o[63]||(o[63]=[_("手动选择域名",-1)])]),_:1})]),_:1},8,["modelValue"]),o[64]||(o[64]=s("div",{class:"form-tip"}," 自动模式：从邮箱列表中自动选择最频繁的域名；手动模式：手动选择分享链接的域名 ",-1))]),_:1}),B.value==="manual"?(w(),le(Q,{key:0,label:"分享域名",prop:"shareDomain"},{default:a(()=>[e(Ke,{modelValue:V.shareDomain,"onUpdate:modelValue":o[12]||(o[12]=U=>V.shareDomain=U),placeholder:"选择分享链接的域名",style:{width:"100%"}},{default:a(()=>[(w(!0),P(Ee,null,Te(ae.value,U=>(w(),le(ke,{key:U.value,label:U.label,value:U.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),o[65]||(o[65]=s("div",{class:"form-tip"}," 选择生成分享链接使用的域名。本地开发时会自动检测端口。 ",-1))]),_:1})):ee("",!0),e(Q,{label:"过滤模式",prop:"filterMode"},{default:a(()=>[e(te,{modelValue:V.filterMode,"onUpdate:modelValue":o[13]||(o[13]=U=>V.filterMode=U),onChange:Pa},{default:a(()=>[e(j,{label:1},{default:a(()=>[...o[66]||(o[66]=[_("关键词过滤",-1)])]),_:1}),e(j,{label:2},{default:a(()=>[...o[67]||(o[67]=[_("模板匹配",-1)])]),_:1})]),_:1},8,["modelValue"]),o[68]||(o[68]=s("div",{class:"form-tip"}," 关键词过滤：通过关键词匹配邮件内容；模板匹配：使用预定义模板精确提取验证码 ",-1))]),_:1}),V.filterMode===1?(w(),le(Q,{key:1,label:"关键词过滤",prop:"keywordFilter"},{default:a(()=>[e(Re,{modelValue:V.keywordFilter,"onUpdate:modelValue":o[14]||(o[14]=U=>V.keywordFilter=U),placeholder:"验证码|verification|code|otp",maxlength:"200"},null,8,["modelValue"]),o[69]||(o[69]=s("div",{class:"form-tip"},' 用于过滤包含特定关键词的邮件，多个关键词用"|"分隔 ',-1))]),_:1})):ee("",!0),V.filterMode===2?(w(),P("div",ru,[e(Q,{label:"选择模板",prop:"templateId"},{default:a(()=>[s("div",du,[e(Ke,{modelValue:V.templateId,"onUpdate:modelValue":o[15]||(o[15]=U=>V.templateId=U),placeholder:"请选择邮件模板",class:"template-select",onChange:Na},{default:a(()=>[(w(!0),P(Ee,null,Te(W.value,U=>(w(),le(ke,{key:U.id,label:U.name,value:U.id},{default:a(()=>[s("div",null,[s("div",null,G(U.name),1),s("div",uu,G(U.description),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),e(de,{type:"primary",class:"manage-template-btn",onClick:o[16]||(o[16]=U=>C.value=!0)},{default:a(()=>[...o[70]||(o[70]=[_("管理模板",-1)])]),_:1})]),o[71]||(o[71]=s("div",{class:"form-tip"}," 选择预定义的邮件模板进行精确匹配和验证码提取 ",-1))]),_:1}),e(Q,{label:"显示选项"},{default:a(()=>[e(Nt,{modelValue:V.showFullEmail,"onUpdate:modelValue":o[17]||(o[17]=U=>V.showFullEmail=U)},{default:a(()=>[...o[72]||(o[72]=[_("显示完整邮件内容",-1)])]),_:1},8,["modelValue"]),o[73]||(o[73]=s("div",{class:"form-tip"}," 取消勾选时，仅显示提取的验证码，不显示完整邮件内容 ",-1))]),_:1})])):ee("",!0),e(Q,{label:"过期时间",prop:"expireTime"},{default:a(()=>[e(nt,{modelValue:V.expireTime,"onUpdate:modelValue":o[18]||(o[18]=U=>V.expireTime=U),type:"datetime",placeholder:"选择过期时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",style:{width:"100%"}},null,8,["modelValue"]),o[74]||(o[74]=s("div",{class:"form-tip"}," 不设置则默认7天后过期 ",-1))]),_:1}),e(Q,{label:"频率限制"},{default:a(()=>[s("div",mu,[e(tt,{modelValue:V.rateLimitEnabled,"onUpdate:modelValue":o[19]||(o[19]=U=>V.rateLimitEnabled=U),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),o[75]||(o[75]=s("span",{class:"unit-text",style:{"margin-left":"12px"}},"启用后可设置访问频率限制",-1))]),V.rateLimitEnabled?(w(),P("div",cu,[s("div",pu,[e(ot,{modelValue:V.rateLimitPerSecond,"onUpdate:modelValue":o[20]||(o[20]=U=>V.rateLimitPerSecond=U),min:1,max:100,placeholder:"每秒最大请求数",style:{width:"100%"}},null,8,["modelValue"]),o[76]||(o[76]=s("div",{class:"form-tip"},"每秒最大请求数（默认5次，防止极端恶意攻击）",-1))]),s("div",fu,[e(ot,{modelValue:V.autoRecoverySeconds,"onUpdate:modelValue":o[21]||(o[21]=U=>V.autoRecoverySeconds=U),min:0,max:3600,placeholder:"自动恢复时间",style:{width:"100%"}},null,8,["modelValue"]),o[77]||(o[77]=s("div",{class:"form-tip"},"触发限制后需等待的秒数（默认60秒，0表示禁用自动恢复）",-1))])])):ee("",!0),o[78]||(o[78]=s("div",{class:"form-tip"}," 禁用频率限制后，访问者可以无限制地请求验证码。建议仅在信任环境中禁用。 ",-1))]),_:1}),e(Q,{label:"显示数量限制"},{default:a(()=>[s("div",vu,[e(tt,{modelValue:V.verificationCodeLimitEnabled,"onUpdate:modelValue":o[22]||(o[22]=U=>V.verificationCodeLimitEnabled=U),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),e(ot,{modelValue:V.verificationCodeLimit,"onUpdate:modelValue":o[23]||(o[23]=U=>V.verificationCodeLimit=U),min:1,max:1e3,step:10,disabled:!V.verificationCodeLimitEnabled,style:{width:"150px","margin-left":"12px"}},null,8,["modelValue","disabled"]),o[79]||(o[79]=s("span",{class:"unit-text"},"条",-1))]),o[80]||(o[80]=s("div",{class:"form-tip"}," 控制每次访问最多显示的验证码数量。禁用后显示全部验证码。 ",-1))]),_:1}),e(Q,{label:"访问次数限制"},{default:a(()=>[s("div",gu,[e(tt,{modelValue:V.otpLimitEnabled,"onUpdate:modelValue":o[24]||(o[24]=U=>V.otpLimitEnabled=U),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),e(ot,{modelValue:V.otpLimitDaily,"onUpdate:modelValue":o[25]||(o[25]=U=>V.otpLimitDaily=U),min:1,max:1e4,step:10,disabled:!V.otpLimitEnabled,style:{width:"150px","margin-left":"12px"}},null,8,["modelValue","disabled"]),o[81]||(o[81]=s("span",{class:"unit-text"},"次/天",-1))]),o[82]||(o[82]=s("div",{class:"form-tip"}," 控制每天最多可以访问的次数。禁用后无限制访问。 ",-1))]),_:1}),e(Q,{label:"最新邮件显示数量"},{default:a(()=>[s("div",yu,[e(ot,{modelValue:V.latestEmailCount,"onUpdate:modelValue":o[26]||(o[26]=U=>V.latestEmailCount=U),min:1,max:100,step:1,placeholder:"留空显示全部",style:{width:"200px"},clearable:""},null,8,["modelValue"]),o[83]||(o[83]=s("span",{class:"unit-text"},"封",-1))]),o[84]||(o[84]=s("div",{class:"form-tip"}," 控制分享链接最多显示多少封最新邮件。留空表示显示全部邮件。 ",-1))]),_:1}),e(Q,{label:"自动刷新"},{default:a(()=>[s("div",bu,[e(tt,{modelValue:V.autoRefreshEnabled,"onUpdate:modelValue":o[27]||(o[27]=U=>V.autoRefreshEnabled=U),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),e(Ke,{modelValue:V.autoRefreshInterval,"onUpdate:modelValue":o[28]||(o[28]=U=>V.autoRefreshInterval=U),disabled:!V.autoRefreshEnabled,style:{width:"120px","margin-left":"12px"},onChange:ht},{default:a(()=>[e(ke,{label:"5秒",value:5}),e(ke,{label:"10秒",value:10}),e(ke,{label:"19秒",value:19}),e(ke,{label:"30秒",value:30}),e(ke,{label:"60秒",value:60}),e(ke,{label:"120秒",value:120}),e(ke,{label:"300秒",value:300}),e(ke,{label:"自定义",value:0})]),_:1},8,["modelValue","disabled"]),o[85]||(o[85]=s("span",{class:"unit-text"},"间隔",-1)),V.autoRefreshInterval===0&&V.autoRefreshEnabled?(w(),le(Re,{key:0,modelValue:H.value,"onUpdate:modelValue":o[29]||(o[29]=U=>H.value=U),modelModifiers:{number:!0},type:"number",placeholder:"输入秒数(1-3600)",style:{width:"120px","margin-left":"12px"},min:1,max:3600,onInput:rt},null,8,["modelValue"])):ee("",!0)]),o[86]||(o[86]=s("div",{class:"form-tip"}," 启用后，访问者的页面会自动刷新获取最新邮件。自定义间隔范围：1-3600秒。 ",-1)),K.value?(w(),P("div",hu,G(K.value),1)):ee("",!0)]),_:1}),e(Q,{label:"获取验证码冷却"},{default:a(()=>[s("div",wu,[e(tt,{modelValue:V.cooldownEnabled,"onUpdate:modelValue":o[30]||(o[30]=U=>V.cooldownEnabled=U),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),e(ot,{modelValue:V.cooldownSeconds,"onUpdate:modelValue":o[31]||(o[31]=U=>V.cooldownSeconds=U),min:1,max:300,step:1,disabled:!V.cooldownEnabled,style:{width:"120px","margin-left":"12px"}},null,8,["modelValue","disabled"]),o[87]||(o[87]=s("span",{class:"unit-text"},"秒",-1))]),o[88]||(o[88]=s("div",{class:"form-tip"},' 控制点击"获取最新验证码"按钮后的冷却时间。禁用后可无限制点击。 ',-1))]),_:1}),e(Q,{label:"人机验证"},{default:a(()=>[s("div",_u,[e(tt,{modelValue:V.enableCaptcha,"onUpdate:modelValue":o[32]||(o[32]=U=>V.enableCaptcha=U),"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"]),o[89]||(o[89]=s("span",{class:"unit-text",style:{"margin-left":"12px"}},"启用后触发频率限制时需要进行人机验证",-1))]),o[90]||(o[90]=s("div",{class:"form-tip"}," 启用Cloudflare Turnstile人机验证，防止恶意访问。当访问频率超过限制时，访问者需要完成验证才能继续访问。 ",-1))]),_:1}),e(Q,{label:"公告设置",prop:"useGlobalAnnouncement"},{default:a(()=>[s("div",Eu,[e(te,{modelValue:V.useGlobalAnnouncement,"onUpdate:modelValue":o[33]||(o[33]=U=>V.useGlobalAnnouncement=U),onChange:et},{default:a(()=>[e(j,{value:!0},{default:a(()=>[...o[91]||(o[91]=[s("div",{class:"mode-option"},[s("div",{class:"mode-title"},"使用全局公告"),s("div",{class:"mode-desc"},"应用系统管理员设置的全局公告")],-1)])]),_:1}),e(j,{value:!1},{default:a(()=>[...o[92]||(o[92]=[s("div",{class:"mode-option"},[s("div",{class:"mode-title"},"自定义公告"),s("div",{class:"mode-desc"},"为此分享链接设置自定义公告")],-1)])]),_:1})]),_:1},8,["modelValue"])])]),_:1}),V.useGlobalAnnouncement?ee("",!0):(w(),le(Q,{key:3,label:"公告内容",prop:"announcementContent"},{default:a(()=>[s("div",xu,[s("div",Vu,[o[95]||(o[95]=s("label",{class:"section-label"},"展示次数",-1)),e(te,{modelValue:Y.displayMode,"onUpdate:modelValue":o[34]||(o[34]=U=>Y.displayMode=U)},{default:a(()=>[e(j,{label:"always"},{default:a(()=>[...o[93]||(o[93]=[_("每次访问都显示",-1)])]),_:1}),e(j,{label:"once"},{default:a(()=>[...o[94]||(o[94]=[_("仅显示一次",-1)])]),_:1})]),_:1},8,["modelValue"]),o[96]||(o[96]=s("div",{class:"form-tip"},'选择"仅显示一次"时，用户关闭公告后不会再看到',-1))]),s("div",Cu,[s("div",$u,[o[97]||(o[97]=s("label",{class:"section-label"},"公告标题（可选）",-1)),e(Re,{modelValue:Y.title,"onUpdate:modelValue":o[35]||(o[35]=U=>Y.title=U),placeholder:"输入公告标题",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),e(de,{type:"primary",onClick:o[36]||(o[36]=U=>ge.value=!0),style:{"align-self":"flex-end","margin-bottom":"0"}},{default:a(()=>[...o[98]||(o[98]=[_(" 预览公告 ",-1)])]),_:1})]),s("div",ku,[o[99]||(o[99]=s("label",{class:"section-label"},"公告文本（支持粘贴图片）",-1)),e(Re,{modelValue:Y.content,"onUpdate:modelValue":o[37]||(o[37]=U=>Y.content=U),type:"textarea",placeholder:"输入公告内容（可选）或粘贴图片",maxlength:"5000","show-word-limit":"",rows:3,onPaste:Yt},null,8,["modelValue"])]),s("div",Su,[o[103]||(o[103]=s("label",{class:"section-label"},"公告图片（可选，最多10张）",-1)),s("div",{class:"upload-area",onDragover:o[39]||(o[39]=st(()=>{},["prevent"])),onDrop:st(X,["prevent"])},[s("div",Lu,[e(Mt,{class:"upload-icon"},{default:a(()=>[e(k(Ml))]),_:1}),s("div",Tu,[o[101]||(o[101]=s("div",null,"拖拽图片到此处或",-1)),e(de,{link:"",type:"primary",onClick:o[38]||(o[38]=U=>n.$refs.fileInput.click())},{default:a(()=>[...o[100]||(o[100]=[_(" 点击选择文件 ",-1)])]),_:1})]),o[102]||(o[102]=s("div",{class:"upload-hint"},"支持 PNG、JPG、GIF、WebP 格式，单张≤500KB，总大小≤5MB",-1))]),s("input",{ref:"fileInput",type:"file",multiple:"",accept:"image/*",style:{display:"none"},onChange:Ft},null,544)],32),Y.images&&Y.images.length>0?(w(),P("div",Du,[(w(!0),P(Ee,null,Te(Y.images,(U,We)=>(w(),P("div",{key:We,class:"image-item"},[s("div",Ru,[s("img",{src:U.base64,alt:`Image ${We+1}`},null,8,Au)]),s("div",Iu,[e(Re,{modelValue:U.caption,"onUpdate:modelValue":wt=>U.caption=wt,placeholder:"图片说明（可选）",maxlength:"100","show-word-limit":""},null,8,["modelValue","onUpdate:modelValue"])]),s("div",Fu,[We>0?(w(),le(de,{key:0,link:"",type:"primary",onClick:wt=>Pt(We),title:"向上移动"},{default:a(()=>[e(Mt,null,{default:a(()=>[e(k(zl))]),_:1})]),_:2},1032,["onClick"])):ee("",!0),We<Y.images.length-1?(w(),le(de,{key:1,link:"",type:"primary",onClick:wt=>Aa(We),title:"向下移动"},{default:a(()=>[e(Mt,null,{default:a(()=>[e(k(Ol))]),_:1})]),_:2},1032,["onClick"])):ee("",!0),e(de,{link:"",type:"danger",onClick:wt=>Ut(We),title:"删除"},{default:a(()=>[e(Mt,null,{default:a(()=>[e(k(ll))]),_:1})]),_:2},1032,["onClick"])])]))),128))])):ee("",!0),o[104]||(o[104]=s("div",{class:"form-tip"}," 支持拖拽上传、点击选择或粘贴图片。图片会自动压缩。访问者可以关闭公告，同一设备不会再次显示。 ",-1))])])]),_:1}))]),_:1},8,["model","rules"]),x.value?(w(),P("div",Uu,[...o[105]||(o[105]=[s("div",{class:"captcha-header"},[s("h4",null,"人机验证"),s("p",null,"请完成人机验证以继续创建分享")],-1),s("div",{id:"cf-turnstile-create",class:"cf-turnstile-widget"},null,-1)])])):ee("",!0)]),_:1},8,["modelValue"]),e(Oa,{modelValue:ge.value,"onUpdate:modelValue":o[42]||(o[42]=U=>ge.value=U),title:"公告预览",direction:"rtl",size:"500px",class:"announcement-preview-drawer"},{default:a(()=>[s("div",Nu,[Y.title?(w(),P("div",Mu,G(Y.title),1)):ee("",!0),Y.images&&Y.images.length>0?(w(),P("div",zu,[e(Ye,{autoplay:!1,class:"carousel"},{default:a(()=>[(w(!0),P(Ee,null,Te(Y.images,(U,We)=>(w(),le(pa,{key:We},{default:a(()=>[s("div",Ou,[s("img",{src:U.base64,alt:`Image ${We+1}`},null,8,Bu),U.caption?(w(),P("div",ju,G(U.caption),1)):ee("",!0)])]),_:2},1024))),128))]),_:1}),s("div",qu,G(ce.value+1)+" / "+G(Y.images.length),1)])):ee("",!0),Y.content?(w(),P("div",Yu,G(Y.content),1)):ee("",!0),!Y.title&&!Y.content&&(!Y.images||Y.images.length===0)?(w(),P("div",Wu,[e(za,{description:"暂无公告内容"})])):ee("",!0)])]),_:1},8,["modelValue"]),e(Cn,{modelValue:c.value,"onUpdate:modelValue":o[43]||(o[43]=U=>c.value=U),onUpdated:Oe},null,8,["modelValue"]),e(Id,{modelValue:C.value,"onUpdate:modelValue":o[44]||(o[44]=U=>C.value=U),onUpdated:Ma},null,8,["modelValue"]),e(Kt,{modelValue:R.value,"onUpdate:modelValue":o[48]||(o[48]=U=>R.value=U),title:"随机生成邮箱",width:"500px",onClose:Ua},{footer:a(()=>[s("div",Gu,[e(de,{onClick:o[47]||(o[47]=U=>R.value=!1)},{default:a(()=>[...o[110]||(o[110]=[_("取消",-1)])]),_:1}),e(de,{type:"primary",onClick:Fa},{default:a(()=>[...o[111]||(o[111]=[_(" 生成 ",-1)])]),_:1})])]),default:a(()=>[s("div",Hu,[e(at,{model:se,"label-width":"100px"},{default:a(()=>[e(Q,{label:"选择域名"},{default:a(()=>[e(Ke,{modelValue:se.domain,"onUpdate:modelValue":o[45]||(o[45]=U=>se.domain=U),placeholder:"选择域名",style:{width:"100%"}},{default:a(()=>[(w(!0),P(Ee,null,Te(ae.value,U=>(w(),le(ke,{key:U.value,label:U.label,value:U.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(Q,{label:"生成数量"},{default:a(()=>[e(te,{modelValue:se.count,"onUpdate:modelValue":o[46]||(o[46]=U=>se.count=U)},{default:a(()=>[e(j,{value:10},{default:a(()=>[...o[107]||(o[107]=[_("10个",-1)])]),_:1}),e(j,{value:20},{default:a(()=>[...o[108]||(o[108]=[_("20个",-1)])]),_:1}),e(j,{value:100},{default:a(()=>[...o[109]||(o[109]=[_("100个",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["modelValue"])],64)}}},Ju=vt(Ku,[["__scopeId","data-v-ac535617"]]),Zu={class:"tab-content"},Qu={class:"settings-section"},Xu={class:"authorized-emails-container"},em={class:"email-input-group"},tm={key:0,class:"email-list"},am={key:1,class:"form-tip"},lm={class:"share-url-display"},nm={class:"settings-section"},om={class:"settings-section"},sm={class:"announcement-tab-content"},im={class:"announcement-editor-container"},rm={class:"announcement-editor"},dm={class:"content-editor-wrapper"},um={class:"editor-toolbar"},mm={class:"image-upload-area"},cm={key:0,class:"image-list"},pm=["src","alt"],fm={class:"image-actions"},vm={class:"announcement-preview-container"},gm={class:"announcement-preview"},ym={key:0,class:"preview-title"},bm={key:1,class:"preview-carousel"},hm=["src","alt"],wm=["innerHTML"],_m={key:3,class:"preview-empty"},Em={__name:"ShareAdvancedEditDialog",props:{modelValue:{type:Boolean,default:!1},shareData:{type:Object,default:()=>({})}},emits:["update:modelValue","updated"],setup(i,{emit:t}){const l=i,r=t,d=A(!1),f=A(!1),v=A("basic");A(!1);const g=A(null),c=A([]),x=A([]),E=[{label:"红色",value:"#FF0000",tag:"red"},{label:"绿色",value:"#00AA00",tag:"green"},{label:"蓝色",value:"#0066FF",tag:"blue"},{label:"黄色",value:"#FFAA00",tag:"yellow"}],h=Ue({shareId:"",shareName:"",expireTime:"",otpLimitDaily:100,otpLimitEnabled:!0,rateLimitEnabled:!0,rateLimitPerSecond:5,autoRecoverySeconds:60,keywordFilter:"",verificationCodeLimit:100,verificationCodeLimitEnabled:!0,latestEmailCount:null,autoRefreshEnabled:!1,autoRefreshInterval:30,cooldownEnabled:!0,cooldownSeconds:10,enableCaptcha:!1,announcementContent:"",shareToken:"",shareUrl:"",shareType:1,authorizedEmails:[],filterMode:1,templateId:"",showFullEmail:!0,shareDomain:""}),N=A(""),S=Ue({title:"",content:"",images:[],displayMode:"always"}),W=A(null),C={shareName:[{required:!0,message:"请输入分享名称",trigger:"blur"},{min:1,max:50,message:"分享名称长度在 1 到 50 个字符",trigger:"blur"}],otpLimitDaily:[{required:!0,message:"请输入每日限额",trigger:"blur"},{type:"number",min:1,max:1e4,message:"每日限额必须在 1 到 10000 之间",trigger:"blur"}],cooldownSeconds:[{type:"number",min:1,max:300,message:"冷却时间必须在 1-300 秒之间",trigger:"blur"}]};$e(()=>l.modelValue,u=>{d.value=u,u&&l.shareData&&O()}),$e(()=>l.shareData,u=>{d.value&&u&&O()},{deep:!0});const O=()=>{let u=[];if(l.shareData.authorizedEmails)try{const p=typeof l.shareData.authorizedEmails=="string"?JSON.parse(l.shareData.authorizedEmails):l.shareData.authorizedEmails;u=Array.isArray(p)?p:[]}catch{}Object.assign(h,{shareId:l.shareData.shareId,shareName:l.shareData.shareName||"",expireTime:l.shareData.expireTime||"",otpLimitDaily:l.shareData.otpLimitDaily||100,otpLimitEnabled:l.shareData.otpLimitEnabled!==void 0?l.shareData.otpLimitEnabled===1:!0,rateLimitEnabled:l.shareData.rateLimitPerSecond!==0,rateLimitPerSecond:l.shareData.rateLimitPerSecond||5,autoRecoverySeconds:l.shareData.autoRecoverySeconds||60,keywordFilter:l.shareData.keywordFilter||"",verificationCodeLimit:l.shareData.verificationCodeLimit||100,verificationCodeLimitEnabled:l.shareData.verificationCodeLimitEnabled!==void 0?l.shareData.verificationCodeLimitEnabled===1:!0,latestEmailCount:l.shareData.latestEmailCount||null,autoRefreshEnabled:l.shareData.autoRefreshEnabled===1,autoRefreshInterval:l.shareData.autoRefreshInterval||30,cooldownEnabled:l.shareData.cooldownEnabled!==void 0?l.shareData.cooldownEnabled===1:!0,cooldownSeconds:l.shareData.cooldownSeconds||10,enableCaptcha:l.shareData.enableCaptcha!==void 0?l.shareData.enableCaptcha===1:!1,announcementContent:l.shareData.announcementContent||"",shareToken:l.shareData.shareToken||"",shareUrl:l.shareData.shareUrl||"",shareType:l.shareData.shareType||1,authorizedEmails:u,filterMode:l.shareData.filterMode||1,templateId:l.shareData.templateId||"",showFullEmail:l.shareData.showFullEmail!==void 0?l.shareData.showFullEmail===1:!0,shareDomain:l.shareData.shareDomain||""}),N.value="",I(l.shareData.announcementContent)},I=u=>{if(S.title="",S.content="",S.images=[],!!u){try{if(typeof u=="string"&&u.startsWith("{")){const p=JSON.parse(u);if(p.type==="rich"){S.title=p.title||"",S.content=p.content||"",S.images=p.images||[],S.displayMode=p.displayMode||"always";return}}}catch{}S.content=u}},T=u=>{if(!u)return"";let p=u.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;");return p=p.replace(/\[bold\](.*?)\[\/bold\]/g,"<strong>$1</strong>"),p=p.replace(/\[large\](.*?)\[\/large\]/g,'<span style="font-size: 18px;">$1</span>'),p=p.replace(/\[xlarge\](.*?)\[\/xlarge\]/g,'<span style="font-size: 22px;">$1</span>'),p=p.replace(/\[red\](.*?)\[\/red\]/g,'<span style="color: #FF0000;">$1</span>'),p=p.replace(/\[green\](.*?)\[\/green\]/g,'<span style="color: #00AA00;">$1</span>'),p=p.replace(/\[blue\](.*?)\[\/blue\]/g,'<span style="color: #0066FF;">$1</span>'),p=p.replace(/\[yellow\](.*?)\[\/yellow\]/g,'<span style="color: #FFAA00;">$1</span>'),p=p.replace(/\[highlight\](.*?)\[\/highlight\]/g,'<mark style="background-color: #FFFF00; padding: 2px 4px;">$1</mark>'),p=p.replace(/\[link\](.*?)\[\/link\]/g,'<span class="announcement-link-wrapper"><a href="$1" target="_blank" style="color: #0066FF; text-decoration: underline; cursor: pointer;" class="announcement-link" data-url="$1">$1</a><span class="announcement-link-copy" data-url="$1" title="复制链接">📋</span></span>'),p=p.replace(/(?<!<a[^>]*>)(https?:\/\/[^\s<>"{}|\\^`\[\]]+|www\.[^\s<>"{}|\\^`\[\]]+)(?![^<]*<\/a>)/g,re=>{const ae=re.startsWith("www.")?"https://"+re:re;return`<span class="announcement-link-wrapper"><a href="${ae}" target="_blank" style="color: #0066FF; text-decoration: underline; cursor: pointer;" class="announcement-link" data-url="${ae}">${re}</a><span class="announcement-link-copy" data-url="${ae}" title="复制链接">📋</span></span>`}),p=p.replace(/\n/g,"<br>"),p},$=()=>{const u=prompt("请输入链接地址:");u&&(prompt("请输入链接文本:"),S.content+=`[link]${u}[/link]`)},y=u=>{const p=`[${u.tag}]文本[/${u.tag}]`;S.content+=p,De(()=>{g.value?.focus()})},q=()=>{const u="[bold]文本[/bold]";S.content+=u,De(()=>{g.value?.focus()})},Z=u=>{const p=`[${u}]文本[/${u}]`;S.content+=p,De(()=>{g.value?.focus()})},z=()=>{const u=prompt("请输入要高亮的文本:");u&&(S.content+=`[highlight]${u}[/highlight]`)},m=()=>{W.value?.click()},M=async u=>{const p=Array.from(u.target.files||[]);await se(p),u.target.value=""},R=async u=>{const p=u.clipboardData?.items;if(!p)return;const re=[];for(let ae=0;ae<p.length;ae++){const J=p[ae];if(J.type.startsWith("image/")){const ue=J.getAsFile();ue&&re.push(ue)}}re.length>0&&(u.preventDefault(),await se(re))},se=async u=>{if(S.images.length>=10){D.warning("最多只能上传10张图片");return}let p=S.images.reduce((re,ae)=>{const J=ae.base64.length*.75;return re+J},0);for(const re of u){if(!re.type.startsWith("image/")){const J=re.name||"image";D.warning(`${J} 不是图片文件`);continue}if(re.size>500*1024){const J=re.name||"image";D.warning(`${J} 超过500KB限制`);continue}if(p+=re.size,p>5*1024*1024){D.warning("图片总大小超过5MB限制");break}const ae=new FileReader;ae.onload=J=>{S.images.push({base64:J.target.result,caption:""})},ae.readAsDataURL(re)}},B=u=>{S.images.splice(u,1)},H=u=>{if(u>0){const p=S.images[u];S.images[u]=S.images[u-1],S.images[u-1]=p}},K=u=>{if(u<S.images.length-1){const p=S.images[u];S.images[u]=S.images[u+1],S.images[u+1]=p}},ge=u=>{const p=u.target;if(p.classList.contains("announcement-link")){u.preventDefault();const re=p.getAttribute("data-url");re&&navigator.clipboard.writeText(re).then(()=>{D.success("链接已复制到剪贴板")}).catch(()=>{D.error("复制失败，请手动复制")})}},ce=()=>!S.title&&!S.content&&S.images.length===0?null:JSON.stringify({type:"rich",title:S.title||"",content:S.content||"",images:S.images||[],displayMode:S.displayMode||"always"}),Y=()=>{d.value=!1},V=()=>{h.autoRefreshInterval<5&&(h.autoRefreshInterval=5),h.autoRefreshInterval>300&&(h.autoRefreshInterval=300)},xe=()=>{const u=N.value.trim();if(!u){D.warning("请输入邮箱地址");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)){D.warning("请输入有效的邮箱地址");return}if(h.authorizedEmails.includes(u)){D.warning("该邮箱已添加");return}h.authorizedEmails.push(u),N.value=""},ye=u=>{h.authorizedEmails.splice(u,1)},we=async()=>{f.value=!0;try{const u={shareName:h.shareName,expireTime:h.expireTime,otpLimitDaily:h.otpLimitDaily,otpLimitEnabled:h.otpLimitEnabled?1:0,rateLimitPerSecond:h.rateLimitEnabled?h.rateLimitPerSecond:0,autoRecoverySeconds:h.autoRecoverySeconds,keywordFilter:h.keywordFilter,verificationCodeLimit:h.verificationCodeLimit,verificationCodeLimitEnabled:h.verificationCodeLimitEnabled?1:0,latestEmailCount:h.latestEmailCount,autoRefreshEnabled:h.autoRefreshEnabled?1:0,autoRefreshInterval:h.autoRefreshInterval,cooldownEnabled:h.cooldownEnabled?1:0,cooldownSeconds:h.cooldownSeconds,enableCaptcha:h.enableCaptcha?1:0,announcementContent:ce(),shareType:h.shareType,filterMode:h.filterMode,templateId:h.templateId,showFullEmail:h.showFullEmail?1:0,shareDomain:h.shareDomain};h.shareType===2&&(u.authorizedEmails=h.authorizedEmails),await so(h.shareId,u),D.success("高级设置更新成功"),r("updated"),Y()}catch{D.error("更新失败，请重试")}finally{f.value=!1}},ne=async()=>{try{const u=await Bl(h.shareId);h.shareToken=u.shareToken,h.shareUrl=u.shareUrl,D.success("Token 已刷新")}catch{D.error("刷新失败，请重试")}},L=async()=>{if(!h.shareUrl){D.warning("分享链接为空，无法复制");return}try{await navigator.clipboard.writeText(h.shareUrl),D.success("分享链接已复制到剪贴板")}catch{try{const p=document.createElement("textarea");p.value=h.shareUrl,p.style.position="fixed",p.style.opacity="0",document.body.appendChild(p),p.select(),document.execCommand("copy"),document.body.removeChild(p),D.success("分享链接已复制到剪贴板")}catch{D.error("复制失败，请手动复制")}}};return $e(d,u=>{r("update:modelValue",u)}),(u,p)=>{const re=Dt,ae=At,J=ia,ue=il,_e=Sa,pe=gt,Ae=Bt,Se=qt,Me=jt,Ge=cl,Le=La,Oe=da,ve=Rt,et=Vn,Be=Zl,yt=Jl,bt=Kl,ht=Ro,rt=Xl,fe=Ql,$t=ra,It=xn,Ft=ft;return w(),le(Ft,{modelValue:d.value,"onUpdate:modelValue":p[27]||(p[27]=X=>d.value=X),title:"高级设置",width:"50%","max-height":"90vh","before-close":Y,class:"advanced-settings-dialog"},{footer:a(()=>[e(pe,{onClick:Y},{default:a(()=>[...p[60]||(p[60]=[_("取消",-1)])]),_:1}),e(pe,{type:"primary",onClick:we,loading:f.value},{default:a(()=>[...p[61]||(p[61]=[_("保存",-1)])]),_:1},8,["loading"])]),default:a(()=>[e(It,{modelValue:v.value,"onUpdate:modelValue":p[26]||(p[26]=X=>v.value=X),class:"settings-tabs"},{default:a(()=>[e(et,{label:"基础设置",name:"basic"},{default:a(()=>[s("div",Zu,[e(ve,{model:h,rules:C,"label-width":"140px",size:"default"},{default:a(()=>[s("div",Qu,[p[35]||(p[35]=s("h3",{class:"section-title"},"基础设置",-1)),e(ae,{label:"分享名称",prop:"shareName"},{default:a(()=>[e(re,{modelValue:h.shareName,"onUpdate:modelValue":p[0]||(p[0]=X=>h.shareName=X),placeholder:"请输入分享名称"},null,8,["modelValue"])]),_:1}),e(ae,{label:"过期时间"},{default:a(()=>[e(J,{modelValue:h.expireTime,"onUpdate:modelValue":p[1]||(p[1]=X=>h.expireTime=X),type:"datetime",placeholder:"选择过期时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss"},null,8,["modelValue"])]),_:1}),e(ae,{label:"分享类型"},{default:a(()=>[e(_e,{modelValue:h.shareType,"onUpdate:modelValue":p[2]||(p[2]=X=>h.shareType=X)},{default:a(()=>[e(ue,{label:1},{default:a(()=>[...p[28]||(p[28]=[_("单个邮箱",-1)])]),_:1}),e(ue,{label:2},{default:a(()=>[...p[29]||(p[29]=[_("邮箱验证",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),h.shareType===2?(w(),le(ae,{key:0,label:"授权邮箱"},{default:a(()=>[s("div",Xu,[s("div",em,[e(re,{modelValue:N.value,"onUpdate:modelValue":p[3]||(p[3]=X=>N.value=X),placeholder:"输入邮箱地址",onKeyup:ct(xe,["enter"])},null,8,["modelValue"]),e(pe,{type:"primary",onClick:xe},{default:a(()=>[...p[30]||(p[30]=[_("添加",-1)])]),_:1})]),h.authorizedEmails.length>0?(w(),P("div",tm,[(w(!0),P(Ee,null,Te(h.authorizedEmails,(X,Pe)=>(w(),le(Ae,{key:Pe,closable:"",onClose:dt=>ye(Pe)},{default:a(()=>[_(G(X),1)]),_:2},1032,["onClose"]))),128))])):(w(),P("div",am,"暂无授权邮箱"))])]),_:1})):ee("",!0),e(ae,{label:"分享域名"},{default:a(()=>[e(Me,{modelValue:h.shareDomain,"onUpdate:modelValue":p[4]||(p[4]=X=>h.shareDomain=X),placeholder:"选择分享域名"},{default:a(()=>[e(Se,{label:"使用默认域名",value:""}),(w(!0),P(Ee,null,Te(c.value,X=>(w(),le(Se,{key:X,label:X,value:X},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),p[31]||(p[31]=s("div",{class:"form-tip"},"选择此分享链接使用的域名",-1))]),_:1}),e(ae,{label:"分享链接"},{default:a(()=>[s("div",lm,[e(re,{modelValue:h.shareUrl,"onUpdate:modelValue":p[5]||(p[5]=X=>h.shareUrl=X),readonly:""},null,8,["modelValue"]),e(pe,{type:"primary",onClick:L},{default:a(()=>[...p[32]||(p[32]=[_("复制链接",-1)])]),_:1})])]),_:1}),e(ae,{label:"刷新 Token"},{default:a(()=>[e(pe,{type:"warning",onClick:ne},{default:a(()=>[...p[33]||(p[33]=[_("刷新 Token",-1)])]),_:1}),p[34]||(p[34]=s("div",{class:"form-tip"},"刷新后旧链接将失效，请谨慎操作",-1))]),_:1})]),e(Ge),s("div",nm,[p[40]||(p[40]=s("h3",{class:"section-title"},"访问控制",-1)),e(ae,{label:"每日访问限额"},{default:a(()=>[e(Le,{modelValue:h.otpLimitDaily,"onUpdate:modelValue":p[6]||(p[6]=X=>h.otpLimitDaily=X),min:1,max:1e4,placeholder:"请输入每日访问限额"},null,8,["modelValue"])]),_:1}),e(ae,{label:"启用每日限额"},{default:a(()=>[e(Oe,{modelValue:h.otpLimitEnabled,"onUpdate:modelValue":p[7]||(p[7]=X=>h.otpLimitEnabled=X)},null,8,["modelValue"])]),_:1}),e(Ge,{style:{margin:"10px 0"}}),e(ae,{label:"启用频率限制"},{default:a(()=>[e(Oe,{modelValue:h.rateLimitEnabled,"onUpdate:modelValue":p[8]||(p[8]=X=>h.rateLimitEnabled=X)},null,8,["modelValue"])]),_:1}),h.rateLimitEnabled?(w(),le(ae,{key:0,label:"每秒限制"},{default:a(()=>[e(Le,{modelValue:h.rateLimitPerSecond,"onUpdate:modelValue":p[9]||(p[9]=X=>h.rateLimitPerSecond=X),min:0,max:100,placeholder:"请输入每秒限制数"},null,8,["modelValue"]),p[36]||(p[36]=s("div",{class:"form-tip"},"0 表示禁用频率限制",-1))]),_:1})):ee("",!0),h.rateLimitEnabled?(w(),le(ae,{key:1,label:"自动恢复时间"},{default:a(()=>[e(Le,{modelValue:h.autoRecoverySeconds,"onUpdate:modelValue":p[10]||(p[10]=X=>h.autoRecoverySeconds=X),min:0,max:3600,placeholder:"请输入自动恢复时间（秒）"},null,8,["modelValue"]),p[37]||(p[37]=s("div",{class:"form-tip"},"0 表示禁用自动恢复",-1))]),_:1})):ee("",!0),e(Ge,{style:{margin:"10px 0"}}),e(ae,{label:"启用冷却"},{default:a(()=>[e(Oe,{modelValue:h.cooldownEnabled,"onUpdate:modelValue":p[11]||(p[11]=X=>h.cooldownEnabled=X)},null,8,["modelValue"]),p[38]||(p[38]=s("div",{class:"form-tip"},"启用后，用户访问后需要等待一段时间才能再次访问",-1))]),_:1}),h.cooldownEnabled?(w(),le(ae,{key:2,label:"冷却时间（秒）",prop:"cooldownSeconds"},{default:a(()=>[e(Le,{modelValue:h.cooldownSeconds,"onUpdate:modelValue":p[12]||(p[12]=X=>h.cooldownSeconds=X),min:1,max:300,placeholder:"请输入冷却时间"},null,8,["modelValue"])]),_:1})):ee("",!0),e(Ge,{style:{margin:"10px 0"}}),e(ae,{label:"启用人机验证"},{default:a(()=>[e(Oe,{modelValue:h.enableCaptcha,"onUpdate:modelValue":p[13]||(p[13]=X=>h.enableCaptcha=X)},null,8,["modelValue"]),p[39]||(p[39]=s("div",{class:"form-tip"},"启用后，用户需要完成人机验证才能访问",-1))]),_:1})]),e(Ge),s("div",om,[p[46]||(p[46]=s("h3",{class:"section-title"},"邮件显示",-1)),e(ae,{label:"过滤模式"},{default:a(()=>[e(_e,{modelValue:h.filterMode,"onUpdate:modelValue":p[14]||(p[14]=X=>h.filterMode=X)},{default:a(()=>[e(ue,{label:1},{default:a(()=>[...p[41]||(p[41]=[_("关键词过滤",-1)])]),_:1}),e(ue,{label:2},{default:a(()=>[...p[42]||(p[42]=[_("模板匹配",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),h.filterMode===1?(w(),le(ae,{key:0,label:"过滤关键词"},{default:a(()=>[e(re,{modelValue:h.keywordFilter,"onUpdate:modelValue":p[15]||(p[15]=X=>h.keywordFilter=X),type:"textarea",placeholder:"请输入过滤关键词，多个关键词用 | 分隔",rows:"3"},null,8,["modelValue"]),p[43]||(p[43]=s("div",{class:"form-tip"},"例如：验证码|verification|code|otp",-1))]),_:1})):ee("",!0),h.filterMode===2?(w(),le(ae,{key:1,label:"选择模板"},{default:a(()=>[e(Me,{modelValue:h.templateId,"onUpdate:modelValue":p[16]||(p[16]=X=>h.templateId=X),placeholder:"请选择模板"},{default:a(()=>[(w(!0),P(Ee,null,Te(x.value,X=>(w(),le(Se,{key:X.templateId,label:X.templateName,value:X.templateId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):ee("",!0),e(ae,{label:"显示完整邮件"},{default:a(()=>[e(Oe,{modelValue:h.showFullEmail,"onUpdate:modelValue":p[17]||(p[17]=X=>h.showFullEmail=X)},null,8,["modelValue"]),p[44]||(p[44]=s("div",{class:"form-tip"},"关闭时只显示提取的验证码",-1))]),_:1}),e(ae,{label:"验证码显示限制"},{default:a(()=>[e(Le,{modelValue:h.verificationCodeLimit,"onUpdate:modelValue":p[18]||(p[18]=X=>h.verificationCodeLimit=X),min:1,max:1e3,placeholder:"请输入显示数量限制"},null,8,["modelValue"])]),_:1}),e(ae,{label:"启用显示限制"},{default:a(()=>[e(Oe,{modelValue:h.verificationCodeLimitEnabled,"onUpdate:modelValue":p[19]||(p[19]=X=>h.verificationCodeLimitEnabled=X)},null,8,["modelValue"])]),_:1}),e(Ge,{style:{margin:"10px 0"}}),e(ae,{label:"最新邮件数"},{default:a(()=>[e(Le,{modelValue:h.latestEmailCount,"onUpdate:modelValue":p[20]||(p[20]=X=>h.latestEmailCount=X),min:1,max:1e3,placeholder:"不限制"},null,8,["modelValue"]),p[45]||(p[45]=s("div",{class:"form-tip"},"为空表示不限制，显示所有匹配的邮件",-1))]),_:1}),e(ae,{label:"启用自动刷新"},{default:a(()=>[e(Oe,{modelValue:h.autoRefreshEnabled,"onUpdate:modelValue":p[21]||(p[21]=X=>h.autoRefreshEnabled=X)},null,8,["modelValue"])]),_:1}),h.autoRefreshEnabled?(w(),le(ae,{key:2,label:"刷新间隔（秒）"},{default:a(()=>[e(Le,{modelValue:h.autoRefreshInterval,"onUpdate:modelValue":p[22]||(p[22]=X=>h.autoRefreshInterval=X),min:5,max:300,onChange:V},null,8,["modelValue"])]),_:1})):ee("",!0)])]),_:1},8,["model"])])]),_:1}),e(et,{label:"公告设置",name:"announcement"},{default:a(()=>[s("div",sm,[s("div",im,[s("div",rm,[e(ve,{model:S,"label-width":"120px",size:"default"},{default:a(()=>[e(ae,{label:"展示次数"},{default:a(()=>[e(_e,{modelValue:S.displayMode,"onUpdate:modelValue":p[23]||(p[23]=X=>S.displayMode=X)},{default:a(()=>[e(ue,{label:"always"},{default:a(()=>[...p[47]||(p[47]=[_("每次访问都显示",-1)])]),_:1}),e(ue,{label:"once"},{default:a(()=>[...p[48]||(p[48]=[_("仅显示一次",-1)])]),_:1})]),_:1},8,["modelValue"]),p[49]||(p[49]=s("div",{class:"form-tip"},'选择"仅显示一次"时，用户关闭公告后不会再看到',-1))]),_:1}),e(ae,{label:"公告标题"},{default:a(()=>[e(re,{modelValue:S.title,"onUpdate:modelValue":p[24]||(p[24]=X=>S.title=X),placeholder:"请输入公告标题（可选）",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),e(ae,{label:"公告内容"},{default:a(()=>[s("div",dm,[s("div",um,[e(ht,null,{default:a(()=>[e(pe,{size:"small",onClick:$},{default:a(()=>[e(k(oe),{icon:"material-symbols:link"}),p[50]||(p[50]=_(" 插入链接 ",-1))]),_:1}),e(bt,{onCommand:y,trigger:"click"},{dropdown:a(()=>[e(yt,null,{default:a(()=>[(w(),P(Ee,null,Te(E,X=>e(Be,{key:X.value,command:X},{default:a(()=>[s("span",{class:"color-swatch",style:Je({backgroundColor:X.value})},null,4),_(" "+G(X.label),1)]),_:2},1032,["command"])),64))]),_:1})]),default:a(()=>[e(pe,{size:"small"},{default:a(()=>[e(k(oe),{icon:"material-symbols:palette"}),p[51]||(p[51]=_(" 颜色 ",-1))]),_:1})]),_:1}),e(pe,{size:"small",onClick:q},{default:a(()=>[e(k(oe),{icon:"material-symbols:format-bold"}),p[52]||(p[52]=_(" 加粗 ",-1))]),_:1}),e(bt,{onCommand:Z,trigger:"click"},{dropdown:a(()=>[e(yt,null,{default:a(()=>[e(Be,{command:"large"},{default:a(()=>[...p[54]||(p[54]=[s("span",{class:"size-preview",style:{"font-size":"18px"}},"大",-1)])]),_:1}),e(Be,{command:"xlarge"},{default:a(()=>[...p[55]||(p[55]=[s("span",{class:"size-preview",style:{"font-size":"22px"}},"特大",-1)])]),_:1})]),_:1})]),default:a(()=>[e(pe,{size:"small"},{default:a(()=>[e(k(oe),{icon:"material-symbols:text-fields"}),p[53]||(p[53]=_(" 大小 ",-1))]),_:1})]),_:1}),e(pe,{size:"small",onClick:z},{default:a(()=>[e(k(oe),{icon:"material-symbols:highlight"}),p[56]||(p[56]=_(" 高亮 ",-1))]),_:1})]),_:1})]),e(re,{ref_key:"contentInput",ref:g,modelValue:S.content,"onUpdate:modelValue":p[25]||(p[25]=X=>S.content=X),type:"textarea",placeholder:"请输入公告内容（支持 [link]URL[/link]、[red]文本[/red] 等标记）",rows:"15",maxlength:"1000","show-word-limit":"",onPaste:R,class:"announcement-content-input"},null,8,["modelValue"])])]),_:1}),e(ae,{label:"图片"},{default:a(()=>[s("div",mm,[e(pe,{onClick:m},{default:a(()=>[e(k(oe),{icon:"material-symbols:image-add"}),p[57]||(p[57]=_(" 上传图片 ",-1))]),_:1}),s("input",{ref_key:"fileInput",ref:W,type:"file",multiple:"",accept:"image/*",style:{display:"none"},onChange:M},null,544),p[58]||(p[58]=s("div",{class:"form-tip"},"支持 PNG、JPG 格式，单张不超过 500KB，总大小不超过 5MB，最多 10 张",-1))]),S.images.length>0?(w(),P("div",cm,[(w(!0),P(Ee,null,Te(S.images,(X,Pe)=>(w(),P("div",{key:Pe,class:"image-item"},[s("img",{src:X.base64,alt:`Image ${Pe+1}`,class:"image-thumbnail"},null,8,pm),s("div",fm,[Pe>0?(w(),le(pe,{key:0,size:"small",type:"primary",text:"",onClick:dt=>H(Pe)},{default:a(()=>[e(k(oe),{icon:"material-symbols:arrow-upward"})]),_:2},1032,["onClick"])):ee("",!0),Pe<S.images.length-1?(w(),le(pe,{key:1,size:"small",type:"primary",text:"",onClick:dt=>K(Pe)},{default:a(()=>[e(k(oe),{icon:"material-symbols:arrow-downward"})]),_:2},1032,["onClick"])):ee("",!0),e(pe,{size:"small",type:"danger",text:"",onClick:dt=>B(Pe)},{default:a(()=>[e(k(oe),{icon:"material-symbols:delete"})]),_:2},1032,["onClick"])])]))),128))])):ee("",!0)]),_:1})]),_:1},8,["model"])]),s("div",vm,[p[59]||(p[59]=s("div",{class:"preview-header"},[s("h3",null,"公告预览")],-1)),s("div",gm,[S.title?(w(),P("div",ym,G(S.title),1)):ee("",!0),S.images&&S.images.length>0?(w(),P("div",bm,[e(fe,{autoplay:!1},{default:a(()=>[(w(!0),P(Ee,null,Te(S.images,(X,Pe)=>(w(),le(rt,{key:Pe},{default:a(()=>[s("img",{src:X.base64,alt:`Image ${Pe+1}`,class:"carousel-image"},null,8,hm)]),_:2},1024))),128))]),_:1})])):ee("",!0),S.content?(w(),P("div",{key:2,class:"preview-content",onClick:ge},[s("div",{innerHTML:T(S.content)},null,8,wm)])):ee("",!0),!S.title&&!S.content&&(!S.images||S.images.length===0)?(w(),P("div",_m,[e($t,{description:"暂无公告内容"})])):ee("",!0)])])])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}},$n=vt(Em,[["__scopeId","data-v-1b947660"]]),xm={class:"batch-info"},Vm={class:"limit-control"},Cm={class:"limit-control"},$m={class:"limit-control"},km={class:"limit-control"},Sm={class:"limit-control"},Lm={class:"limit-control"},Tm={class:"announcement-editor"},Dm={class:"announcement-section"},Rm={class:"announcement-section"},Am={class:"announcement-section"},Im={class:"upload-content"},Fm={class:"upload-text"},Um={key:1,class:"images-list"},Pm={class:"image-preview"},Nm=["src","alt"],Mm={class:"image-info"},zm={class:"image-actions"},Om={class:"dialog-footer"},Bm={__name:"ShareBatchAdvancedDialog",props:{modelValue:{type:Boolean,default:!1},selectedShares:{type:Array,default:()=>[]}},emits:["update:modelValue","updated"],setup(i,{emit:t}){const l=i,r=t,d=A(!1),f=A(!1),v=A(),g=ie(()=>l.selectedShares.length),c=Ue({shareName:!1,expireTime:!1,rateLimit:!1,emailCount:!1,autoRefresh:!1,keywordFilter:!1,verificationCodeLimit:!1,otpLimit:!1,cooldown:!1,captcha:!1,filterMode:!1,template:!1,showFullEmail:!1,shareDomain:!1,announcement:!1}),x=Ue({title:"",content:"",images:[]}),E=Ue({shareName:"",expireTime:"",rateLimitPerSecond:5,autoRecoverySeconds:60,latestEmailCount:null,autoRefreshEnabled:!1,autoRefreshInterval:30,keywordFilter:"",verificationCodeLimit:100,verificationCodeLimitEnabled:!0,otpLimitDaily:100,otpLimitEnabled:!0,cooldownEnabled:!0,cooldownSeconds:10,enableCaptcha:!1,filterMode:1,templateId:"",showFullEmail:!0,shareDomain:""}),h={rateLimitPerSecond:[{type:"number",min:1,max:100,message:"每秒限制必须在 1-100 之间",trigger:"blur"}],autoRecoverySeconds:[{type:"number",min:0,max:3600,message:"自动恢复时间必须在 0-3600 秒之间",trigger:"blur"}],latestEmailCount:[{type:"number",min:1,max:100,message:"邮件数量必须在 1-100 之间",trigger:"blur"}]};$e(()=>l.modelValue,z=>{d.value=z}),$e(d,z=>{r("update:modelValue",z)});const N=()=>{d.value=!1,De(()=>{v.value?.resetFields(),Object.keys(c).forEach(z=>{c[z]=!1}),x.title="",x.content="",x.images=[]})},S=()=>{if(!x.title&&!x.content&&x.images.length===0)return null;if(!x.title&&x.images.length===0&&x.content)return x.content;const z={type:"rich",title:x.title||"",content:x.content||"",images:x.images||[]};return JSON.stringify(z)},W=async z=>{const m=Array.from(z.target.files);await O(m),z.target.value=""},C=async z=>{const m=Array.from(z.dataTransfer.files);await O(m)},O=async z=>{const m=z.filter(M=>M.type.startsWith("image/"));if(m.length===0){D.warning("请选择图片文件");return}if(x.images.length+m.length>10){D.error("公告图片最多10张，当前已有 "+x.images.length+" 张");return}for(const M of m){if(M.size>500*1024){D.error(`图片 ${M.name} 超过500KB限制`);continue}try{const R=await I(M);x.images.push({base64:R,caption:""})}catch(R){D.error(`处理图片 ${M.name} 失败: ${R.message}`)}}},I=z=>new Promise((m,M)=>{const R=new FileReader;R.onload=()=>m(R.result),R.onerror=M,R.readAsDataURL(z)}),T=async z=>{const m=z.clipboardData?.items;if(!m)return;const M=[];for(let R=0;R<m.length;R++){const se=m[R];if(se.type.startsWith("image/")){const B=se.getAsFile();B&&M.push(B)}}M.length>0&&(z.preventDefault(),await O(M))},$=z=>{x.images.splice(z,1)},y=z=>{if(z>0){const m=x.images[z];x.images[z]=x.images[z-1],x.images[z-1]=m}},q=z=>{if(z<x.images.length-1){const m=x.images[z];x.images[z]=x.images[z+1],x.images[z+1]=m}},Z=async()=>{try{if(!Object.values(c).some(K=>K)){D.warning("请至少选择一个要修改的设置项");return}await v.value.validate();const m=[];c.shareName&&m.push("分享名称"),c.expireTime&&m.push("过期时间"),c.rateLimit&&m.push("频率限制"),c.emailCount&&m.push("邮件数量限制"),c.autoRefresh&&m.push("自动刷新"),c.keywordFilter&&m.push("关键词过滤"),c.verificationCodeLimit&&m.push("显示数量限制"),c.otpLimit&&m.push("访问次数限制"),c.cooldown&&m.push("获取验证码冷却"),c.captcha&&m.push("人机验证"),c.filterMode&&m.push("过滤模式"),c.template&&m.push("邮件模板"),c.showFullEmail&&m.push("显示完整邮件"),c.shareDomain&&m.push("分享域名"),c.announcement&&m.push("公告内容");const M=`
      <div style="text-align: left;">
        <p><strong>将对 ${g.value} 个分享链接批量修改以下设置：</strong></p>
        <ul style="margin: 10px 0; padding-left: 20px;">
          ${m.map(K=>`<li>${K}</li>`).join("")}
        </ul>
        <p style="color: #e6a23c; font-size: 13px;">⚠️ 此操作不可撤销，请确认后继续</p>
      </div>
    `;await Xe.confirm(M,"确认批量修改高级设置",{type:"warning",dangerouslyUseHTMLString:!0,confirmButtonText:`修改 ${g.value} 个分享`,cancelButtonText:"取消操作"}),f.value=!0;const R={};c.shareName&&(R.shareName=E.shareName),c.expireTime&&(R.expireTime=E.expireTime),c.rateLimit&&(R.rateLimitPerSecond=E.rateLimitPerSecond,R.autoRecoverySeconds=E.autoRecoverySeconds),c.emailCount&&(R.latestEmailCount=E.latestEmailCount),c.autoRefresh&&(R.autoRefreshEnabled=E.autoRefreshEnabled?1:0,R.autoRefreshInterval=E.autoRefreshInterval),c.keywordFilter&&(R.keywordFilter=E.keywordFilter),c.verificationCodeLimit&&(R.verificationCodeLimit=E.verificationCodeLimit,R.verificationCodeLimitEnabled=E.verificationCodeLimitEnabled?1:0),c.otpLimit&&(R.otpLimitDaily=E.otpLimitDaily,R.otpLimitEnabled=E.otpLimitEnabled?1:0),c.cooldown&&(R.cooldownEnabled=E.cooldownEnabled?1:0,R.cooldownSeconds=E.cooldownSeconds),c.captcha&&(R.enableCaptcha=E.enableCaptcha?1:0),c.filterMode&&(R.filterMode=E.filterMode),c.template&&(R.templateId=E.templateId||null),c.showFullEmail&&(R.showFullEmail=E.showFullEmail?1:0),c.shareDomain&&(R.shareDomain=E.shareDomain||null),c.announcement&&(R.announcementContent=S());const se=l.selectedShares.map(K=>K.shareId),H=(await St("updateAdvancedSettings",se,{settings:R}))?.affected||0;D.success(`成功修改 ${H} 个分享的高级设置`),r("updated"),N()}catch(z){z!=="cancel"&&(console.error("Batch update advanced settings error:",z),D.error("批量修改高级设置失败"))}finally{f.value=!1}};return(z,m)=>{const M=rl,R=ka,se=Dt,B=At,H=ia,K=La,ge=da,ce=qt,Y=jt,V=il,xe=Sa,ye=Tt,we=gt,ne=Rt,L=ft;return w(),le(L,{modelValue:d.value,"onUpdate:modelValue":m[38]||(m[38]=u=>d.value=u),title:"批量修改高级设置",width:"700px","before-close":N},{footer:a(()=>[s("div",Om,[e(we,{onClick:N},{default:a(()=>[...m[84]||(m[84]=[_("取消",-1)])]),_:1}),e(we,{type:"primary",onClick:Z,loading:f.value},{default:a(()=>[...m[85]||(m[85]=[_(" 批量应用设置 ",-1)])]),_:1},8,["loading"])])]),default:a(()=>[s("div",xm,[e(M,{title:`将对 ${g.value} 个分享链接应用以下设置`,type:"info",closable:!1,"show-icon":""},null,8,["title"])]),e(ne,{ref_key:"formRef",ref:v,model:E,rules:h,"label-width":"140px","label-position":"left",style:{"margin-top":"20px"}},{default:a(()=>[e(B,null,{label:a(()=>[e(R,{modelValue:c.shareName,"onUpdate:modelValue":m[0]||(m[0]=u=>c.shareName=u)},{default:a(()=>[...m[39]||(m[39]=[_("分享名称",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.shareName}])},[e(se,{modelValue:E.shareName,"onUpdate:modelValue":m[1]||(m[1]=u=>E.shareName=u),placeholder:"请输入分享名称",disabled:!c.shareName,maxlength:"50","show-word-limit":""},null,8,["modelValue","disabled"]),m[40]||(m[40]=s("div",{class:"form-tip"},"修改所有选中分享的名称",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.expireTime,"onUpdate:modelValue":m[2]||(m[2]=u=>c.expireTime=u)},{default:a(()=>[...m[41]||(m[41]=[_("过期时间",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.expireTime}])},[e(H,{modelValue:E.expireTime,"onUpdate:modelValue":m[3]||(m[3]=u=>E.expireTime=u),type:"datetime",placeholder:"选择过期时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",disabled:!c.expireTime,style:{width:"100%"}},null,8,["modelValue","disabled"]),m[42]||(m[42]=s("div",{class:"form-tip"},"设置所有选中分享的过期时间",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.rateLimit,"onUpdate:modelValue":m[4]||(m[4]=u=>c.rateLimit=u)},{default:a(()=>[...m[43]||(m[43]=[_("频率限制",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.rateLimit}])},[s("div",Vm,[e(K,{modelValue:E.rateLimitPerSecond,"onUpdate:modelValue":m[5]||(m[5]=u=>E.rateLimitPerSecond=u),min:1,max:100,step:1,disabled:!c.rateLimit,style:{width:"120px"}},null,8,["modelValue","disabled"]),m[44]||(m[44]=s("span",{class:"unit-text"},"次/秒",-1)),e(K,{modelValue:E.autoRecoverySeconds,"onUpdate:modelValue":m[6]||(m[6]=u=>E.autoRecoverySeconds=u),min:0,max:3600,step:1,disabled:!c.rateLimit,style:{width:"120px","margin-left":"12px"}},null,8,["modelValue","disabled"]),m[45]||(m[45]=s("span",{class:"unit-text"},"秒（恢复时间）",-1))]),m[46]||(m[46]=s("div",{class:"form-tip"},"控制访问者的请求频率限制和自动恢复时间",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.emailCount,"onUpdate:modelValue":m[7]||(m[7]=u=>c.emailCount=u)},{default:a(()=>[...m[47]||(m[47]=[_("邮件数量限制",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.emailCount}])},[s("div",Cm,[e(K,{modelValue:E.latestEmailCount,"onUpdate:modelValue":m[8]||(m[8]=u=>E.latestEmailCount=u),min:1,max:100,step:1,disabled:!c.emailCount,placeholder:"留空显示全部",style:{width:"200px"},clearable:""},null,8,["modelValue","disabled"]),m[48]||(m[48]=s("span",{class:"unit-text"},"封",-1))]),m[49]||(m[49]=s("div",{class:"form-tip"}," 控制分享链接最多显示多少封最新邮件。留空表示显示全部邮件。 ",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.autoRefresh,"onUpdate:modelValue":m[9]||(m[9]=u=>c.autoRefresh=u)},{default:a(()=>[...m[50]||(m[50]=[_("自动刷新",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.autoRefresh}])},[s("div",$m,[e(ge,{modelValue:E.autoRefreshEnabled,"onUpdate:modelValue":m[10]||(m[10]=u=>E.autoRefreshEnabled=u),"active-text":"启用","inactive-text":"禁用",disabled:!c.autoRefresh},null,8,["modelValue","disabled"]),e(Y,{modelValue:E.autoRefreshInterval,"onUpdate:modelValue":m[11]||(m[11]=u=>E.autoRefreshInterval=u),disabled:!c.autoRefresh||!E.autoRefreshEnabled,style:{width:"120px","margin-left":"12px"}},{default:a(()=>[e(ce,{label:"30秒",value:30}),e(ce,{label:"60秒",value:60}),e(ce,{label:"120秒",value:120}),e(ce,{label:"300秒",value:300})]),_:1},8,["modelValue","disabled"]),m[51]||(m[51]=s("span",{class:"unit-text"},"间隔",-1))]),m[52]||(m[52]=s("div",{class:"form-tip"}," 启用后，访问者的页面会自动刷新获取最新邮件。建议间隔不少于30秒。 ",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.keywordFilter,"onUpdate:modelValue":m[12]||(m[12]=u=>c.keywordFilter=u)},{default:a(()=>[...m[53]||(m[53]=[_("关键词过滤",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.keywordFilter}])},[e(se,{modelValue:E.keywordFilter,"onUpdate:modelValue":m[13]||(m[13]=u=>E.keywordFilter=u),type:"textarea",rows:3,placeholder:"输入关键词，用逗号分隔，如：验证码,code,otp",maxlength:"500","show-word-limit":"",disabled:!c.keywordFilter},null,8,["modelValue","disabled"]),m[54]||(m[54]=s("div",{class:"form-tip"},"只显示包含这些关键词的邮件，留空表示显示所有邮件",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.verificationCodeLimit,"onUpdate:modelValue":m[14]||(m[14]=u=>c.verificationCodeLimit=u)},{default:a(()=>[...m[55]||(m[55]=[_("显示数量限制",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.verificationCodeLimit}])},[s("div",km,[e(ge,{modelValue:E.verificationCodeLimitEnabled,"onUpdate:modelValue":m[15]||(m[15]=u=>E.verificationCodeLimitEnabled=u),"active-text":"启用","inactive-text":"禁用",disabled:!c.verificationCodeLimit},null,8,["modelValue","disabled"]),e(K,{modelValue:E.verificationCodeLimit,"onUpdate:modelValue":m[16]||(m[16]=u=>E.verificationCodeLimit=u),min:1,max:1e3,step:10,disabled:!c.verificationCodeLimit||!E.verificationCodeLimitEnabled,style:{width:"150px","margin-left":"12px"}},null,8,["modelValue","disabled"]),m[56]||(m[56]=s("span",{class:"unit-text"},"封",-1))]),m[57]||(m[57]=s("div",{class:"form-tip"},"控制每次访问最多显示的验证码数量",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.otpLimit,"onUpdate:modelValue":m[17]||(m[17]=u=>c.otpLimit=u)},{default:a(()=>[...m[58]||(m[58]=[_("访问次数限制",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.otpLimit}])},[s("div",Sm,[e(ge,{modelValue:E.otpLimitEnabled,"onUpdate:modelValue":m[18]||(m[18]=u=>E.otpLimitEnabled=u),"active-text":"启用","inactive-text":"禁用",disabled:!c.otpLimit},null,8,["modelValue","disabled"]),e(K,{modelValue:E.otpLimitDaily,"onUpdate:modelValue":m[19]||(m[19]=u=>E.otpLimitDaily=u),min:1,max:1e4,step:10,disabled:!c.otpLimit||!E.otpLimitEnabled,style:{width:"150px","margin-left":"12px"}},null,8,["modelValue","disabled"]),m[59]||(m[59]=s("span",{class:"unit-text"},"次/天",-1))]),m[60]||(m[60]=s("div",{class:"form-tip"},"控制每天最多可以访问的次数",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.cooldown,"onUpdate:modelValue":m[20]||(m[20]=u=>c.cooldown=u)},{default:a(()=>[...m[61]||(m[61]=[_("获取验证码冷却",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.cooldown}])},[s("div",Lm,[e(ge,{modelValue:E.cooldownEnabled,"onUpdate:modelValue":m[21]||(m[21]=u=>E.cooldownEnabled=u),"active-text":"启用","inactive-text":"禁用",disabled:!c.cooldown},null,8,["modelValue","disabled"]),e(K,{modelValue:E.cooldownSeconds,"onUpdate:modelValue":m[22]||(m[22]=u=>E.cooldownSeconds=u),min:1,max:300,step:1,disabled:!c.cooldown||!E.cooldownEnabled,style:{width:"120px","margin-left":"12px"}},null,8,["modelValue","disabled"]),m[62]||(m[62]=s("span",{class:"unit-text"},"秒",-1))]),m[63]||(m[63]=s("div",{class:"form-tip"},'控制点击"获取最新验证码"按钮后的冷却时间',-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.captcha,"onUpdate:modelValue":m[23]||(m[23]=u=>c.captcha=u)},{default:a(()=>[...m[64]||(m[64]=[_("人机验证",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.captcha}])},[e(ge,{modelValue:E.enableCaptcha,"onUpdate:modelValue":m[24]||(m[24]=u=>E.enableCaptcha=u),"active-text":"启用","inactive-text":"禁用",disabled:!c.captcha},null,8,["modelValue","disabled"]),m[65]||(m[65]=s("div",{class:"form-tip"},"启用后触发频率限制时需要进行人机验证",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.filterMode,"onUpdate:modelValue":m[25]||(m[25]=u=>c.filterMode=u)},{default:a(()=>[...m[66]||(m[66]=[_("过滤模式",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.filterMode}])},[e(xe,{modelValue:E.filterMode,"onUpdate:modelValue":m[26]||(m[26]=u=>E.filterMode=u),disabled:!c.filterMode},{default:a(()=>[e(V,{label:1},{default:a(()=>[...m[67]||(m[67]=[_("关键词过滤",-1)])]),_:1}),e(V,{label:2},{default:a(()=>[...m[68]||(m[68]=[_("模板匹配",-1)])]),_:1})]),_:1},8,["modelValue","disabled"]),m[69]||(m[69]=s("div",{class:"form-tip"},"选择邮件过滤方式",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.template,"onUpdate:modelValue":m[27]||(m[27]=u=>c.template=u)},{default:a(()=>[...m[70]||(m[70]=[_("邮件模板",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.template}])},[e(Y,{modelValue:E.templateId,"onUpdate:modelValue":m[28]||(m[28]=u=>E.templateId=u),placeholder:"选择邮件模板",disabled:!c.template,clearable:"",style:{width:"100%"}},{default:a(()=>[e(ce,{label:"模板1",value:"template1"}),e(ce,{label:"模板2",value:"template2"}),e(ce,{label:"模板3",value:"template3"})]),_:1},8,["modelValue","disabled"]),m[71]||(m[71]=s("div",{class:"form-tip"},"选择邮件显示模板",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.showFullEmail,"onUpdate:modelValue":m[29]||(m[29]=u=>c.showFullEmail=u)},{default:a(()=>[...m[72]||(m[72]=[_("显示完整邮件",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.showFullEmail}])},[e(ge,{modelValue:E.showFullEmail,"onUpdate:modelValue":m[30]||(m[30]=u=>E.showFullEmail=u),"active-text":"启用","inactive-text":"禁用",disabled:!c.showFullEmail},null,8,["modelValue","disabled"]),m[73]||(m[73]=s("div",{class:"form-tip"},"启用后显示邮件的完整内容",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.shareDomain,"onUpdate:modelValue":m[31]||(m[31]=u=>c.shareDomain=u)},{default:a(()=>[...m[74]||(m[74]=[_("分享域名",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.shareDomain}])},[e(Y,{modelValue:E.shareDomain,"onUpdate:modelValue":m[32]||(m[32]=u=>E.shareDomain=u),placeholder:"选择分享域名",disabled:!c.shareDomain,clearable:"",style:{width:"100%"}},{default:a(()=>[e(ce,{label:"example.com",value:"example.com"}),e(ce,{label:"example2.com",value:"example2.com"}),e(ce,{label:"example3.com",value:"example3.com"})]),_:1},8,["modelValue","disabled"]),m[75]||(m[75]=s("div",{class:"form-tip"},"选择分享链接使用的域名",-1))],2)]),_:1}),e(B,null,{label:a(()=>[e(R,{modelValue:c.announcement,"onUpdate:modelValue":m[33]||(m[33]=u=>c.announcement=u)},{default:a(()=>[...m[76]||(m[76]=[_("公告内容",-1)])]),_:1},8,["modelValue"])]),default:a(()=>[s("div",{class:me(["setting-group",{disabled:!c.announcement}])},[s("div",Tm,[s("div",Dm,[m[77]||(m[77]=s("label",{class:"section-label"},"公告标题（可选）",-1)),e(se,{modelValue:x.title,"onUpdate:modelValue":m[34]||(m[34]=u=>x.title=u),placeholder:"输入公告标题",maxlength:"100","show-word-limit":"",disabled:!c.announcement},null,8,["modelValue","disabled"])]),s("div",Rm,[m[78]||(m[78]=s("label",{class:"section-label"},"公告文本（支持粘贴图片）",-1)),e(se,{modelValue:x.content,"onUpdate:modelValue":m[35]||(m[35]=u=>x.content=u),type:"textarea",placeholder:"输入公告内容（可选）或粘贴图片",maxlength:"5000","show-word-limit":"",rows:3,disabled:!c.announcement,onPaste:T},null,8,["modelValue","disabled"])]),s("div",Am,[m[82]||(m[82]=s("label",{class:"section-label"},"公告图片（可选，最多10张）",-1)),c.announcement?(w(),P("div",{key:0,class:"upload-area",onDragover:m[37]||(m[37]=st(()=>{},["prevent"])),onDrop:st(C,["prevent"])},[s("div",Im,[e(ye,{class:"upload-icon"},{default:a(()=>[e(k(Ml))]),_:1}),s("div",Fm,[m[80]||(m[80]=s("div",null,"拖拽图片到此处或",-1)),e(we,{link:"",type:"primary",onClick:m[36]||(m[36]=u=>z.$refs.fileInput.click())},{default:a(()=>[...m[79]||(m[79]=[_(" 点击选择文件 ",-1)])]),_:1})]),m[81]||(m[81]=s("div",{class:"upload-hint"},"支持 PNG、JPG、GIF、WebP 格式，单张≤500KB，总大小≤5MB",-1))]),s("input",{ref:"fileInput",type:"file",multiple:"",accept:"image/*",style:{display:"none"},onChange:W},null,544)],32)):ee("",!0),x.images&&x.images.length>0?(w(),P("div",Um,[(w(!0),P(Ee,null,Te(x.images,(u,p)=>(w(),P("div",{key:p,class:"image-item"},[s("div",Pm,[s("img",{src:u.base64,alt:`Image ${p+1}`},null,8,Nm)]),s("div",Mm,[e(se,{modelValue:u.caption,"onUpdate:modelValue":re=>u.caption=re,placeholder:"图片说明（可选）",maxlength:"100","show-word-limit":"",disabled:!c.announcement},null,8,["modelValue","onUpdate:modelValue","disabled"])]),s("div",zm,[p>0?(w(),le(we,{key:0,link:"",type:"primary",onClick:re=>y(p),title:"向上移动",disabled:!c.announcement},{default:a(()=>[e(ye,null,{default:a(()=>[e(k(zl))]),_:1})]),_:2},1032,["onClick","disabled"])):ee("",!0),p<x.images.length-1?(w(),le(we,{key:1,link:"",type:"primary",onClick:re=>q(p),title:"向下移动",disabled:!c.announcement},{default:a(()=>[e(ye,null,{default:a(()=>[e(k(Ol))]),_:1})]),_:2},1032,["onClick","disabled"])):ee("",!0),e(we,{link:"",type:"danger",onClick:re=>$(p),title:"删除",disabled:!c.announcement},{default:a(()=>[e(ye,null,{default:a(()=>[e(k(ll))]),_:1})]),_:2},1032,["onClick","disabled"])])]))),128))])):ee("",!0),m[83]||(m[83]=s("div",{class:"form-tip"}," 支持拖拽上传、点击选择或粘贴图片。图片会自动压缩。 ",-1))])])],2)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])}}},jm=vt(Bm,[["__scopeId","data-v-f5db87ea"]]),qm={class:"access-logs-container"},Ym={class:"filter-section"},Wm={class:"anomaly-details"},Hm={key:0},Gm={key:1},Km={key:2},Jm={key:1,class:"stats-section"},Zm={class:"logs-table"},Qm={class:"time-cell"},Xm={key:0,class:"error-message"},ec={key:1},tc={class:"pagination-wrapper"},ac={class:"access-detail-content"},lc={key:0,class:"access-info"},nc={key:1,class:"emails-section"},oc={key:0,class:"email-scroll-container"},sc={key:1,class:"no-emails"},ic=Object.assign({name:"ShareAccessLogs"},{__name:"ShareAccessLogs",setup(i){const t=al(),l=nn(),r=A(null),d=A(null),f=A(0),v=A(!1),g=A([]),c=A([]),x=A(null);A(null);const E=A(!1),h=A(null),N=A(null),S=A(!1),W=A(null),C=A(!1),O=A(null),I=ie(()=>l.splitLayout?.showDetailPane||!1),T=ie(()=>{if(!x.value?.anomalyStats)return!1;const{highFreqIpCount:L,highFreqShareCount:u,abnormalFailIpCount:p}=x.value.anomalyStats;return L+u+p>0}),$=Ue({shareId:"",accessResult:"",accessEmail:"",dateRange:null}),y=Ue({page:1,pageSize:20,total:0});$e(()=>g.value,async L=>{L&&L.length>0&&(await De(),$.shareId!==""&&(L.some(p=>p.shareId===$.shareId)||($.shareId="")))},{immediate:!0}),Ot(()=>{z(),m()});let q=null;const Z=L=>{q&&clearTimeout(q);const u=L==null||L===""?"":L;q=setTimeout(async()=>{try{u?await M(u):await R(),await m(),await De()}catch(p){console.error("Handle share change error:",p),D.error("切换分享记录失败")}},300)},z=async()=>{try{const L=await Wa({page:1,pageSize:20});g.value=L.data?.list||L.list||[],await De(),$.shareId===void 0&&($.shareId=""),f.value+=1,await De(),t&&t.proxy&&t.proxy.$forceUpdate(),g.value.length>0&&await R()}catch(L){console.error("Load share list error:",L),D.error("加载分享列表失败")}},m=async()=>{v.value=!0;try{const L={page:y.page,pageSize:y.pageSize,...$};$.dateRange&&$.dateRange.length===2&&(L.startDate=$.dateRange[0],L.endDate=$.dateRange[1]),delete L.dateRange,L.shareId?console.log("调用特定分享记录API获取访问日志，shareId:",L.shareId,"参数:",L):(delete L.shareId,console.log("调用全局统计API获取访问日志，参数:",L));const u=await jl(L);console.log("getShareLogs API响应:",u);const p=u.data||u;console.log("处理后的数据:",p),c.value=p.list||[],y.total=p.total||0,console.log("设置访问日志数据:",c.value.length,"条记录，总数:",y.total)}catch(L){console.error("Load access logs error:",L),D.error("加载访问日志失败")}finally{v.value=!1}},M=async L=>{try{const u=await ro(L,{days:7});u&&u.data?x.value=u.data:u?x.value=u:x.value=null}catch(u){console.error("Load share stats error:",u),x.value=null}},R=async()=>{v.value=!0;try{const L=await io({days:7}),u=L.data||L;if(x.value={totalShares:u.totalShares,totalAccess:u.totalAccess,successAccess:u.successAccess,failedAccess:u.failedAccess,rejectedAccess:u.rejectedAccess,uniqueIps:u.uniqueIps,successRate:u.successRate,anomalyStats:u.anomalyStats},y.page=1,y.total=0,u.anomalyStats){const{highFreqIpCount:p,highFreqShareCount:re,abnormalFailIpCount:ae}=u.anomalyStats,J=p+re+ae;J>0&&No({title:"⚠️ 异常访问警告",message:`检测到 ${J} 个异常访问行为`,type:"warning",duration:5e3})}}catch(L){console.error("Load global stats error:",L),D.error("加载全局统计失败"),x.value=null}finally{v.value=!1}},se=async()=>{try{y.page=1,await z(),$.shareId?await M($.shareId):await R(),await m(),D.success("数据刷新成功")}catch(L){console.error("Refresh logs error:",L),D.error("刷新失败，请重试")}},B=L=>{y.pageSize=L,y.page=1,m()},H=L=>{y.page=L,m()},K=({row:L})=>L.isAnomaly?"anomaly-row":"",ge=L=>{switch(L){case"success":return"success";case"failed":return"danger";case"rejected":return"warning";default:return"info"}},ce=L=>{switch(L){case"success":return"成功";case"failed":return"失败";case"rejected":return"被拒绝";default:return L}},Y=async L=>{if(!L.shareId){D.error("无法获取分享记录信息");return}try{N.value=L.shareId;const u=await Wa({page:1,pageSize:100}),re=(u.data?.list||u.list||[]).find(ae=>ae.shareId===L.shareId);if(!re){D.error("分享记录不存在或已被删除");return}h.value={...re},E.value=!0}catch(u){console.error("获取分享记录失败:",u),D.error("获取分享记录失败，请重试")}finally{N.value=null}},V=()=>{D.success("API 设置更新成功"),z(),m()},xe=async L=>{if(!L.logId){D.error("无法获取访问日志信息");return}try{C.value=!0,W.value=L;const u=await ql(L.logId);O.value=u,l.splitLayout||(l.splitLayout={mode:"none",selectedEmail:null,showDetailPane:!1,paneSizes:{right:[40,60],bottom:[60,40]}}),S.value=!0,u.emails&&u.emails.length>0&&(await De(),d.value&&d.value.refreshList())}catch(u){console.error("获取访问详情失败:",u),D.error("获取访问详情失败，请重试")}finally{C.value=!1}},ye=async(L,u)=>{const p=O.value?.emails||[];return{list:p,total:p.length,latestEmail:p.length>0?p[0]:null}},we=L=>{l.splitLayout&&(l.splitLayout.selectedEmail=L,l.splitLayout.showDetailPane=!0)},ne=()=>{l.splitLayout&&(l.splitLayout.showDetailPane=!1,l.splitLayout.selectedEmail=null)};return(L,u)=>{const p=qt,re=jt,ae=At,J=Dt,ue=ia,_e=gt,pe=Rt,Ae=rl,Se=Tr,Me=cn,Ge=hn,Le=$a,Oe=Bt,ve=Ca,et=Ta,Be=gn,yt=vn,bt=ra,ht=ft,rt=oa;return w(),P("div",qm,[s("div",Ym,[e(pe,{model:$,inline:""},{default:a(()=>[e(ae,{label:"分享记录"},{default:a(()=>[(w(),le(re,{ref_key:"shareSelectRef",ref:r,modelValue:$.shareId,"onUpdate:modelValue":u[0]||(u[0]=fe=>$.shareId=fe),placeholder:"选择分享记录",clearable:"",filterable:"","default-first-option":"",onChange:Z,style:{width:"300px"},key:f.value},{default:a(()=>[e(p,{label:"全部",value:""}),(w(!0),P(Ee,null,Te(g.value,fe=>(w(),le(p,{key:fe.shareId,label:`${fe.shareName} (${fe.targetEmail})`,value:fe.shareId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]))]),_:1}),e(ae,{label:"访问结果"},{default:a(()=>[e(re,{modelValue:$.accessResult,"onUpdate:modelValue":u[1]||(u[1]=fe=>$.accessResult=fe),placeholder:"选择访问结果",clearable:"",onChange:m,style:{width:"150px"}},{default:a(()=>[e(p,{label:"全部",value:""}),e(p,{label:"成功",value:"success"}),e(p,{label:"失败",value:"failed"}),e(p,{label:"被拒绝",value:"rejected"})]),_:1},8,["modelValue"])]),_:1}),e(ae,{label:"访问邮箱"},{default:a(()=>[e(J,{modelValue:$.accessEmail,"onUpdate:modelValue":u[2]||(u[2]=fe=>$.accessEmail=fe),placeholder:"输入访问邮箱",clearable:"",onChange:m},null,8,["modelValue"])]),_:1}),e(ae,{label:"时间范围"},{default:a(()=>[e(ue,{modelValue:$.dateRange,"onUpdate:modelValue":u[3]||(u[3]=fe=>$.dateRange=fe),type:"datetimerange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间",format:"YYYY-MM-DD HH:mm:ss","value-format":"YYYY-MM-DD HH:mm:ss",onChange:m},null,8,["modelValue"])]),_:1}),e(ae,null,{default:a(()=>[e(_e,{onClick:se},{default:a(()=>[e(k(oe),{icon:"ion:reload",width:"18",height:"18"}),u[9]||(u[9]=_(" 刷新 ",-1))]),_:1})]),_:1})]),_:1},8,["model"])]),x.value?.anomalyStats&&T.value?(w(),le(Ae,{key:0,title:"⚠️ 异常访问警告",type:"warning",closable:!1,"show-icon":"",class:"anomaly-alert"},{default:a(()=>[s("div",Wm,[u[16]||(u[16]=s("p",null,[s("strong",null,"检测到以下异常访问行为：")],-1)),s("ul",null,[x.value.anomalyStats.highFreqIpCount>0?(w(),P("li",Hm,[u[10]||(u[10]=_(" 🔴 高频IP访问：",-1)),s("strong",null,G(x.value.anomalyStats.highFreqIpCount),1),u[11]||(u[11]=_(" 个 （5分钟内访问超过10次） ",-1))])):ee("",!0),x.value.anomalyStats.highFreqShareCount>0?(w(),P("li",Gm,[u[12]||(u[12]=_(" 🔴 高频分享记录访问：",-1)),s("strong",null,G(x.value.anomalyStats.highFreqShareCount),1),u[13]||(u[13]=_(" 个 （5分钟内访问超过20次） ",-1))])):ee("",!0),x.value.anomalyStats.abnormalFailIpCount>0?(w(),P("li",Km,[u[14]||(u[14]=_(" 🔴 异常失败IP：",-1)),s("strong",null,G(x.value.anomalyStats.abnormalFailIpCount),1),u[15]||(u[15]=_(" 个 （5分钟内失败超过5次） ",-1))])):ee("",!0)])])]),_:1})):ee("",!0),x.value?(w(),P("div",Jm,[e(Ge,{gutter:20},{default:a(()=>[x.value.totalShares!==void 0?(w(),le(Me,{key:0,span:4},{default:a(()=>[e(Se,{title:"总分享记录",value:x.value.totalShares},null,8,["value"])]),_:1})):ee("",!0),e(Me,{span:4},{default:a(()=>[e(Se,{title:"总访问次数",value:x.value.totalAccess},null,8,["value"])]),_:1}),e(Me,{span:4},{default:a(()=>[e(Se,{title:"成功访问",value:x.value.successAccess},null,8,["value"])]),_:1}),e(Me,{span:4},{default:a(()=>[e(Se,{title:"失败访问",value:x.value.failedAccess},null,8,["value"])]),_:1}),e(Me,{span:4},{default:a(()=>[e(Se,{title:"被拒绝访问",value:x.value.rejectedAccess},null,8,["value"])]),_:1}),e(Me,{span:4},{default:a(()=>[e(Se,{title:"独立IP数",value:x.value.uniqueIps},null,8,["value"])]),_:1}),e(Me,{span:4},{default:a(()=>[e(Se,{title:"成功率",value:x.value.successRate,suffix:"%"},null,8,["value"])]),_:1})]),_:1})])):ee("",!0),s("div",Zm,[Ie((w(),le(ve,{data:c.value,style:{width:"100%"},"row-class-name":K},{default:a(()=>[e(Le,{prop:"accessTime",label:"访问时间",width:"180"},{default:a(fe=>[s("div",Qm,[fe.row.isAnomaly?(w(),le(k(oe),{key:0,icon:"material-symbols:warning",color:"#f56c6c",width:"16"})):ee("",!0),_(" "+G(k(pt)(fe.row.accessTime).format("YYYY-MM-DD HH:mm:ss")),1)])]),_:1}),e(Le,{prop:"accessIp",label:"访问IP",width:"140"}),e(Le,{prop:"accessEmail",label:"访问邮箱",width:"200"}),e(Le,{label:"邮件详情",width:"120"},{default:a(fe=>[e(_e,{size:"small",type:"primary",link:"",onClick:$t=>xe(fe.row),class:"view-codes-btn"},{default:a(()=>[...u[17]||(u[17]=[_(" 查看邮件 ",-1)])]),_:2},1032,["onClick"])]),_:1}),e(Le,{prop:"accessResult",label:"访问结果",width:"100"},{default:a(fe=>[e(Oe,{type:ge(fe.row.accessResult),size:"small"},{default:a(()=>[_(G(ce(fe.row.accessResult)),1)]),_:2},1032,["type"])]),_:1}),e(Le,{prop:"emailCount",label:"邮件数量",width:"100"}),e(Le,{prop:"responseTime",label:"响应时间",width:"100"},{default:a(fe=>[_(G(fe.row.responseTime)+"ms ",1)]),_:1}),e(Le,{prop:"userAgent",label:"User-Agent","min-width":"200","show-overflow-tooltip":""}),e(Le,{prop:"errorMessage",label:"错误信息","min-width":"200","show-overflow-tooltip":""},{default:a(fe=>[fe.row.errorMessage?(w(),P("span",Xm,G(fe.row.errorMessage),1)):(w(),P("span",ec,"-"))]),_:1}),e(Le,{label:"操作",width:"120",fixed:"right"},{default:a(fe=>[fe.row.accessResult==="success"?(w(),le(_e,{key:0,size:"small",type:"primary",onClick:$t=>Y(fe.row),loading:N.value===fe.row.shareId},{default:a(()=>[...u[18]||(u[18]=[_(" 查看 API ",-1)])]),_:2},1032,["onClick","loading"])):ee("",!0)]),_:1})]),_:1},8,["data"])),[[rt,v.value]]),s("div",tc,[e(et,{"current-page":y.page,"onUpdate:currentPage":u[4]||(u[4]=fe=>y.page=fe),"page-size":y.pageSize,"onUpdate:pageSize":u[5]||(u[5]=fe=>y.pageSize=fe),"page-sizes":[10,20,50,100],total:y.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:B,onCurrentChange:H},null,8,["current-page","page-size","total"])])]),e($n,{modelValue:E.value,"onUpdate:modelValue":u[6]||(u[6]=fe=>E.value=fe),"share-data":h.value,onUpdated:V},null,8,["modelValue","share-data"]),e(ht,{modelValue:S.value,"onUpdate:modelValue":u[7]||(u[7]=fe=>S.value=fe),title:"访问详情",width:"80%","before-close":()=>S.value=!1,class:"access-detail-dialog"},{default:a(()=>[Ie((w(),P("div",ac,[W.value?(w(),P("div",lc,[u[19]||(u[19]=s("h4",null,"访问信息",-1)),e(yt,{column:2,border:""},{default:a(()=>[e(Be,{label:"访问时间"},{default:a(()=>[_(G(k(pt)(W.value.accessTime).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(Be,{label:"访问IP"},{default:a(()=>[_(G(W.value.accessIp),1)]),_:1}),e(Be,{label:"访问邮箱"},{default:a(()=>[_(G(W.value.accessEmail),1)]),_:1}),e(Be,{label:"访问结果"},{default:a(()=>[e(Oe,{type:ge(W.value.accessResult),size:"small"},{default:a(()=>[_(G(ce(W.value.accessResult)),1)]),_:1},8,["type"])]),_:1}),e(Be,{label:"邮件数量"},{default:a(()=>[_(G(W.value.emailCount),1)]),_:1}),e(Be,{label:"响应时间"},{default:a(()=>[_(G(W.value.responseTime)+"ms ",1)]),_:1})]),_:1})])):ee("",!0),O.value&&O.value.emails?(w(),P("div",nc,[u[20]||(u[20]=s("h4",null,"邮件列表",-1)),O.value.emails.length>0?(w(),P("div",oc,[e(an,{ref_key:"emailScrollRef",ref:d,"get-emailList":ye,"show-star":!1,"show-user-info":"","show-status":"",actionLeft:"4px","show-account-icon":!1,onJump:we,type:"access-detail"},null,512)])):(w(),P("div",sc,[e(bt,{description:"该时间段内没有邮件"})]))])):ee("",!0)])),[[rt,C.value]])]),_:1},8,["modelValue","before-close"]),e(ht,{modelValue:I.value,"onUpdate:modelValue":u[8]||(u[8]=fe=>I.value=fe),title:k(l).splitLayout?.selectedEmail?.subject||"邮件详情",width:"70%","close-on-click-modal":!1,class:"email-detail-dialog",onClose:ne},{default:a(()=>[I.value?(w(),le(ln,{key:0})):ee("",!0)]),_:1},8,["modelValue","title"])])}}}),rc=vt(ic,[["__scopeId","data-v-b2b7f59c"]]),dc={key:0,class:"access-log-content"},uc={class:"share-info-section"},mc={class:"share-info-row"},cc={class:"info-value"},pc={class:"share-info-row"},fc={class:"info-value"},vc={class:"share-info-row"},gc={class:"info-value"},yc={class:"logs-table-section"},bc={key:0,class:"pagination-wrapper"},hc={key:1,class:"empty-state"},wc={class:"dialog-footer"},_c={class:"access-detail-content"},Ec={key:0,class:"access-info"},xc={key:1,class:"emails-section"},Vc={key:0,class:"email-scroll-container"},Cc={key:1,class:"no-emails"},$c={__name:"ShareAccessLogDialog",props:{modelValue:{type:Boolean,default:!1},shareData:{type:Object,default:null}},emits:["update:modelValue","closed"],setup(i,{emit:t}){const l=i,r=t,d=nn(),f=ie({get:()=>l.modelValue,set:B=>r("update:modelValue",B)}),v=A(!1),g=A([]),c=A(0),x=A(!1),E=A(!1),h=A(!1),N=A(null),S=A(null),W=A(),C=Ue({page:1,pageSize:20});$e(()=>l.modelValue,B=>{B&&l.shareData&&O()});const O=async()=>{if(!l.shareData?.shareId){D.error("分享记录信息不完整");return}v.value=!0;try{const B={shareId:l.shareData.shareId,page:C.page,pageSize:C.pageSize},H=await jl(B),K=H.data||H;g.value=K.list||[],c.value=K.total||0}catch(B){console.error("Load access logs error:",B),D.error("加载访问日志失败")}finally{v.value=!1}},I=B=>{C.pageSize=B,C.page=1,O()},T=B=>{C.page=B,O()};function $(){f.value=!1}function y(){g.value=[],c.value=0,C.page=1,C.pageSize=20,r("closed")}function q(B){return B?pt(B).format("YYYY-MM-DD HH:mm:ss"):"-"}function Z(B){switch(B){case"success":return"success";case"failed":return"danger";case"rejected":return"warning";default:return"info"}}function z(B){switch(B){case"success":return"成功";case"failed":return"失败";case"rejected":return"拒绝";default:return"未知"}}const m=async B=>{if(!B.logId){D.error("无法获取访问日志信息");return}try{h.value=!0,N.value=B;const H=await ql(B.logId);S.value=H,d.splitLayout||(d.splitLayout={mode:"none",selectedEmail:null,showDetailPane:!1,paneSizes:{right:[40,60],bottom:[60,40]}}),x.value=!0,H.emails&&H.emails.length>0&&(await De(),W.value&&W.value.refreshList())}catch(H){console.error("获取访问详情失败:",H),D.error("获取访问详情失败，请重试")}finally{h.value=!1}},M=async(B,H)=>{const K=S.value?.emails||[];return{list:K,total:K.length,latestEmail:K.length>0?K[0]:null}},R=B=>{d.splitLayout&&(d.splitLayout.selectedEmail=B,d.splitLayout.showDetailPane=!0),E.value=!0},se=()=>{E.value=!1,d.splitLayout&&(d.splitLayout.showDetailPane=!1,d.splitLayout.selectedEmail=null)};return(B,H)=>{const K=$a,ge=gt,ce=Bt,Y=Ca,V=Ta,xe=ra,ye=ft,we=gn,ne=vn,L=oa;return w(),P(Ee,null,[e(ye,{modelValue:f.value,"onUpdate:modelValue":H[2]||(H[2]=u=>f.value=u),title:`访问日志 - ${i.shareData?.shareName||"未知分享"}`,width:"80%","close-on-click-modal":!1,"close-on-press-escape":!0,"show-close":!0,class:"share-access-log-dialog",onClosed:y},{footer:a(()=>[s("div",wc,[e(ge,{onClick:$},{default:a(()=>[...H[9]||(H[9]=[_("关闭",-1)])]),_:1})])]),default:a(()=>[i.shareData?(w(),P("div",dc,[s("div",uc,[s("div",mc,[H[5]||(H[5]=s("span",{class:"info-label"},"分享名称：",-1)),s("span",cc,G(i.shareData.shareName),1)]),s("div",pc,[H[6]||(H[6]=s("span",{class:"info-label"},"目标邮箱：",-1)),s("span",fc,G(i.shareData.targetEmail),1)]),s("div",vc,[H[7]||(H[7]=s("span",{class:"info-label"},"创建时间：",-1)),s("span",gc,G(q(i.shareData.createTime)),1)])]),s("div",yc,[Ie((w(),le(Y,{data:g.value,style:{width:"100%"},"max-height":"400px"},{default:a(()=>[e(K,{prop:"accessTime",label:"访问时间",width:"180"},{default:a(u=>[_(G(q(u.row.accessTime)),1)]),_:1}),e(K,{prop:"accessIp",label:"访问IP",width:"140"}),e(K,{prop:"accessEmail",label:"访问邮箱",width:"200"}),e(K,{label:"邮件详情",width:"120"},{default:a(u=>[e(ge,{size:"small",type:"primary",link:"",onClick:p=>m(u.row)},{default:a(()=>[...H[8]||(H[8]=[_(" 查看邮件 ",-1)])]),_:2},1032,["onClick"])]),_:1}),e(K,{prop:"accessResult",label:"访问结果",width:"100"},{default:a(u=>[e(ce,{type:Z(u.row.accessResult),size:"small"},{default:a(()=>[_(G(z(u.row.accessResult)),1)]),_:2},1032,["type"])]),_:1}),e(K,{prop:"emailCount",label:"邮件数量",width:"100"}),e(K,{prop:"userAgent",label:"用户代理","min-width":"200","show-overflow-tooltip":""})]),_:1},8,["data"])),[[L,v.value]]),c.value>0?(w(),P("div",bc,[e(V,{"current-page":C.page,"onUpdate:currentPage":H[0]||(H[0]=u=>C.page=u),"page-size":C.pageSize,"onUpdate:pageSize":H[1]||(H[1]=u=>C.pageSize=u),"page-sizes":[10,20,50,100],total:c.value,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:I,onCurrentChange:T},null,8,["current-page","page-size","total"])])):ee("",!0),!v.value&&g.value.length===0?(w(),P("div",hc,[e(xe,{description:"暂无访问日志"})])):ee("",!0)])])):ee("",!0)]),_:1},8,["modelValue","title"]),e(ye,{modelValue:x.value,"onUpdate:modelValue":H[3]||(H[3]=u=>x.value=u),title:"访问详情",width:"80%","before-close":()=>x.value=!1,class:"access-detail-dialog"},{default:a(()=>[Ie((w(),P("div",_c,[N.value?(w(),P("div",Ec,[H[10]||(H[10]=s("h4",null,"访问信息",-1)),e(ne,{column:2,border:""},{default:a(()=>[e(we,{label:"访问时间"},{default:a(()=>[_(G(q(N.value.accessTime)),1)]),_:1}),e(we,{label:"访问IP"},{default:a(()=>[_(G(N.value.accessIp),1)]),_:1}),e(we,{label:"访问邮箱"},{default:a(()=>[_(G(N.value.accessEmail),1)]),_:1}),e(we,{label:"访问结果"},{default:a(()=>[e(ce,{type:Z(N.value.accessResult),size:"small"},{default:a(()=>[_(G(z(N.value.accessResult)),1)]),_:1},8,["type"])]),_:1}),e(we,{label:"邮件数量"},{default:a(()=>[_(G(N.value.emailCount),1)]),_:1}),e(we,{label:"User-Agent"},{default:a(()=>[_(G(N.value.userAgent),1)]),_:1})]),_:1})])):ee("",!0),S.value&&S.value.emails?(w(),P("div",xc,[H[11]||(H[11]=s("h4",null,"邮件列表",-1)),S.value.emails.length>0?(w(),P("div",Vc,[e(an,{ref_key:"emailScrollRef",ref:W,"get-emailList":M,"show-star":!1,"show-user-info":"","show-status":"",actionLeft:"4px","show-account-icon":!1,onJump:R,type:"access-detail"},null,512)])):(w(),P("div",Cc,[e(xe,{description:"该时间段内没有邮件"})]))])):ee("",!0)])),[[L,h.value]])]),_:1},8,["modelValue","before-close"]),e(ye,{modelValue:E.value,"onUpdate:modelValue":H[4]||(H[4]=u=>E.value=u),title:k(d).splitLayout?.selectedEmail?.subject||"邮件详情",width:"70%","close-on-click-modal":!1,class:"email-detail-dialog",onClose:se},{default:a(()=>[E.value?(w(),le(ln,{key:0})):ee("",!0)]),_:1},8,["modelValue","title"])],64)}}},kc=vt($c,[["__scopeId","data-v-c10aa87d"]]),Sc={class:"share-header"},Lc={class:"search-section"},Tc={key:0,class:"search-result-count"},Dc={class:"advanced-filter-panel"},Rc={class:"filter-panel-header"},Ac={class:"filter-title"},Ic={class:"filter-actions"},Fc={key:0,class:"applied-filters-section"},Uc={class:"filter-tags"},Pc={class:"filter-grid"},Nc={class:"filter-group"},Mc={class:"filter-item"},zc={class:"quick-time-buttons"},Oc={class:"filter-item"},Bc={class:"filter-group"},jc={class:"filter-item"},qc={class:"range-inputs"},Yc={class:"filter-item"},Wc={class:"range-inputs"},Hc={class:"filter-group"},Gc={class:"filter-item"},Kc={class:"filter-item"},Jc={class:"checkbox-group"},Zc={class:"filter-panel-footer"},Qc={class:"filter-summary"},Xc={key:0},ep={key:1},tp={class:"filter-footer-actions"},ap={class:"filter-section"},lp={class:"count"},np={class:"count"},op={class:"count"},sp={class:"count"},ip={class:"header-actions"},rp={key:0,class:"selected-tip"},dp={class:"share-content"},up={key:0,class:"expire-tip"},mp={key:0,class:"email-cell"},cp={key:1,class:"email-cell multi-email"},pp={class:"email-count"},fp=["onDblclick","title"],vp={key:0},gp={class:"otp-count"},yp=["onClick"],bp={key:1,class:"inline-edit-wrapper"},hp={class:"inline-edit-actions-below"},wp={key:1,class:"limit-disabled"},_p={class:"otp-count-text"},Ep={key:0},xp=["onClick"],Vp={key:1,class:"inline-edit-active"},Cp={class:"inline-edit-actions-below"},$p={key:1},kp={class:"token-display"},Sp=["onDblclick"],Lp={class:"share-url-cell"},Tp={class:"share-url-container"},Dp=["href"],Rp={key:0,class:"authorized-emails-container"},Ap={class:"share-info"},Ip={class:"emails-list"},Fp={class:"email-tags"},Up=Object.assign({name:"share-mvp"},{__name:"index-mvp",setup(i){const t=A(!1),l=A([]),r=A([]),d=A(!1),f=A(!1),v=A(!1),g=A(7),c=A("management"),x=A(!1),E=A(null),h=A(!1),N=A(!1),S=A(null),W=A(!1),C=A(null),O=A(),I=A(""),T=Ue({query:"",searchType:"all",isSearching:!1,searchResultCount:0,debounceTimer:null}),$=A(!1),y=Ue({createTimeRange:null,expireTimeRange:null,otpLimitRange:{min:null,max:null},verificationCodeLimitRange:{min:null,max:null},shareTypes:[],otpLimitEnabled:null,verificationCodeLimitEnabled:null,filterDebounceTimer:null}),q=Ue({total:0,active:0,expired:0,disabled:0}),Z=ie(()=>!!(y.createTimeRange||y.expireTimeRange||y.otpLimitRange.min!==null||y.otpLimitRange.max!==null||y.verificationCodeLimitRange.min!==null||y.verificationCodeLimitRange.max!==null||y.shareTypes.length>0||y.otpLimitEnabled!==null||y.verificationCodeLimitEnabled!==null)),z=ie(()=>{let b=0;return y.createTimeRange&&b++,y.expireTimeRange&&b++,(y.otpLimitRange.min!==null||y.otpLimitRange.max!==null)&&b++,(y.verificationCodeLimitRange.min!==null||y.verificationCodeLimitRange.max!==null)&&b++,y.shareTypes.length>0&&b++,y.otpLimitEnabled!==null&&b++,y.verificationCodeLimitEnabled!==null&&b++,b}),m=ie(()=>{const b=[];if(y.createTimeRange&&b.push({key:"createTimeRange",label:`创建时间: ${y.createTimeRange[0]} 至 ${y.createTimeRange[1]}`}),y.expireTimeRange&&b.push({key:"expireTimeRange",label:`过期时间: ${y.expireTimeRange[0]} 至 ${y.expireTimeRange[1]}`}),y.otpLimitRange.min!==null||y.otpLimitRange.max!==null){const n=y.otpLimitRange.min||"不限",o=y.otpLimitRange.max||"不限";b.push({key:"otpLimitRange",label:`访问限制: ${n} - ${o}`})}if(y.verificationCodeLimitRange.min!==null||y.verificationCodeLimitRange.max!==null){const n=y.verificationCodeLimitRange.min||"不限",o=y.verificationCodeLimitRange.max||"不限";b.push({key:"verificationCodeLimitRange",label:`显示限制: ${n} - ${o}`})}if(y.shareTypes.length>0){const n=y.shareTypes.map(o=>o===1?"单邮箱":"多邮箱");b.push({key:"shareTypes",label:`分享类型: ${n.join(", ")}`})}return y.otpLimitEnabled!==null&&b.push({key:"otpLimitEnabled",label:`访问限制: ${y.otpLimitEnabled?"启用":"禁用"}`}),y.verificationCodeLimitEnabled!==null&&b.push({key:"verificationCodeLimitEnabled",label:`显示限制: ${y.verificationCodeLimitEnabled?"启用":"禁用"}`}),b});Ot(()=>{M()});const M=async()=>{t.value=!0;try{console.log("Loading share list with filter:",I.value,"search:",T.query);const b={page:1,pageSize:100,status:I.value||void 0};T.query&&T.query.trim()&&(b.query=T.query.trim(),b.searchType=T.searchType),Z.value&&(y.createTimeRange&&(b.createTimeStart=y.createTimeRange[0],b.createTimeEnd=y.createTimeRange[1]),y.expireTimeRange&&(b.expireTimeStart=y.expireTimeRange[0],b.expireTimeEnd=y.expireTimeRange[1]),y.otpLimitRange.min!==null&&(b.otpLimitMin=y.otpLimitRange.min),y.otpLimitRange.max!==null&&(b.otpLimitMax=y.otpLimitRange.max),y.verificationCodeLimitRange.min!==null&&(b.verificationCodeLimitMin=y.verificationCodeLimitRange.min),y.verificationCodeLimitRange.max!==null&&(b.verificationCodeLimitMax=y.verificationCodeLimitRange.max),y.shareTypes.length>0&&(b.shareTypes=y.shareTypes.join(",")),y.otpLimitEnabled!==null&&(b.otpLimitEnabled=y.otpLimitEnabled?1:0),y.verificationCodeLimitEnabled!==null&&(b.verificationCodeLimitEnabled=y.verificationCodeLimitEnabled?1:0));const n=await Wa(b);let o=[];n&&n.list?(o=n.list,n.stats&&(q.total=n.stats.total,q.active=n.stats.active,q.expired=n.stats.expired,q.disabled=n.stats.disabled,console.log("Using backend stats:",n.stats))):Array.isArray(n)&&(o=n),console.log("Processed share list:",o),o=o.map(j=>Ue({...j,status:j.status||R(j),daysRemaining:j.daysRemaining!==void 0?j.daysRemaining:se(j),editingName:!1,tempShareName:j.shareName||"",editingLimit:!1,savingLimit:!1,tempOtpLimit:j.otpLimitDaily||100,editingDisplayLimit:!1,savingDisplayLimit:!1,tempDisplayLimit:j.verificationCodeLimit||100,editingExpire:!1,tempExpireTime:j.expireTime||null})),l.value=o,n?.stats||(B(o),console.log("Using frontend stats calculation")),T.searchResultCount=o.length}catch(b){console.error("Load share list error:",b),D.error(`加载分享列表失败: ${b.message||"未知错误"}`),T.searchResultCount=0}finally{t.value=!1}},R=b=>b.isActive===0?"disabled":pt().isAfter(pt(b.expireTime))?"expired":"active",se=b=>{const n=pt();return pt(b.expireTime).diff(n,"day")},B=b=>{q.total=b.length,q.active=b.filter(n=>n.status==="active").length,q.expired=b.filter(n=>n.status==="expired").length,q.disabled=b.filter(n=>n.status==="disabled").length},H=b=>({active:"使用中",expired:"已过期",disabled:"已禁用"})[b.status]||"未知",K=b=>({active:"success",expired:"danger",disabled:"info"})[b.status]||"warning",ge=b=>b.status==="expired"?"已过期":b.daysRemaining<=0?"今天到期":b.daysRemaining<=3?`还剩 ${b.daysRemaining} 天`:"",ce=b=>b.status==="active"&&b.daysRemaining<=3,Y=b=>{const n=b.otp_count_daily||0,o=b.otp_limit_daily||100;return Math.min(n/o*100,100)},V=b=>{const n=Y(b);return n>=90?"#f56c6c":n>=70?"#e6a23c":"#67c23a"},xe=b=>{if(b.shareType!==2||!b.authorizedEmails)return 0;try{const n=typeof b.authorizedEmails=="string"?JSON.parse(b.authorizedEmails):b.authorizedEmails;return Array.isArray(n)?n.length:0}catch(n){return console.error("解析授权邮箱列表失败:",n),0}},ye=b=>{C.value=b,W.value=!0},we=()=>{W.value=!1,C.value=null},ne=b=>{if(!b.authorizedEmails)return[];try{const n=typeof b.authorizedEmails=="string"?JSON.parse(b.authorizedEmails):b.authorizedEmails;return Array.isArray(n)?n:[]}catch(n){return console.error("解析授权邮箱列表失败:",n),[]}},L=b=>{D.info("如需修改授权邮箱，请使用高级设置功能")},u=b=>{if(T.debounceTimer&&clearTimeout(T.debounceTimer),!b||b.trim()===""){re();return}T.isSearching=!0,T.debounceTimer=setTimeout(()=>{p(),T.isSearching=!1},300)},p=()=>{M()},re=()=>{T.query="",T.searchResultCount=0,T.isSearching=!1,T.debounceTimer&&clearTimeout(T.debounceTimer),M()},ae=()=>{T.query&&T.query.trim()&&p()},J=()=>{y.filterDebounceTimer&&clearTimeout(y.filterDebounceTimer),y.filterDebounceTimer=setTimeout(()=>{M()},300)},ue=b=>{const n=new Date,o=new Date(n.getFullYear(),n.getMonth(),n.getDate());switch(b){case"today":y.createTimeRange=[o.toISOString().split("T")[0],o.toISOString().split("T")[0]];break;case"week":const j=new Date(o);j.setDate(o.getDate()-o.getDay()),y.createTimeRange=[j.toISOString().split("T")[0],o.toISOString().split("T")[0]];break;case"month":const te=new Date(o.getFullYear(),o.getMonth(),1);y.createTimeRange=[te.toISOString().split("T")[0],o.toISOString().split("T")[0]];break;case"30days":const Q=new Date(o);Q.setDate(o.getDate()-30),y.createTimeRange=[Q.toISOString().split("T")[0],o.toISOString().split("T")[0]];break}J()},_e=b=>{switch(b){case"createTimeRange":y.createTimeRange=null;break;case"expireTimeRange":y.expireTimeRange=null;break;case"otpLimitRange":y.otpLimitRange={min:null,max:null};break;case"verificationCodeLimitRange":y.verificationCodeLimitRange={min:null,max:null};break;case"shareTypes":y.shareTypes=[];break;case"otpLimitEnabled":y.otpLimitEnabled=null;break;case"verificationCodeLimitEnabled":y.verificationCodeLimitEnabled=null;break}J()},pe=()=>{y.createTimeRange=null,y.expireTimeRange=null,y.otpLimitRange={min:null,max:null},y.verificationCodeLimitRange={min:null,max:null},y.shareTypes=[],y.otpLimitEnabled=null,y.verificationCodeLimitEnabled=null,J()},Ae=()=>{M()},Se=()=>{M()},Me=b=>{So(b,{successMessage:"分享链接已复制到剪贴板",errorMessage:"复制失败，请重试"})},Ge=b=>{r.value=b};ie(()=>l.value.length>0&&r.value.length===l.value.length);const Le=async b=>{try{await Xe.confirm(`确定要刷新"${b.shareName}"的Token吗？刷新后旧的分享链接将失效！`,"确认刷新Token",{type:"warning",confirmButtonText:"确认刷新",cancelButtonText:"取消"});const n=await Bl(b.shareId),o=n.data||n;D.success("Token刷新成功，新链接已生成"),o.shareUrl&&Me(o.shareUrl);const j=l.value.findIndex(te=>te.shareId===b.shareId);j!==-1&&(l.value[j].shareToken=o.shareToken,l.value[j].shareUrl=o.shareUrl)}catch(n){n!=="cancel"&&(console.error("Refresh token error:",n),D.error("刷新Token失败"))}},Oe=b=>{b==="custom"?(g.value=7,v.value=!0):Be(parseInt(b))},ve=b=>{if(r.value.length===0){D.warning("请先选择要修改的分享链接");return}switch(b){case"advanced":h.value=!0;break;case"rateLimit":Pa();break;case"emailCount":Na();break;case"autoRefresh":Ma();break;default:h.value=!0}},et=()=>{if(g.value<1||g.value>365){D.warning("请输入1-365之间的天数");return}v.value=!1,Be(g.value)},Be=async b=>{if(r.value.length===0)return;const n=r.value.map(j=>`• ID ${j.shareId}: ${j.targetEmail} (${j.shareName||"未命名"})`).join(`
`),o=`
<div style="text-align: left;">
  <h4 style="margin: 0 0 12px 0; color: #409EFF;">批量延长操作确认</h4>
  <p style="margin: 8px 0;"><strong>操作内容：</strong>延长 ${r.value.length} 个分享的有效期</p>
  <p style="margin: 8px 0;"><strong>延长时间：</strong>${b} 天</p>
  <p style="margin: 8px 0;"><strong>操作影响：</strong>所选分享的过期时间将延后 ${b} 天</p>
  
  <details style="margin: 12px 0;">
    <summary style="cursor: pointer; color: #606266;">查看受影响的分享 (${r.value.length} 项)</summary>
    <div style="margin-top: 8px; padding: 8px; background: #f5f7fa; border-radius: 4px; font-size: 12px; max-height: 120px; overflow-y: auto;">
      ${n}
    </div>
  </details>
  
  <p style="margin: 8px 0 0 0; color: #909399; font-size: 12px;">
    💡 提示：此操作可以撤销，您可以随时调整分享的有效期
  </p>
</div>`;try{await Xe.confirm(o,"确认批量延长",{type:"info",dangerouslyUseHTMLString:!0,confirmButtonText:`延长 ${b} 天`,cancelButtonText:"取消操作"});const j=r.value.map(de=>de.shareId),te=await St("extend",j,{extendDays:b});await M();const Q=te?.affected||0;D.success(`成功延长 ${Q} 个分享的有效期`),r.value=[],O.value&&O.value.clearSelection()}catch(j){j!=="cancel"&&(console.error("Batch extend error:",j),D.error("批量延长失败"))}},yt=async()=>{if(r.value.length===0)return;const b=r.value.map(o=>`• ID ${o.shareId}: ${o.targetEmail} (${o.shareName||"未命名"})`).join(`
`),n=`
<div style="text-align: left;">
  <h4 style="margin: 0 0 12px 0; color: #E6A23C;">批量禁用操作确认</h4>
  <p style="margin: 8px 0;"><strong>操作内容：</strong>禁用 ${r.value.length} 个分享</p>
  <p style="margin: 8px 0;"><strong>操作影响：</strong>所选分享的访问链接将立即失效</p>
  <p style="margin: 8px 0;"><strong>用户影响：</strong>访问者将无法通过分享链接查看邮件</p>
  
  <details style="margin: 12px 0;">
    <summary style="cursor: pointer; color: #606266;">查看受影响的分享 (${r.value.length} 项)</summary>
    <div style="margin-top: 8px; padding: 8px; background: #fdf6ec; border-radius: 4px; font-size: 12px; max-height: 120px; overflow-y: auto;">
      ${b}
    </div>
  </details>
  
  <p style="margin: 8px 0 0 0; color: #E6A23C; font-size: 12px;">
    ⚠️ 注意：禁用后可以重新启用，但访问者需要重新获取链接
  </p>
</div>`;try{await Xe.confirm(n,"确认批量禁用",{type:"warning",dangerouslyUseHTMLString:!0,confirmButtonText:`禁用 ${r.value.length} 个分享`,cancelButtonText:"取消操作"});const o=r.value.map(Q=>Q.shareId),j=await St("disable",o);await M();const te=j?.affected||0;D.success(`成功禁用 ${te} 个分享`),r.value=[],O.value&&O.value.clearSelection()}catch(o){o!=="cancel"&&(console.error("Batch disable error:",o),D.error("批量禁用失败"))}},bt=async()=>{if(r.value.length===0)return;const b=r.value.map(o=>`• ID ${o.shareId}: ${o.targetEmail} (${o.shareName||"未命名"})`).join(`
`),n=`
<div style="text-align: left;">
  <h4 style="margin: 0 0 12px 0; color: #67C23A;">批量启用操作确认</h4>
  <p style="margin: 8px 0;"><strong>操作内容：</strong>启用 ${r.value.length} 个分享</p>
  <p style="margin: 8px 0;"><strong>操作影响：</strong>所选分享的访问链接将立即生效</p>
  <p style="margin: 8px 0;"><strong>用户影响：</strong>访问者可以通过分享链接查看邮件内容</p>
  
  <details style="margin: 12px 0;">
    <summary style="cursor: pointer; color: #606266;">查看受影响的分享 (${r.value.length} 项)</summary>
    <div style="margin-top: 8px; padding: 8px; background: #f0f9ff; border-radius: 4px; font-size: 12px; max-height: 120px; overflow-y: auto;">
      ${b}
    </div>
  </details>
  
  <p style="margin: 8px 0 0 0; color: #67C23A; font-size: 12px;">
    ✅ 提示：启用后分享链接将立即可用，请确保内容适合公开访问
  </p>
</div>`;try{await Xe.confirm(n,"确认批量启用",{type:"success",dangerouslyUseHTMLString:!0,confirmButtonText:`启用 ${r.value.length} 个分享`,cancelButtonText:"取消操作"});const o=r.value.map(Q=>Q.shareId),j=await St("enable",o);await M();const te=j?.affected||0;D.success(`成功启用 ${te} 个邮件分享链接`),r.value=[],O.value&&O.value.clearSelection()}catch(o){o!=="cancel"&&(console.error("Batch enable error:",o),D.error("批量启用失败"))}},ht=b=>{S.value=b,N.value=!0},rt=async b=>{try{await Xe.confirm(`确定要删除分享"${b.shareName}"吗？`,"确认删除",{type:"warning"}),await fo(b.shareId),D.success("删除成功"),M()}catch(n){n!=="cancel"&&(console.error("Delete share error:",n),D.error("删除失败"))}},fe=b=>{M()},$t=()=>{D.success("邮箱白名单更新成功")},It=b=>{b.editingName=!0,b.tempShareName=b.shareName,De(()=>{const n=document.querySelector(`[data-share-id="${b.shareId}"] .el-input__inner`);n&&n.focus()})},Ft=async b=>{if(!b.tempShareName||b.tempShareName.trim()===""){D.warning("分享名称不能为空");return}if(b.tempShareName.trim()===b.shareName){X(b);return}try{await uo(b.shareId,b.tempShareName.trim()),b.shareName=b.tempShareName.trim(),b.editingName=!1,D.success("分享名称更新成功")}catch(n){console.error("Update share name error:",n),D.error("更新分享名称失败")}},X=b=>{b.editingName=!1,b.tempShareName=b.shareName},Pe=b=>{b.editingLimit=!0,b.tempOtpLimit=b.otpLimitDaily||100,b.savingLimit=!1,De(()=>{Ut.value&&Ut.value.focus&&Ut.value.focus()})},dt=async b=>{if(!b.tempOtpLimit||b.tempOtpLimit<1){D.warning("每日限制必须大于0");return}if(b.tempOtpLimit===b.otpLimitDaily){Yt(b);return}b.savingLimit=!0;try{const n=await mo(b.shareId,b.tempOtpLimit);b.otpLimitDaily=b.tempOtpLimit,b.editingLimit=!1,b.savingLimit=!1,D.success("每日限制更新成功")}catch(n){b.savingLimit=!1,console.error("Update limit error:",n);let o="更新每日限制失败";n.response?.data?.message?o+=": "+n.response.data.message:n.message&&(o+=": "+n.message),D.error(o)}},Yt=b=>{b.editingLimit=!1,b.savingLimit=!1,b.tempOtpLimit=b.otpLimitDaily||100},Ut=A(null),Pt=A(null),Aa=b=>{b.editingDisplayLimit=!0,b.tempDisplayLimit=b.verificationCodeLimit||100,b.savingDisplayLimit=!1,De(()=>{Pt.value&&Pt.value.focus&&Pt.value.focus()})},Wt=async b=>{if(!b.tempDisplayLimit||b.tempDisplayLimit<1){D.warning("显示限制必须大于0");return}if(b.tempDisplayLimit===b.verificationCodeLimit){Ht(b);return}b.savingDisplayLimit=!0;try{const n=await co(b.shareId,b.tempDisplayLimit);b.verificationCodeLimit=b.tempDisplayLimit,b.editingDisplayLimit=!1,b.savingDisplayLimit=!1,D.success("显示限制更新成功")}catch(n){b.savingDisplayLimit=!1,console.error("Update display limit error:",n);let o="更新显示限制失败";n.response?.data?.message?o+=": "+n.response.data.message:n.message&&(o+=": "+n.message),D.error(o)}},Ht=b=>{b.editingDisplayLimit=!1,b.savingDisplayLimit=!1,b.tempDisplayLimit=b.verificationCodeLimit||100},Ia=b=>{const n=b.target;if(!(n.closest(".el-input-number")||n.closest(".el-button")||n.closest(".el-dialog")||n.closest(".el-select")||n.closest(".el-date-picker"))){const j=l.value.find(Q=>Q.editingLimit);j&&dt(j);const te=l.value.find(Q=>Q.editingDisplayLimit);te&&Wt(te)}},Fa=b=>{E.value={...b},x.value=!0},Ua=()=>{M(),D.success("高级设置更新成功")},kt=()=>{M(),r.value=[],O.value&&O.value.clearSelection()},Pa=async()=>{try{const{value:b}=await Xe.prompt("请输入新的频率限制（格式：每秒次数,自动恢复秒数，如：5,60）","快速设置频率限制",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^\d+,\d+$/,inputErrorMessage:"请输入正确格式：数字,数字"}),[n,o]=b.split(",").map(te=>parseInt(te.trim()));if(n<1||n>100||o<0||o>3600){D.error("频率限制超出范围（每秒1-100，恢复时间0-3600秒）");return}const j=r.value.map(te=>te.shareId);await St("updateAdvancedSettings",j,{settings:{rateLimitPerSecond:n,autoRecoverySeconds:o}}),D.success(`成功设置 ${j.length} 个分享的频率限制`),kt()}catch(b){b!=="cancel"&&(console.error("Quick rate limit error:",b),D.error("设置频率限制失败"))}},Na=async()=>{try{const{value:b}=await Xe.prompt("请输入最新邮件显示数量（1-100，留空表示显示全部）","快速设置邮件数量限制",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^(\d+)?$/,inputErrorMessage:"请输入1-100之间的数字或留空"}),n=b?parseInt(b):null;if(n!==null&&(n<1||n>100)){D.error("邮件数量必须在1-100之间");return}const o=r.value.map(te=>te.shareId);await St("updateAdvancedSettings",o,{settings:{latestEmailCount:n}});const j=n?`成功设置 ${o.length} 个分享显示最新 ${n} 封邮件`:`成功设置 ${o.length} 个分享显示全部邮件`;D.success(j),kt()}catch(b){b!=="cancel"&&(console.error("Quick email count error:",b),D.error("设置邮件数量限制失败"))}},Ma=async()=>{try{const{value:b}=await Xe.prompt("请输入自动刷新间隔（秒，10-3600，输入0表示禁用）","快速设置自动刷新",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^\d+$/,inputErrorMessage:"请输入数字"}),n=parseInt(b);if(n!==0&&(n<10||n>3600)){D.error("刷新间隔必须在10-3600秒之间，或输入0禁用");return}const o=r.value.map(te=>te.shareId);await St("updateAdvancedSettings",o,{settings:{autoRefreshEnabled:n>0?1:0,autoRefreshInterval:n>0?n:30}});const j=n>0?`成功设置 ${o.length} 个分享自动刷新间隔为 ${n} 秒`:`成功禁用 ${o.length} 个分享的自动刷新`;D.success(j),kt()}catch(b){b!=="cancel"&&(console.error("Quick auto refresh error:",b),D.error("设置自动刷新失败"))}},Gt=b=>{b.editingExpire=!0,b.tempExpireTime=b.expireTime},ma=async b=>{if(!b.tempExpireTime){D.warning("过期时间不能为空");return}if(b.tempExpireTime===b.expireTime){ca(b);return}if(new Date(b.tempExpireTime)<=new Date){D.warning("过期时间必须在未来");return}try{await po(b.shareId,b.tempExpireTime),b.expireTime=b.tempExpireTime,b.editingExpire=!1,D.success("过期时间更新成功")}catch(o){console.error("Update share expire time error:",o),D.error("更新过期时间失败")}},ca=b=>{b.editingExpire=!1,b.tempExpireTime=b.expireTime};return(b,n)=>{const o=qt,j=jt,te=Dt,Q=gt,de=Bt,je=ia,Re=cn,ke=La,Ke=ka,Nt=ol,qe=hn,ut=Mo,nt=ko,tt=Sa,ot=cl,Mt=to,at=Zl,Kt=Jl,pa=Kl,Ye=$a,za=hr,Oa=$o,U=Ca,We=Vn,wt=xn,pl=ft,kn=At,Sn=Rt,mt=eo("perm"),Ln=oa;return w(),P("div",{class:"share-container",onClick:Ia},[e(wt,{modelValue:c.value,"onUpdate:modelValue":n[19]||(n[19]=F=>c.value=F),class:"share-tabs"},{default:a(()=>[e(We,{label:"分享管理",name:"management"},{default:a(()=>[s("div",Sc,[s("div",Lc,[e(te,{modelValue:T.query,"onUpdate:modelValue":n[1]||(n[1]=F=>T.query=F),placeholder:"搜索分享名称、目标邮箱、分享令牌...",clearable:"",onInput:u,onClear:re,class:"search-input",loading:T.isSearching},{prefix:a(()=>[e(j,{modelValue:T.searchType,"onUpdate:modelValue":n[0]||(n[0]=F=>T.searchType=F),onChange:ae,style:{width:"120px"},size:"small"},{default:a(()=>[e(o,{label:"全部内容",value:"all"}),e(o,{label:"分享名称",value:"shareName"}),e(o,{label:"目标邮箱",value:"targetEmail"}),e(o,{label:"分享令牌",value:"shareToken"})]),_:1},8,["modelValue"])]),suffix:a(()=>[T.searchResultCount>0?(w(),P("span",Tc," 找到 "+G(T.searchResultCount)+" 条结果 ",1)):ee("",!0)]),_:1},8,["modelValue","loading"])]),e(ut,null,{default:a(()=>[Ie(s("div",Dc,[s("div",Rc,[s("div",Ac,[e(k(oe),{icon:"material-symbols:filter-list"}),n[30]||(n[30]=s("span",null,"高级筛选",-1))]),s("div",Ic,[Z.value?(w(),le(Q,{key:0,type:"text",onClick:pe,class:"clear-all-btn"},{default:a(()=>[...n[31]||(n[31]=[_(" 清除全部 ",-1)])]),_:1})):ee("",!0),e(Q,{type:"text",onClick:n[2]||(n[2]=F=>$.value=!1),class:"close-btn"},{default:a(()=>[e(k(oe),{icon:"material-symbols:close"})]),_:1})])]),Z.value?(w(),P("div",Fc,[n[32]||(n[32]=s("div",{class:"applied-filters-label"},"已应用筛选：",-1)),s("div",Uc,[(w(!0),P(Ee,null,Te(m.value,F=>(w(),le(de,{key:F.key,closable:"",onClose:be=>_e(F.key),class:"filter-tag"},{default:a(()=>[_(G(F.label),1)]),_:2},1032,["onClose"]))),128))])])):ee("",!0),s("div",Pc,[e(qe,{gutter:24},{default:a(()=>[e(Re,{xs:24,sm:12,md:8,class:"filter-column"},{default:a(()=>[s("div",Nc,[n[39]||(n[39]=s("h4",{class:"filter-group-title"},"时间筛选",-1)),s("div",Mc,[n[37]||(n[37]=s("label",{class:"filter-label"},"创建时间",-1)),e(je,{modelValue:y.createTimeRange,"onUpdate:modelValue":n[3]||(n[3]=F=>y.createTimeRange=F),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:J,style:{width:"100%"}},null,8,["modelValue"]),s("div",zc,[e(Q,{onClick:n[4]||(n[4]=F=>ue("today")),class:"quick-time-btn"},{default:a(()=>[...n[33]||(n[33]=[_("今天",-1)])]),_:1}),e(Q,{onClick:n[5]||(n[5]=F=>ue("week")),class:"quick-time-btn"},{default:a(()=>[...n[34]||(n[34]=[_("本周",-1)])]),_:1}),e(Q,{onClick:n[6]||(n[6]=F=>ue("month")),class:"quick-time-btn"},{default:a(()=>[...n[35]||(n[35]=[_("本月",-1)])]),_:1}),e(Q,{onClick:n[7]||(n[7]=F=>ue("30days")),class:"quick-time-btn"},{default:a(()=>[...n[36]||(n[36]=[_("最近30天",-1)])]),_:1})])]),s("div",Oc,[n[38]||(n[38]=s("label",{class:"filter-label"},"过期时间",-1)),e(je,{modelValue:y.expireTimeRange,"onUpdate:modelValue":n[8]||(n[8]=F=>y.expireTimeRange=F),type:"daterange","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",onChange:J,style:{width:"100%"}},null,8,["modelValue"])])])]),_:1}),e(Re,{xs:24,sm:12,md:8,class:"filter-column"},{default:a(()=>[s("div",Bc,[n[44]||(n[44]=s("h4",{class:"filter-group-title"},"数值范围",-1)),s("div",jc,[n[41]||(n[41]=s("label",{class:"filter-label"},"每日访问限制",-1)),s("div",qc,[e(ke,{modelValue:y.otpLimitRange.min,"onUpdate:modelValue":n[9]||(n[9]=F=>y.otpLimitRange.min=F),placeholder:"最小值",min:0,max:1e4,onChange:J,style:{width:"48%"}},null,8,["modelValue"]),n[40]||(n[40]=s("span",{class:"range-separator"},"-",-1)),e(ke,{modelValue:y.otpLimitRange.max,"onUpdate:modelValue":n[10]||(n[10]=F=>y.otpLimitRange.max=F),placeholder:"最大值",min:0,max:1e4,onChange:J,style:{width:"48%"}},null,8,["modelValue"])])]),s("div",Yc,[n[43]||(n[43]=s("label",{class:"filter-label"},"显示数量限制",-1)),s("div",Wc,[e(ke,{modelValue:y.verificationCodeLimitRange.min,"onUpdate:modelValue":n[11]||(n[11]=F=>y.verificationCodeLimitRange.min=F),placeholder:"最小值",min:0,max:1e3,onChange:J,style:{width:"48%"}},null,8,["modelValue"]),n[42]||(n[42]=s("span",{class:"range-separator"},"-",-1)),e(ke,{modelValue:y.verificationCodeLimitRange.max,"onUpdate:modelValue":n[12]||(n[12]=F=>y.verificationCodeLimitRange.max=F),placeholder:"最大值",min:0,max:1e3,onChange:J,style:{width:"48%"}},null,8,["modelValue"])])])])]),_:1}),e(Re,{xs:24,sm:24,md:8,class:"filter-column"},{default:a(()=>[s("div",Hc,[n[51]||(n[51]=s("h4",{class:"filter-group-title"},"状态筛选",-1)),s("div",Gc,[n[47]||(n[47]=s("label",{class:"filter-label"},"分享类型",-1)),e(Nt,{modelValue:y.shareTypes,"onUpdate:modelValue":n[13]||(n[13]=F=>y.shareTypes=F),onChange:J,class:"checkbox-group"},{default:a(()=>[e(Ke,{label:1},{default:a(()=>[...n[45]||(n[45]=[_("单邮箱分享",-1)])]),_:1}),e(Ke,{label:2},{default:a(()=>[...n[46]||(n[46]=[_("多邮箱分享",-1)])]),_:1})]),_:1},8,["modelValue"])]),s("div",Kc,[n[50]||(n[50]=s("label",{class:"filter-label"},"限制启用状态",-1)),s("div",Jc,[e(Ke,{modelValue:y.otpLimitEnabled,"onUpdate:modelValue":n[14]||(n[14]=F=>y.otpLimitEnabled=F),onChange:J,indeterminate:y.otpLimitEnabled===null},{default:a(()=>[...n[48]||(n[48]=[_(" 访问限制启用 ",-1)])]),_:1},8,["modelValue","indeterminate"]),e(Ke,{modelValue:y.verificationCodeLimitEnabled,"onUpdate:modelValue":n[15]||(n[15]=F=>y.verificationCodeLimitEnabled=F),onChange:J,indeterminate:y.verificationCodeLimitEnabled===null},{default:a(()=>[...n[49]||(n[49]=[_(" 显示限制启用 ",-1)])]),_:1},8,["modelValue","indeterminate"])])])])]),_:1})]),_:1})]),s("div",Zc,[s("div",Qc,[Z.value?(w(),P("span",Xc,"已应用 "+G(z.value)+" 个筛选条件",1)):(w(),P("span",ep,"未应用任何筛选条件"))]),s("div",tp,[e(Q,{onClick:pe,disabled:!Z.value},{default:a(()=>[...n[52]||(n[52]=[_("重置",-1)])]),_:1},8,["disabled"]),e(Q,{type:"primary",onClick:Ae},{default:a(()=>[...n[53]||(n[53]=[_("应用筛选",-1)])]),_:1})])])],512),[[Nl,$.value]])]),_:1}),s("div",ap,[e(tt,{modelValue:I.value,"onUpdate:modelValue":n[16]||(n[16]=F=>I.value=F),onChange:M,size:"small"},{default:a(()=>[e(nt,{label:""},{default:a(()=>[n[54]||(n[54]=_(" 全部 ",-1)),s("span",lp,"("+G(q.total)+")",1)]),_:1}),e(nt,{label:"active"},{default:a(()=>[n[55]||(n[55]=_(" 活跃 ",-1)),s("span",np,"("+G(q.active)+")",1)]),_:1}),e(nt,{label:"expired"},{default:a(()=>[n[56]||(n[56]=_(" 已过期 ",-1)),s("span",op,"("+G(q.expired)+")",1)]),_:1}),e(nt,{label:"disabled"},{default:a(()=>[n[57]||(n[57]=_(" 已禁用 ",-1)),s("span",sp,"("+G(q.disabled)+")",1)]),_:1})]),_:1},8,["modelValue"])]),s("div",ip,[Ie((w(),le(Q,{type:"primary",onClick:n[17]||(n[17]=F=>d.value=!0)},{default:a(()=>[e(k(oe),{icon:"material-symbols:share"}),n[58]||(n[58]=_(" 创建分享 ",-1))]),_:1})),[[mt,"share:create"]]),e(ot,{direction:"vertical"}),e(Q,{onClick:n[18]||(n[18]=F=>$.value=!$.value),type:$.value||Z.value?"primary":"default"},{default:a(()=>[e(k(oe),{icon:"material-symbols:filter-list"}),n[59]||(n[59]=_(" 高级筛选 ",-1)),z.value>0?(w(),le(Mt,{key:0,value:z.value,class:"filter-badge"},null,8,["value"])):ee("",!0)]),_:1},8,["type"]),e(ot,{direction:"vertical"}),Ie((w(),le(pa,{onCommand:Oe,disabled:r.value.length===0},{dropdown:a(()=>[e(Kt,null,{default:a(()=>[e(at,{command:"7"},{default:a(()=>[e(k(oe),{icon:"material-symbols:calendar-today"}),n[61]||(n[61]=_(" 延长 7 天 ",-1))]),_:1}),e(at,{command:"30"},{default:a(()=>[e(k(oe),{icon:"material-symbols:calendar-month"}),n[62]||(n[62]=_(" 延长 30 天 ",-1))]),_:1}),e(at,{command:"90"},{default:a(()=>[e(k(oe),{icon:"material-symbols:date-range"}),n[63]||(n[63]=_(" 延长 90 天 ",-1))]),_:1}),e(at,{command:"custom",divided:""},{default:a(()=>[e(k(oe),{icon:"material-symbols:edit-calendar"}),n[64]||(n[64]=_(" 自定义天数... ",-1))]),_:1})]),_:1})]),default:a(()=>[e(Q,{disabled:r.value.length===0},{default:a(()=>[e(k(oe),{icon:"material-symbols:calendar-add-on"}),n[60]||(n[60]=_(" 批量延长 ",-1)),e(k(oe),{icon:"ep:arrow-down",style:{"margin-left":"4px"}})]),_:1},8,["disabled"])]),_:1},8,["disabled"])),[[mt,"share:create"]]),Ie((w(),le(Q,{disabled:r.value.length===0,onClick:yt,type:"warning"},{default:a(()=>[e(k(oe),{icon:"material-symbols:block"}),n[65]||(n[65]=_(" 批量禁用 ",-1))]),_:1},8,["disabled"])),[[mt,"share:delete"]]),Ie((w(),le(Q,{disabled:r.value.length===0,onClick:bt,type:"success"},{default:a(()=>[e(k(oe),{icon:"material-symbols:check-circle"}),n[66]||(n[66]=_(" 批量启用 ",-1))]),_:1},8,["disabled"])),[[mt,"share:create"]]),Ie((w(),le(pa,{onCommand:ve,disabled:r.value.length===0},{dropdown:a(()=>[e(Kt,null,{default:a(()=>[e(at,{command:"advanced"},{default:a(()=>[e(k(oe),{icon:"material-symbols:tune"}),n[68]||(n[68]=_(" 高级参数设置 ",-1))]),_:1}),e(at,{command:"rateLimit"},{default:a(()=>[e(k(oe),{icon:"material-symbols:speed"}),n[69]||(n[69]=_(" 频率限制设置 ",-1))]),_:1}),e(at,{command:"emailCount"},{default:a(()=>[e(k(oe),{icon:"material-symbols:mail"}),n[70]||(n[70]=_(" 邮件数量限制 ",-1))]),_:1}),e(at,{command:"autoRefresh"},{default:a(()=>[e(k(oe),{icon:"material-symbols:refresh"}),n[71]||(n[71]=_(" 自动刷新设置 ",-1))]),_:1})]),_:1})]),default:a(()=>[e(Q,{disabled:r.value.length===0,type:"info"},{default:a(()=>[e(k(oe),{icon:"material-symbols:settings"}),n[67]||(n[67]=_(" 批量设置 ",-1)),e(k(oe),{icon:"ep:arrow-down",style:{"margin-left":"4px"}})]),_:1},8,["disabled"])]),_:1},8,["disabled"])),[[mt,"share:create"]]),e(ot,{direction:"vertical"}),e(Q,{onClick:Se},{default:a(()=>[e(k(oe),{icon:"ion:reload",width:"18",height:"18"}),n[72]||(n[72]=_(" 刷新 ",-1))]),_:1}),r.value.length>0?(w(),P("span",rp,[n[73]||(n[73]=_(" 已选择 ",-1)),s("strong",null,G(r.value.length),1),_(" / "+G(l.value.length)+" 项 ",1)])):ee("",!0)])]),s("div",dp,[Ie((w(),le(U,{ref_key:"tableRef",ref:O,data:l.value,style:{width:"100%"},onSelectionChange:Ge,"row-key":"shareId"},{default:a(()=>[e(Ye,{type:"selection",width:"55"}),e(Ye,{prop:"shareId",label:"ID",width:"80"}),e(Ye,{label:"状态",width:"120"},{default:a(F=>[e(de,{type:K(F.row),size:"small"},{default:a(()=>[_(G(H(F.row)),1)]),_:2},1032,["type"]),F.row.daysRemaining!==void 0?(w(),P("div",up,G(ge(F.row)),1)):ee("",!0)]),_:1}),e(Ye,{label:"分享类型",width:"120",align:"center"},{default:a(F=>[e(de,{type:F.row.shareType===1?"primary":"success",size:"small"},{default:a(()=>[_(G(F.row.shareType===1?"单邮箱分享":"多邮箱分享"),1)]),_:2},1032,["type"])]),_:1}),e(Ye,{label:"目标邮箱","min-width":"200"},{default:a(F=>[F.row.shareType===1?(w(),P("div",mp,G(F.row.targetEmail),1)):(w(),P("div",cp,[s("span",pp,G(xe(F.row))+"个授权邮箱",1),e(Q,{link:"",type:"primary",size:"small",onClick:be=>ye(F.row)},{default:a(()=>[...n[74]||(n[74]=[_(" 查看详情 ",-1)])]),_:2},1032,["onClick"])]))]),_:1}),e(Ye,{label:"分享名称","min-width":"150"},{default:a(F=>[F.row.editingName?(w(),le(te,{key:1,modelValue:F.row.tempShareName,"onUpdate:modelValue":be=>F.row.tempShareName=be,size:"small",onBlur:be=>Ft(F.row),onKeyup:[ct(be=>Ft(F.row),["enter"]),ct(be=>X(F.row),["esc"])],ref:"nameInput",maxlength:"100","show-word-limit":""},null,8,["modelValue","onUpdate:modelValue","onBlur","onKeyup"])):(w(),P("div",{key:0,onDblclick:be=>It(F.row),class:"editable-cell",title:F.row.shareName},[_(G(F.row.shareName)+" ",1),e(k(oe),{icon:"material-symbols:edit",class:"edit-icon"})],40,fp))]),_:1}),e(Ye,{label:"今日访问",width:"170",align:"center"},{default:a(F=>[F.row.otpLimitEnabled===1?(w(),P("div",vp,[e(za,{percentage:Y(F.row),color:V(F.row),"stroke-width":12,"show-text":!1},null,8,["percentage","color"]),s("div",gp,[_(G(F.row.otpCountDaily||0)+" / ",1),F.row.editingLimit?(w(),P("div",bp,[e(ke,{modelValue:F.row.tempOtpLimit,"onUpdate:modelValue":be=>F.row.tempOtpLimit=be,size:"default",min:1,max:1e4,loading:F.row.savingLimit,onKeyup:[ct(be=>dt(F.row),["enter"]),ct(be=>Yt(F.row),["esc"])],ref_key:"limitInput",ref:Ut,style:{width:"150px"},class:"inline-edit-input"},null,8,["modelValue","onUpdate:modelValue","loading","onKeyup"]),s("div",hp,[e(Q,{size:"small",onClick:be=>Yt(F.row),class:"action-btn-below",icon:"",title:"取消编辑 (Esc)"},{default:a(()=>[e(k(oe),{icon:"material-symbols:close",style:{"font-size":"14px"}})]),_:2},1032,["onClick"]),e(Q,{size:"small",type:"primary",onClick:be=>dt(F.row),loading:F.row.savingLimit,class:"action-btn-below",icon:"",title:"保存 (Enter)"},{default:a(()=>[e(k(oe),{icon:"material-symbols:check",style:{"font-size":"14px"}})]),_:2},1032,["onClick","loading"])])])):(w(),P("span",{key:0,onClick:st(be=>Pe(F.row),["stop"]),class:"editable-limit",title:"单击编辑每日访问限制"},[_(G(F.row.otpLimitDaily||100)+" ",1),e(k(oe),{icon:"material-symbols:edit",class:"edit-icon-small"})],8,yp))])])):(w(),P("div",wp,[e(de,{type:"info",size:"small"},{default:a(()=>[...n[75]||(n[75]=[_("无限制",-1)])]),_:1}),s("div",_p,G(F.row.otpCountDaily||0)+" 次",1)]))]),_:1}),e(Ye,{label:"显示限制",width:"140",align:"center"},{default:a(F=>[F.row.verificationCodeLimitEnabled===1?(w(),P("div",Ep,[F.row.editingDisplayLimit?(w(),P("div",Vp,[e(ke,{modelValue:F.row.tempDisplayLimit,"onUpdate:modelValue":be=>F.row.tempDisplayLimit=be,size:"default",min:1,max:1e3,loading:F.row.savingDisplayLimit,onKeyup:[ct(be=>Wt(F.row),["enter"]),ct(be=>Ht(F.row),["esc"])],ref_key:"displayLimitInput",ref:Pt,style:{width:"150px"},class:"inline-edit-input"},null,8,["modelValue","onUpdate:modelValue","loading","onKeyup"]),s("div",Cp,[e(Q,{size:"small",onClick:be=>Ht(F.row),class:"action-btn-below",icon:"",title:"取消编辑 (Esc)"},{default:a(()=>[e(k(oe),{icon:"material-symbols:close",style:{"font-size":"14px"}})]),_:2},1032,["onClick"]),e(Q,{size:"small",type:"primary",onClick:be=>Wt(F.row),loading:F.row.savingDisplayLimit,class:"action-btn-below",icon:"",title:"保存 (Enter)"},{default:a(()=>[e(k(oe),{icon:"material-symbols:check",style:{"font-size":"14px"}})]),_:2},1032,["onClick","loading"])])])):(w(),P("div",{key:0,class:"inline-edit-container",onClick:st(be=>Aa(F.row),["stop"]),title:"单击编辑显示限制",style:{cursor:"pointer"}},[e(de,{type:"success",size:"small",class:"editable-tag"},{default:a(()=>[_(" 最多 "+G(F.row.verificationCodeLimit||100)+" 条 ",1),e(k(oe),{icon:"material-symbols:edit",class:"edit-icon-small"})]),_:2},1024)],8,xp))])):(w(),P("div",$p,[e(de,{type:"info",size:"small"},{default:a(()=>[...n[76]||(n[76]=[_("显示全部",-1)])]),_:1})]))]),_:1}),e(Ye,{label:"Token令牌",width:"150"},{default:a(F=>[e(Oa,{content:F.row.shareToken,placement:"top"},{default:a(()=>[s("code",kp,G(F.row.shareToken?.substring(0,12))+"...",1)]),_:2},1032,["content"])]),_:1}),e(Ye,{prop:"createTime",label:"创建时间",width:"180"},{default:a(F=>[_(G(k(pt)(F.row.createTime).format("YYYY-MM-DD HH:mm")),1)]),_:1}),e(Ye,{label:"过期时间",width:"200"},{default:a(F=>[F.row.editingExpire?(w(),le(je,{key:1,modelValue:F.row.tempExpireTime,"onUpdate:modelValue":be=>F.row.tempExpireTime=be,type:"datetime",size:"small",format:"YYYY-MM-DD HH:mm","value-format":"YYYY-MM-DD HH:mm:ss",onBlur:be=>ma(F.row),onChange:be=>ma(F.row),ref:"expireInput",style:{width:"180px"},"disabled-date":be=>be<new Date},null,8,["modelValue","onUpdate:modelValue","onBlur","onChange","disabled-date"])):(w(),P("div",{key:0,onDblclick:be=>Gt(F.row),class:me(["editable-cell",{"expire-warning":ce(F.row)}]),title:"双击编辑过期时间"},[_(G(k(pt)(F.row.expireTime).format("YYYY-MM-DD HH:mm"))+" ",1),e(k(oe),{icon:"material-symbols:edit",class:"edit-icon"})],42,Sp))]),_:1}),e(Ye,{label:"分享链接","min-width":"280"},{default:a(F=>[s("div",Lp,[s("div",Tp,[s("a",{href:F.row.shareUrl,target:"_blank",class:"share-url-link",title:"点击在新标签页中打开分享页面"},G(F.row.shareUrl),9,Dp)]),e(Q,{size:"small",onClick:be=>Me(F.row.shareUrl),class:"copy-btn",title:"复制分享链接"},{default:a(()=>[e(k(oe),{icon:"material-symbols:content-copy"})]),_:2},1032,["onClick"])])]),_:1}),e(Ye,{label:"操作",width:"280",fixed:"right"},{default:a(F=>[Ie((w(),le(Q,{size:"small",type:"primary",onClick:be=>Le(F.row),icon:k(ao)},{default:a(()=>[...n[77]||(n[77]=[_(" 刷新Token ",-1)])]),_:2},1032,["onClick","icon"])),[[mt,"share:create"]]),Ie((w(),le(Q,{size:"small",type:"warning",onClick:be=>Fa(F.row),icon:k(lo)},{default:a(()=>[...n[78]||(n[78]=[_(" 高级设置 ",-1)])]),_:2},1032,["onClick","icon"])),[[mt,"share:create"]]),Ie((w(),le(Q,{size:"small",onClick:be=>ht(F.row)},{default:a(()=>[...n[79]||(n[79]=[_(" 访问日志 ",-1)])]),_:2},1032,["onClick"])),[[mt,"share:create"]]),Ie((w(),le(Q,{type:"danger",size:"small",onClick:be=>rt(F.row),icon:k(ll)},{default:a(()=>[...n[80]||(n[80]=[_(" 删除 ",-1)])]),_:2},1032,["onClick","icon"])),[[mt,"share:delete"]])]),_:1})]),_:1},8,["data"])),[[Ln,t.value]])])]),_:1}),e(We,{label:"访问日志",name:"logs"},{default:a(()=>[e(rc)]),_:1})]),_:1},8,["modelValue"]),e(Ju,{modelValue:d.value,"onUpdate:modelValue":n[20]||(n[20]=F=>d.value=F),onCreated:fe},null,8,["modelValue"]),e(Cn,{modelValue:f.value,"onUpdate:modelValue":n[21]||(n[21]=F=>f.value=F),onUpdated:$t},null,8,["modelValue"]),e($n,{modelValue:x.value,"onUpdate:modelValue":n[22]||(n[22]=F=>x.value=F),"share-data":E.value,onUpdated:Ua},null,8,["modelValue","share-data"]),e(jm,{modelValue:h.value,"onUpdate:modelValue":n[23]||(n[23]=F=>h.value=F),"selected-shares":r.value,onUpdated:kt},null,8,["modelValue","selected-shares"]),e(pl,{modelValue:W.value,"onUpdate:modelValue":n[24]||(n[24]=F=>W.value=F),title:"授权邮箱列表",width:"500px",onClose:we},{footer:a(()=>[e(Q,{onClick:we},{default:a(()=>[...n[85]||(n[85]=[_("关闭",-1)])]),_:1})]),default:a(()=>[C.value?(w(),P("div",Rp,[s("div",Ap,[s("p",null,[n[81]||(n[81]=s("strong",null,"分享名称：",-1)),_(G(C.value.shareName),1)]),n[83]||(n[83]=s("p",null,[s("strong",null,"分享类型："),_("多邮箱验证分享")],-1)),s("p",null,[n[82]||(n[82]=s("strong",null,"授权邮箱数：",-1)),_(G(xe(C.value)),1)])]),s("div",Ip,[n[84]||(n[84]=s("h4",null,"授权邮箱列表：",-1)),s("div",Fp,[(w(!0),P(Ee,null,Te(ne(C.value),(F,be)=>(w(),le(de,{key:be,closable:"",onClose:Pp=>L(be),class:"email-tag"},{default:a(()=>[_(G(F),1)]),_:2},1032,["onClose"]))),128))])])])):ee("",!0)]),_:1},8,["modelValue"]),e(pl,{modelValue:v.value,"onUpdate:modelValue":n[27]||(n[27]=F=>v.value=F),title:"自定义延长天数",width:"400px"},{footer:a(()=>[e(Q,{onClick:n[26]||(n[26]=F=>v.value=!1)},{default:a(()=>[...n[87]||(n[87]=[_("取消",-1)])]),_:1}),e(Q,{type:"primary",onClick:et},{default:a(()=>[...n[88]||(n[88]=[_("确定",-1)])]),_:1})]),default:a(()=>[e(Sn,{"label-width":"80px"},{default:a(()=>[e(kn,{label:"延长天数"},{default:a(()=>[e(ke,{modelValue:g.value,"onUpdate:modelValue":n[25]||(n[25]=F=>g.value=F),min:1,max:365,step:1,placeholder:"请输入天数"},null,8,["modelValue"]),n[86]||(n[86]=s("span",{style:{"margin-left":"10px",color:"var(--el-text-color-secondary)"}},"天",-1))]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(kc,{modelValue:N.value,"onUpdate:modelValue":n[28]||(n[28]=F=>N.value=F),"share-data":S.value,onClosed:n[29]||(n[29]=F=>S.value=null)},null,8,["modelValue","share-data"])])}}}),Df=vt(Up,[["__scopeId","data-v-1dbc17dc"]]);export{Df as default};

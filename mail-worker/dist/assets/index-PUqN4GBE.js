import{a9 as B,ae as U,aa as C,A as p,F as A,e as v,g as s,O as b,a7 as i,t,h as V,q as f,ad as d,a6 as D,o as w,i as y,aq as I,ar as T,as as q,a8 as F}from"./index-92mnh-J5.js";import{E as L}from"./el-overlay-jTA8uYnN.js";/* empty css                  *//* empty css                 */import{d as O}from"./account-D0SRpcz3.js";/* empty css                       */import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as z}from"./vnode-DfneDD37.js";import{E as G}from"./index-CG9L6tLM.js";import{E as H}from"./index-B-u1Rqw0.js";import"./index-ChZfA3gH.js";import"./validator-Cw4sOcG_.js";const J={class:"box"},K={class:"container"},Q={class:"title"},R={class:"item"},W={key:0,class:"edit-name-input"},X={key:1,class:"user-name"},Y={class:"item"},Z={class:"item"},x={class:"del-email"},ee={class:"title"},se={style:{color:"var(--regular-text-color)"}},te={class:"update-pwd"},ae=Object.assign({name:"setting"},{__name:"index",setup(oe){const{t:o}=B(),$=U(),r=C(),c=p(!1),g=p(!1),u=p(null);function P(){u.value=r.user.name,g.value=!0}function S(){if(!u.value){d({message:o("emptyUserNameMsg"),type:"error",plain:!0});return}g.value=!1;let e=u.value;e!==r.user.name&&(r.user.name=u.value,O(r.user.accountId,e).then(()=>{d({message:o("saveSuccessMsg"),type:"success",plain:!0}),$.changeUserAccountName=e}).catch(()=>{r.user.name=e}))}const m=p(!1),a=A({password:"",newPwd:""}),k=()=>{H.confirm(o("delAccountConfirm"),{confirmButtonText:o("confirm"),cancelButtonText:o("cancel"),type:"warning"}).then(()=>{T().then(()=>{q.removeItem("token"),F.replace("/login"),d({message:o("delSuccessMsg"),type:"success",plain:!0})})})};function E(){if(!a.password){d({message:o("emptyPwdMsg"),type:"error",plain:!0});return}if(a.password.length<6){d({message:o("pwdLengthMsg"),type:"error",plain:!0});return}if(a.password!==a.newPwd){d({message:o("confirmPwdFailMsg"),type:"error",plain:!0});return}c.value=!0,I(a.password).then(()=>{d({message:o("saveSuccessMsg"),type:"success",plain:!0}),m.value=!1,c.value=!1,a.password="",a.newPwd=""}).catch(()=>{c.value=!1})}return(e,l)=>{const _=z,h=G,M=L,N=D("perm");return w(),v("div",J,[s("div",K,[s("div",Q,t(e.$t("profile")),1),s("div",R,[s("div",null,t(e.$t("username")),1),s("div",null,[g.value?(w(),v("span",W,[i(_,{modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=n=>u.value=n)},null,8,["modelValue"]),s("span",{class:"edit-name",onClick:S},t(e.$t("save")),1)])):(w(),v("span",X,[s("span",null,t(V(r).user.name),1),s("span",{class:"edit-name",onClick:P},t(e.$t("change")),1)]))])]),s("div",Y,[s("div",null,t(e.$t("emailAccount")),1),s("div",null,t(V(r).user.email),1)]),s("div",Z,[s("div",null,t(e.$t("password")),1),s("div",null,[i(h,{type:"primary",onClick:l[1]||(l[1]=n=>m.value=!0)},{default:f(()=>[y(t(e.$t("changePwdBtn")),1)]),_:1})])])]),b((w(),v("div",x,[s("div",ee,t(e.$t("deleteUser")),1),s("div",se,t(e.$t("delAccountMsg")),1),s("div",null,[i(h,{type:"primary",onClick:k},{default:f(()=>[y(t(e.$t("deleteUserBtn")),1)]),_:1})])])),[[N,"my:delete"]]),i(M,{modelValue:m.value,"onUpdate:modelValue":l[4]||(l[4]=n=>m.value=n),title:e.$t("changePassword"),width:"340"},{default:f(()=>[s("div",te,[i(_,{type:"password",placeholder:e.$t("newPassword"),modelValue:a.password,"onUpdate:modelValue":l[2]||(l[2]=n=>a.password=n),autocomplete:"off"},null,8,["placeholder","modelValue"]),i(_,{type:"password",placeholder:e.$t("confirmPassword"),modelValue:a.newPwd,"onUpdate:modelValue":l[3]||(l[3]=n=>a.newPwd=n),autocomplete:"off"},null,8,["placeholder","modelValue"]),i(h,{type:"primary",loading:c.value,onClick:E},{default:f(()=>[y(t(e.$t("save")),1)]),_:1},8,["loading"])])]),_:1},8,["modelValue","title"])])}}}),ge=j(ae,[["__scopeId","data-v-b15a38a7"]]);export{ge as default};

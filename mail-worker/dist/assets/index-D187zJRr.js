import{a9 as ie,a4 as re,A as m,F as U,l as Y,as as P,G as ue,J as ce,e as q,o as v,g as d,a7 as l,p as V,bg as me,q as c,f as j,t as L,M as de,ag as pe,h as r,i as fe,ad as he,a8 as ye}from"./index-92mnh-J5.js";import{E as ve}from"./el-overlay-jTA8uYnN.js";/* empty css                  */import{E as Ee}from"./el-date-picker-panel-BKCkkkEQ.js";/* empty css                 */import"./el-scrollbar-lgMH0mZQ.js";import"./el-tag-Dck20whD.js";import{l as be}from"./index-UYGPyXpS.js";import{E as ge,a as Te}from"./el-select-DGaDXl_M.js";import{s as Se,a as Ce}from"./star-BRkLAY2S.js";import{e as ke}from"./index-DzjioUTY.js";import{L as Ve,S as we}from"./LayoutModeSelector-B-li_gUo.js";import{E as _e}from"./EmailDetailPane-CMJxr8Q_.js";import{s as De}from"./time-utils-8_bD8pZw.js";import{u as je}from"./email-9j19DGMK.js";import{b as Le,a as $e,c as Be,d as Ie}from"./all-email-C1E0Fb3X.js";import{I as S}from"./iconify-VCTUy_UH.js";import{a as R}from"./day-DI1_lKIq.js";/* empty css                       */import{_ as Me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{E as Ne}from"./vnode-DfneDD37.js";import{E as Ue}from"./index-CG9L6tLM.js";import{E as Ye}from"./index-B-u1Rqw0.js";import"./dayjs.min-BodJrPHb.js";import"./index-ChZfA3gH.js";import"./index-C8SbU5-9.js";import"./el-empty-CKfYwwv3.js";import"./el-tooltip-l0sNRNKZ.js";import"./el-checkbox-DpAuy9Ti.js";import"./el-skeleton-item-UTnpAQ6A.js";import"./email-highlight-utils-Dx-h0BtP.js";import"./clipboard-utils-Bf-9Um4a.js";import"./throttle-BQKBmdXm.js";import"./validator-Cw4sOcG_.js";const Pe={class:"email-list-box"},qe={class:"page-header"},Re={class:"header-left"},Ae={class:"search-type"},He={class:"search-info"},Je={key:0,class:"result-count"},Oe={class:"header-right"},Fe={class:"clear-email"},ze={class:"clear-button"},Ge=Object.assign({name:"all-email"},{__name:"index",setup(We){const{t:i}=ie(),p=je(),$=re(),f=m(""),h=m({}),u=m(""),B=m(),C=m(!1),w=m(!1),k=m(!1),E=m(0),y=m(null),A=()=>{B.value.toggleMenu()},e=U({timeSort:0,type:"receive",userEmail:null,accountEmail:null,name:null,subject:null,allContent:null,searchType:"allContent"}),o=U({subject:"",sendEmail:"",sendName:"",startTime:"",toEmail:"",endTime:"",type:"eq"});function I(){o.subject="",o.sendEmail="",o.sendName="",o.startTime="",o.toEmail="",o.endTime=""}function H(){I(),o.type="eq",o.endTime="",f.value=null}const J=Y(()=>{if(e.searchType==="user")return i("user");if(e.searchType==="account")return i("selectEmail");if(e.searchType==="name")return i("sender");if(e.searchType==="subject")return i("subject");if(e.searchType==="allContent")return i("allContent")}),O=Y(()=>e.searchType==="allContent"?i("searchAllContent"):i("searchByContent")),b=P.getJSON("all-email-params");b&&(e.type=b.type,e.timeSort=b.timeSort,e.status=b.status,e.searchType=b.searchType);let _=null;ue(()=>e,async()=>{_&&clearTimeout(_),_=setTimeout(async()=>{await P.setJSON("all-email-params",e)},500)},{deep:!0});function F(){C.value=!0}function z(){if(f.value&&(o.startTime=R(f.value[0]).format("YYYY-MM-DD HH:mm:ss"),o.endTime=R(f.value[1]).add(1,"day").format("YYYY-MM-DD HH:mm:ss")),!o.sendEmail&&!o.sendName&&!o.subject&&!o.toEmail&&!f.value){C.value=!1;return}Ye.confirm(i("delAllEmailConfirm"),{confirmButtonText:i("confirm"),cancelButtonText:i("cancel"),type:"warning"}).then(()=>{w.value=!0,Ie(o).then(()=>{he({message:i("clearSuccess"),type:"success",plain:!0}),I(),h.value.refreshList()}).finally(()=>{w.value=!1})})}function G(){u.value=null,e.timeSort=0,e.type="receive",e.userEmail=null,e.accountEmail=null,e.name=null,e.subject=null,e.allContent=null,e.searchType="allContent",E.value=0}function g(){e.userEmail=null,e.accountEmail=null,e.name=null,e.subject=null,e.allContent=null,e.searchType==="user"&&(e.userEmail=u.value),e.searchType==="account"&&(e.accountEmail=u.value),e.searchType==="name"&&(e.name=u.value),e.searchType==="subject"&&(e.subject=u.value),e.searchType==="allContent"&&(e.allContent=u.value),h.value.refreshList()}function W(a){if(y.value&&clearTimeout(y.value),!a||a.trim()===""){M();return}k.value=!0,y.value=setTimeout(()=>{g(),k.value=!1},300)}function M(){u.value="",E.value=0,k.value=!1,y.value&&(clearTimeout(y.value),y.value=null),e.userEmail=null,e.accountEmail=null,e.name=null,e.subject=null,e.allContent=null,h.value.refreshList()}function K(){u.value&&u.value.trim()!==""&&g()}function N(){e.timeSort=e.timeSort?0:1,g()}function Q(){g()}function X(a){const{splitLayout:t}=p;t.mode==="none"||typeof window<"u"&&window.innerWidth<1025?Z(a):p.selectEmail(a)}function Z(a){p.contentData.email=a,p.contentData.delType="physics",p.contentData.showStar=!1,p.contentData.showReply=!1,ye.push({name:"content"})}function x(a,t){return Be({emailId:a,size:t,...e}).then(n=>(n&&n.total!==void 0&&(E.value=n.total),n))}ce(()=>{p.loadSplitLayoutFromStorage(),le()});const ee=new Set;async function le(){for(;;){const a=h.value.latestEmail?.emailId||0;if(!h.value.firstLoad&&$.settings.autoRefreshTime)try{const t=await Le(a);t.length>0&&t.forEach(n=>{ee.add(n.emailId),h.value.addItem(n)})}catch(t){console.error(t)}await De($.settings.autoRefreshTime*1e3)}}return(a,t)=>{const n=Te,D=ge,ae=be,te=de,T=Ne,oe=Ee,ne=Ue,se=ve;return v(),q("div",Pe,[d("div",qe,[d("div",Re,[l(T,{modelValue:u.value,"onUpdate:modelValue":t[1]||(t[1]=s=>u.value=s),placeholder:O.value,class:"search-input",clearable:"",onInput:W,onClear:M},me({prefix:c(()=>[d("div",{onClick:pe(A,["stop"])},[l(D,{ref_key:"mySelect",ref:B,modelValue:e.searchType,"onUpdate:modelValue":t[0]||(t[0]=s=>e.searchType=s),placeholder:a.$t("select"),class:"select",onChange:K},{default:c(()=>[l(n,{key:"5",label:a.$t("allContent"),value:"allContent"},null,8,["label"]),l(n,{key:"3",label:a.$t("sender"),value:"name"},null,8,["label"]),l(n,{key:"4",label:a.$t("subject"),value:"subject"},null,8,["label"]),l(n,{key:"1",label:a.$t("user"),value:"user"},null,8,["label"]),l(n,{key:"2",label:a.$t("selectEmail"),value:"account"},null,8,["label"])]),_:1},8,["modelValue","placeholder"]),d("div",Ae,[d("span",null,L(J.value),1),l(r(S),{class:"setting-icon",icon:"mingcute:down-small-fill",width:"20",height:"20"})])])]),_:2},[u.value?{name:"suffix",fn:c(()=>[d("div",He,[E.value>0?(v(),q("span",Je,L(a.$t("foundEmails",{count:E.value})),1)):j("",!0),k.value?(v(),V(te,{key:1,class:"is-loading"},{default:c(()=>[l(ae)]),_:1})):j("",!0)])]),key:"0"}:void 0]),1032,["modelValue","placeholder"]),l(D,{modelValue:e.type,"onUpdate:modelValue":t[2]||(t[2]=s=>e.type=s),placeholder:"Select",class:"status-select",onChange:Q},{default:c(()=>[l(n,{key:"1",label:a.$t("all"),value:"all"},null,8,["label"]),l(n,{key:"3",label:a.$t("received"),value:"receive"},null,8,["label"]),l(n,{key:"2",label:a.$t("sent"),value:"send"},null,8,["label"]),l(n,{key:"4",label:a.$t("selectDeleted"),value:"delete"},null,8,["label"]),l(n,{key:"4",label:a.$t("noRecipientTitle"),value:"noone"},null,8,["label"])]),_:1},8,["modelValue"]),l(r(S),{class:"icon",icon:"iconoir:search",onClick:g,width:"20",height:"20"}),e.timeSort===0?(v(),V(r(S),{key:0,class:"icon",onClick:N,icon:"material-symbols-light:timer-arrow-down-outline",width:"28",height:"28"})):(v(),V(r(S),{key:1,class:"icon",onClick:N,icon:"material-symbols-light:timer-arrow-up-outline",width:"28",height:"28"})),l(r(S),{class:"icon clear",icon:"fluent:broom-sparkle-16-regular",width:"22",height:"22",onClick:F})]),d("div",Oe,[l(Ve)])]),l(we,{class:"split-container"},{list:c(()=>[l(ke,{ref_key:"sysEmailScroll",ref:h,"get-emailList":x,"email-delete":r($e),"star-add":r(Ce),"star-cancel":r(Se),"show-star":!1,"show-user-info":"","show-status":"",actionLeft:"4px","show-account-icon":!1,onJump:X,onRefreshBefore:G,type:"all-email"},null,8,["email-delete","star-add","star-cancel"])]),detail:c(()=>[r(p).splitLayout?.showDetailPane?(v(),V(_e,{key:0})):j("",!0)]),_:1}),l(se,{modelValue:C.value,"onUpdate:modelValue":t[9]||(t[9]=s=>C.value=s),title:a.$t("clearEmail"),width:"335",onClosed:H},{default:c(()=>[d("div",Fe,[l(T,{modelValue:o.sendName,"onUpdate:modelValue":t[3]||(t[3]=s=>o.sendName=s),placeholder:a.$t("sender")},null,8,["modelValue","placeholder"]),l(T,{modelValue:o.subject,"onUpdate:modelValue":t[4]||(t[4]=s=>o.subject=s),placeholder:a.$t("subject")},null,8,["modelValue","placeholder"]),l(T,{modelValue:o.sendEmail,"onUpdate:modelValue":t[5]||(t[5]=s=>o.sendEmail=s),placeholder:a.$t("sendEmailAddress")},null,8,["modelValue","placeholder"]),l(T,{modelValue:o.toEmail,"onUpdate:modelValue":t[6]||(t[6]=s=>o.toEmail=s),placeholder:a.$t("toEmail")},null,8,["modelValue","placeholder"]),l(oe,{"popper-class":"my-date-picker",modelValue:f.value,"onUpdate:modelValue":t[7]||(t[7]=s=>f.value=s),type:"daterange",teleported:!1,"unlink-panels":"","range-separator":r(i)("to"),size:"default"},null,8,["modelValue","range-separator"]),d("div",ze,[l(D,{modelValue:o.type,"onUpdate:modelValue":t[8]||(t[8]=s=>o.type=s),style:{width:"200px"}},{default:c(()=>[l(n,{key:"eq",label:r(i)("equal"),value:"eq"},null,8,["label"]),l(n,{key:"left",label:r(i)("leading"),value:"left"},null,8,["label"]),l(n,{key:"include",label:r(i)("include"),value:"include"},null,8,["label"])]),_:1},8,["modelValue"]),l(ne,{loading:w.value,type:"primary",onClick:z},{default:c(()=>[fe(L(r(i)("clear")),1)]),_:1},8,["loading"])])])]),_:1},8,["modelValue","title"])])}}}),jl=Me(Ge,[["__scopeId","data-v-e438fa27"]]);export{jl as default};

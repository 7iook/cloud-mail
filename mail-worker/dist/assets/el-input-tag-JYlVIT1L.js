import{N as ne,U as se,D as q,b as ze,aQ as Le,S as $e,aF as Ae,E as Y,d as de,ak as be,A as Z,l as h,G as Fe,c as ue,bn as Oe,b_ as Ue,by as Ke,k as Te,_ as xe,a as Ce,b$ as qe,e as H,o as T,f as Q,g as K,h as a,n as V,r as X,p as A,O as ce,Q as fe,af as ge,q as F,i as re,t as J,ag as ve,a7 as je,c0 as Ge,s as He,bk as Qe,P as We,aj as pe,bA as Xe,M as me,j as Je,w as Ye}from"./index-92mnh-J5.js";import{t as he,a as ie,E as Ze}from"./el-tag-Dck20whD.js";import{I as Ee,C as x,U as W,d as ea,e as aa,u as ta}from"./vnode-DfneDD37.js";import{e as la,u as oa,g as na,h as sa}from"./index-CG9L6tLM.js";import{d as ye}from"./index-ChZfA3gH.js";import{c as ra,u as ia}from"./el-select-DGaDXl_M.js";const ua=ze({modelValue:{type:de(Array)},max:Number,tagType:{...he.type,default:"info"},tagEffect:he.effect,trigger:{type:de(String),default:Y.enter},draggable:Boolean,delimiter:{type:[String,RegExp],default:""},size:Ae,clearable:Boolean,clearIcon:{type:$e,default:Le},disabled:{type:Boolean,default:void 0},validateEvent:{type:Boolean,default:!0},readonly:Boolean,autofocus:Boolean,id:{type:String,default:void 0},tabindex:{type:[String,Number],default:0},maxlength:{type:[String,Number]},minlength:{type:[String,Number]},placeholder:String,autocomplete:{type:String,default:"off"},saveOnBlur:{type:Boolean,default:!0},collapseTags:Boolean,collapseTagsTooltip:Boolean,maxCollapseTags:{type:Number,default:1},ariaLabel:String}),da={[W]:e=>se(e)||q(e),[x]:e=>se(e)||q(e),[Ee]:e=>ne(e),"add-tag":e=>ne(e)||se(e),"remove-tag":e=>ne(e),focus:e=>e instanceof FocusEvent,blur:e=>e instanceof FocusEvent,clear:()=>!0};function ca({props:e,emit:r,formItem:g}){const p=la(),w=oa(),y=be(),n=Z(),c=Z(),C=h(()=>["small"].includes(w.value)?"small":"default"),u=h(()=>{var t;return(t=e.modelValue)!=null&&t.length?void 0:e.placeholder}),b=h(()=>!(e.readonly||p.value)),s=h(()=>{var t,o;return q(e.max)?!1:((o=(t=e.modelValue)==null?void 0:t.length)!=null?o:0)>=e.max}),R=h(()=>{var t;return e.collapseTags?(t=e.modelValue)==null?void 0:t.slice(0,e.maxCollapseTags):e.modelValue}),M=h(()=>{var t;return e.collapseTags?(t=e.modelValue)==null?void 0:t.slice(e.maxCollapseTags):[]}),f=t=>{var o;const v=[...(o=e.modelValue)!=null?o:[],...ra(t)];r(W,v),r(x,v),r("add-tag",t),n.value=void 0},m=t=>{var o,v;const E=t.split(e.delimiter).filter(S=>S&&S!==t);if(e.max){const S=e.max-((v=(o=e.modelValue)==null?void 0:o.length)!=null?v:0);E.splice(S)}return E.length===1?E[0]:E},i=t=>{if(s.value){n.value=void 0;return}if(!k.value){if(e.delimiter&&n.value){const o=m(n.value);o.length&&f(o)}r(Ee,t.target.value)}},I=t=>{var o;if(!k.value)switch(t.code){case e.trigger:t.preventDefault(),t.stopPropagation(),d();break;case Y.numpadEnter:e.trigger===Y.enter&&(t.preventDefault(),t.stopPropagation(),d());break;case Y.backspace:!n.value&&((o=e.modelValue)!=null&&o.length)&&(t.preventDefault(),t.stopPropagation(),D(e.modelValue.length-1));break}},d=()=>{var t;const o=(t=n.value)==null?void 0:t.trim();!o||s.value||f(o)},D=t=>{var o;const v=((o=e.modelValue)!=null?o:[]).slice(),[E]=v.splice(t,1);r(W,v),r(x,v),r("remove-tag",E)},z=()=>{n.value=void 0,r(W,void 0),r(x,void 0),r("clear")},O=(t,o,v)=>{var E;const S=((E=e.modelValue)!=null?E:[]).slice(),[te]=S.splice(t,1),le=o>t&&v==="before"?-1:o<t&&v==="after"?1:0;S.splice(o+le,0,te),r(W,S),r(x,S)},U=()=>{var t;(t=y.value)==null||t.focus()},B=()=>{var t;(t=y.value)==null||t.blur()},{wrapperRef:P,isFocused:j}=ea(y,{disabled:p,beforeBlur(t){var o;return(o=c.value)==null?void 0:o.isFocusInsideContent(t)},afterBlur(){var t;e.saveOnBlur?d():n.value=void 0,e.validateEvent&&((t=g?.validate)==null||t.call(g,"blur").catch(o=>ye()))}}),{isComposing:k,handleCompositionStart:L,handleCompositionUpdate:ee,handleCompositionEnd:ae}=aa({afterComposition:i});return Fe(()=>e.modelValue,()=>{var t;e.validateEvent&&((t=g?.validate)==null||t.call(g,x).catch(o=>ye()))}),{inputRef:y,wrapperRef:P,tagTooltipRef:c,isFocused:j,isComposing:k,inputValue:n,size:w,tagSize:C,placeholder:u,closable:b,disabled:p,inputLimit:s,showTagList:R,collapseTagList:M,handleDragged:O,handleInput:i,handleKeydown:I,handleAddTag:d,handleRemoveTag:D,handleClear:z,handleCompositionStart:L,handleCompositionUpdate:ee,handleCompositionEnd:ae,focus:U,blur:B}}function fa(){const e=Z(!1);return{hovering:e,handleMouseEnter:()=>{e.value=!0},handleMouseLeave:()=>{e.value=!1}}}function ga({wrapperRef:e,handleDragged:r,afterDragged:g}){const p=ue("input-tag"),w=be(),y=Z(!1);let n,c,C,u;function b(f){return`.${p.e("inner")} .${p.namespace.value}-tag:nth-child(${f+1})`}function s(f,m){n=m,c=e.value.querySelector(b(m)),c&&(c.style.opacity="0.5"),f.dataTransfer.effectAllowed="move"}function R(f,m){if(C=m,f.preventDefault(),f.dataTransfer.dropEffect="move",q(n)||n===m){y.value=!1;return}const i=e.value.querySelector(b(m)).getBoundingClientRect(),I=n+1!==m,d=n-1!==m,D=f.clientX-i.left,z=I?d?.5:1:-1,O=d?I?.5:0:1;D<=i.width*z?u="before":D>i.width*O?u="after":u=void 0;const U=e.value.querySelector(`.${p.e("inner")}`),B=U.getBoundingClientRect(),P=Number.parseFloat(Oe(U,"gap"))/2,j=i.top-B.top;let k=-9999;if(u==="before")k=Math.max(i.left-B.left-P,Math.floor(-P/2));else if(u==="after"){const L=i.right-B.left;k=L+(B.width===L?Math.floor(P/2):P)}Ue(w.value,{top:`${j}px`,left:`${k}px`}),y.value=!!u}function M(f){f.preventDefault(),c&&(c.style.opacity=""),u&&!q(n)&&!q(C)&&n!==C&&r(n,C,u),y.value=!1,n=void 0,c=null,C=void 0,u=void 0,g?.()}return{dropIndicatorRef:w,showDropIndicator:y,handleDragStart:s,handleDragOver:R,handleDragEnd:M}}function va({props:e,isFocused:r,hovering:g,disabled:p,inputValue:w,size:y,validateState:n,validateIcon:c,needStatusIcon:C}){const u=Ke(),b=Te(),s=ue("input-tag"),R=ue("input"),M=h(()=>[s.b(),s.is("focused",r.value),s.is("hovering",g.value),s.is("disabled",p.value),s.m(y.value),s.e("wrapper"),u.class]),f=h(()=>[u.style]),m=h(()=>{var d,D;return[s.e("inner"),s.is("draggable",e.draggable),s.is("left-space",!((d=e.modelValue)!=null&&d.length)&&!b.prefix),s.is("right-space",!((D=e.modelValue)!=null&&D.length)&&!I.value)]}),i=h(()=>{var d;return e.clearable&&!p.value&&!e.readonly&&(((d=e.modelValue)==null?void 0:d.length)||w.value)&&(r.value||g.value)}),I=h(()=>b.suffix||i.value||n.value&&c.value&&C.value);return{ns:s,nsInput:R,containerKls:M,containerStyle:f,innerKls:m,showClear:i,showSuffix:I}}const pa=Ce({name:"ElInputTag",inheritAttrs:!1}),ma=Ce({...pa,props:ua,emits:da,setup(e,{expose:r,emit:g}){const p=e,w=ta(),y=Te(),{form:n,formItem:c}=na(),{inputId:C}=sa(p,{formItemContext:c}),u=h(()=>{var l;return(l=n?.statusIcon)!=null?l:!1}),b=h(()=>c?.validateState||""),s=h(()=>b.value&&qe[b.value]),{inputRef:R,wrapperRef:M,tagTooltipRef:f,isFocused:m,inputValue:i,size:I,tagSize:d,placeholder:D,closable:z,disabled:O,showTagList:U,collapseTagList:B,handleDragged:P,handleInput:j,handleKeydown:k,handleRemoveTag:L,handleClear:ee,handleCompositionStart:ae,handleCompositionUpdate:t,handleCompositionEnd:o,focus:v,blur:E}=ca({props:p,emit:g,formItem:c}),{hovering:S,handleMouseEnter:te,handleMouseLeave:le}=fa(),{calculatorRef:Se,inputStyle:De}=ia(),{dropIndicatorRef:Ve,showDropIndicator:we,handleDragStart:Ie,handleDragOver:ke,handleDragEnd:_e}=ga({wrapperRef:M,handleDragged:P,afterDragged:v}),{ns:_,nsInput:oe,containerKls:Ne,containerStyle:Me,innerKls:Be,showClear:Pe,showSuffix:Re}=va({props:p,hovering:S,isFocused:m,inputValue:i,disabled:O,size:I,validateState:b,validateIcon:s,needStatusIcon:u});return r({focus:v,blur:E}),(l,ya)=>(T(),H("div",{ref_key:"wrapperRef",ref:M,class:V(a(Ne)),style:Je(a(Me)),onMouseenter:a(te),onMouseleave:a(le)},[a(y).prefix?(T(),H("div",{key:0,class:V(a(_).e("prefix"))},[X(l.$slots,"prefix")],2)):Q("v-if",!0),K("div",{class:V(a(Be))},[(T(!0),H(fe,null,ge(a(U),($,N)=>(T(),A(a(ie),{key:N,size:a(d),closable:a(z),type:l.tagType,effect:l.tagEffect,draggable:a(z)&&l.draggable,"disable-transitions":"",onClose:G=>a(L)(N),onDragstart:G=>a(Ie)(G,N),onDragover:G=>a(ke)(G,N),onDragend:a(_e),onDrop:ve(()=>{},["stop"])},{default:F(()=>[X(l.$slots,"tag",{value:$,index:N},()=>[re(J($),1)])]),_:2},1032,["size","closable","type","effect","draggable","onClose","onDragstart","onDragover","onDragend","onDrop"]))),128)),l.collapseTags&&l.modelValue&&l.modelValue.length>l.maxCollapseTags?(T(),A(a(Ze),{key:0,ref_key:"tagTooltipRef",ref:f,disabled:!l.collapseTagsTooltip,"fallback-placements":["bottom","top","right","left"],effect:l.tagEffect,placement:"bottom"},{default:F(()=>[je(a(ie),{closable:!1,size:a(d),type:l.tagType,effect:l.tagEffect,"disable-transitions":""},{default:F(()=>[re(" + "+J(l.modelValue.length-l.maxCollapseTags),1)]),_:1},8,["size","type","effect"])]),content:F(()=>[K("div",{class:V(a(_).e("input-tag-list"))},[(T(!0),H(fe,null,ge(a(B),($,N)=>(T(),A(a(ie),{key:N,size:a(d),closable:a(z),type:l.tagType,effect:l.tagEffect,"disable-transitions":"",onClose:G=>a(L)(N+l.maxCollapseTags)},{default:F(()=>[X(l.$slots,"tag",{value:$,index:N+l.maxCollapseTags},()=>[re(J($),1)])]),_:2},1032,["size","closable","type","effect","onClose"]))),128))],2)]),_:3},8,["disabled","effect"])):Q("v-if",!0),K("div",{class:V(a(_).e("input-wrapper"))},[ce(K("input",He({id:a(C),ref_key:"inputRef",ref:R,"onUpdate:modelValue":$=>Qe(i)?i.value=$:null},a(w),{type:"text",minlength:l.minlength,maxlength:l.maxlength,disabled:a(O),readonly:l.readonly,autocomplete:l.autocomplete,tabindex:l.tabindex,placeholder:a(D),autofocus:l.autofocus,ariaLabel:l.ariaLabel,class:a(_).e("input"),style:a(De),onCompositionstart:a(ae),onCompositionupdate:a(t),onCompositionend:a(o),onInput:a(j),onKeydown:a(k)}),null,16,["id","onUpdate:modelValue","minlength","maxlength","disabled","readonly","autocomplete","tabindex","placeholder","autofocus","ariaLabel","onCompositionstart","onCompositionupdate","onCompositionend","onInput","onKeydown"]),[[Ge,a(i)]]),K("span",{ref_key:"calculatorRef",ref:Se,"aria-hidden":"true",class:V(a(_).e("input-calculator")),textContent:J(a(i))},null,10,["textContent"])],2),ce(K("div",{ref_key:"dropIndicatorRef",ref:Ve,class:V(a(_).e("drop-indicator"))},null,2),[[We,a(we)]])],2),a(Re)?(T(),H("div",{key:1,class:V(a(_).e("suffix"))},[X(l.$slots,"suffix"),a(Pe)?(T(),A(a(me),{key:0,class:V([a(_).e("icon"),a(_).e("clear")]),onMousedown:ve(a(Xe),["prevent"]),onClick:a(ee)},{default:F(()=>[(T(),A(pe(l.clearIcon)))]),_:1},8,["class","onMousedown","onClick"])):Q("v-if",!0),a(b)&&a(s)&&a(u)?(T(),A(a(me),{key:1,class:V([a(oe).e("icon"),a(oe).e("validateIcon"),a(oe).is("loading",a(b)==="validating")])},{default:F(()=>[(T(),A(pe(a(s))))]),_:1},8,["class"])):Q("v-if",!0)],2)):Q("v-if",!0)],46,["onMouseenter","onMouseleave"]))}});var ha=xe(ma,[["__file","input-tag.vue"]]);const Va=Ye(ha);export{Va as E};

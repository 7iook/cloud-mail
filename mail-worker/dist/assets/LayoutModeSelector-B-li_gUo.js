import{z as L,I as ge,l as z,A as E,e as C,G as B,J as Z,K as ee,o as w,r as D,j as Pe,h as A,k as ye,p as te,H as M,aj as Me,a1 as U,L as we,q as T,a7 as F,g as Q,Q as Le,af as Ee,n as ke,ad as X}from"./index-92mnh-J5.js";import{u as ne}from"./email-9j19DGMK.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./el-tooltip-l0sNRNKZ.js";import{E as Re}from"./el-tag-Dck20whD.js";/* empty css                  */import{E as be}from"./index-CG9L6tLM.js";const Ne={__name:"splitpanes",props:{horizontal:{type:Boolean,default:!1},pushOtherPanes:{type:Boolean,default:!0},maximizePanes:{type:Boolean,default:!0},rtl:{type:Boolean,default:!1},firstSplitter:{type:Boolean,default:!1}},emits:["ready","resize","resized","pane-click","pane-maximize","pane-add","pane-remove","splitter-click","splitter-dblclick"],setup(k,{emit:c}){const m=c,u=k,P=ye(),s=E([]),d=z(()=>s.value.reduce((e,t)=>(e[~~t.id]=t)&&e,{})),x=z(()=>s.value.length),p=E(null),h=E(!1),v=E({mouseDown:!1,dragging:!1,activeSplitter:null,cursorOffset:0}),g=E({splitter:null,timeoutId:null}),R=z(()=>({[`splitpanes splitpanes--${u.horizontal?"horizontal":"vertical"}`]:!0,"splitpanes--dragging":v.value.dragging})),b=()=>{document.addEventListener("mousemove",r,{passive:!1}),document.addEventListener("mouseup",y),"ontouchstart"in window&&(document.addEventListener("touchmove",r,{passive:!1}),document.addEventListener("touchend",y))},N=()=>{document.removeEventListener("mousemove",r,{passive:!1}),document.removeEventListener("mouseup",y),"ontouchstart"in window&&(document.removeEventListener("touchmove",r,{passive:!1}),document.removeEventListener("touchend",y))},I=(e,t)=>{const i=e.target.closest(".splitpanes__splitter");if(i){const{left:n,top:a}=i.getBoundingClientRect(),{clientX:l,clientY:o}="ontouchstart"in window&&e.touches?e.touches[0]:e;v.value.cursorOffset=u.horizontal?o-a:l-n}b(),v.value.mouseDown=!0,v.value.activeSplitter=t},r=e=>{v.value.mouseDown&&(e.preventDefault(),v.value.dragging=!0,requestAnimationFrame(()=>{oe(se(e)),S("resize",{event:e},!0)}))},y=e=>{v.value.dragging&&(window.getSelection().removeAllRanges(),S("resized",{event:e},!0)),v.value.mouseDown=!1,v.value.activeSplitter=null,setTimeout(()=>{v.value.dragging=!1,N()},100)},j=(e,t)=>{"ontouchstart"in window&&(e.preventDefault(),g.value.splitter===t?(clearTimeout(g.value.timeoutId),g.value.timeoutId=null,V(e,t),g.value.splitter=null):(g.value.splitter=t,g.value.timeoutId=setTimeout(()=>g.value.splitter=null,500))),v.value.dragging||S("splitter-click",{event:e,index:t},!0)},V=(e,t)=>{if(S("splitter-dblclick",{event:e,index:t},!0),u.maximizePanes){let i=0;s.value=s.value.map((n,a)=>(n.size=a===t?n.max:n.min,a!==t&&(i+=n.min),n)),s.value[t].size-=i,S("pane-maximize",{event:e,index:t,pane:s.value[t]}),S("resized",{event:e,index:t},!0)}},ie=(e,t)=>{S("pane-click",{event:e,index:d.value[t].index,pane:d.value[t]})},se=e=>{const t=p.value.getBoundingClientRect(),{clientX:i,clientY:n}="ontouchstart"in window&&e.touches?e.touches[0]:e;return{x:i-(u.horizontal?0:v.value.cursorOffset)-t.left,y:n-(u.horizontal?v.value.cursorOffset:0)-t.top}},le=e=>{e=e[u.horizontal?"y":"x"];const t=p.value[u.horizontal?"clientHeight":"clientWidth"];return u.rtl&&!u.horizontal&&(e=t-e),e*100/t},oe=e=>{const t=v.value.activeSplitter;let i={prevPanesSize:W(t),nextPanesSize:O(t),prevReachedMinPanes:0,nextReachedMinPanes:0};const n=0+(u.pushOtherPanes?0:i.prevPanesSize),a=100-(u.pushOtherPanes?0:i.nextPanesSize),l=Math.max(Math.min(le(e),a),n);let o=[t,t+1],f=s.value[o[0]]||null,_=s.value[o[1]]||null;const G=f.max<100&&l>=f.max+i.prevPanesSize,_e=_.max<100&&l<=100-(_.max+O(t+1));if(G||_e){G?(f.size=f.max,_.size=Math.max(100-f.max-i.prevPanesSize-i.nextPanesSize,0)):(f.size=Math.max(100-_.max-i.prevPanesSize-O(t+1),0),_.size=_.max);return}if(u.pushOtherPanes){const K=ue(i,l);if(!K)return;({sums:i,panesToResize:o}=K),f=s.value[o[0]]||null,_=s.value[o[1]]||null}f!==null&&(f.size=Math.min(Math.max(l-i.prevPanesSize-i.prevReachedMinPanes,f.min),f.max)),_!==null&&(_.size=Math.min(Math.max(100-l-i.nextPanesSize-i.nextReachedMinPanes,_.min),_.max))},ue=(e,t)=>{const i=v.value.activeSplitter,n=[i,i+1];return t<e.prevPanesSize+s.value[n[0]].min&&(n[0]=re(i).index,e.prevReachedMinPanes=0,n[0]<i&&s.value.forEach((a,l)=>{l>n[0]&&l<=i&&(a.size=a.min,e.prevReachedMinPanes+=a.min)}),e.prevPanesSize=W(n[0]),n[0]===void 0)?(e.prevReachedMinPanes=0,s.value[0].size=s.value[0].min,s.value.forEach((a,l)=>{l>0&&l<=i&&(a.size=a.min,e.prevReachedMinPanes+=a.min)}),s.value[n[1]].size=100-e.prevReachedMinPanes-s.value[0].min-e.prevPanesSize-e.nextPanesSize,null):t>100-e.nextPanesSize-s.value[n[1]].min&&(n[1]=de(i).index,e.nextReachedMinPanes=0,n[1]>i+1&&s.value.forEach((a,l)=>{l>i&&l<n[1]&&(a.size=a.min,e.nextReachedMinPanes+=a.min)}),e.nextPanesSize=O(n[1]-1),n[1]===void 0)?(e.nextReachedMinPanes=0,s.value.forEach((a,l)=>{l<x.value-1&&l>=i+1&&(a.size=a.min,e.nextReachedMinPanes+=a.min)}),s.value[n[0]].size=100-e.prevPanesSize-O(n[0]-1),null):{sums:e,panesToResize:n}},W=e=>s.value.reduce((t,i,n)=>t+(n<e?i.size:0),0),O=e=>s.value.reduce((t,i,n)=>t+(n>e+1?i.size:0),0),re=e=>[...s.value].reverse().find(t=>t.index<e&&t.size>t.min)||{},de=e=>s.value.find(t=>t.index>e+1&&t.size>t.min)||{},ce=()=>{var e;const t=Array.from(((e=p.value)==null?void 0:e.children)||[]);for(const i of t){const n=i.classList.contains("splitpanes__pane"),a=i.classList.contains("splitpanes__splitter");!n&&!a&&(i.remove(),console.warn("Splitpanes: Only <pane> elements are allowed at the root of <splitpanes>. One of your DOM nodes was removed."))}},H=(e,t,i=!1)=>{const n=e-1,a=document.createElement("div");a.classList.add("splitpanes__splitter"),i||(a.onmousedown=l=>I(l,n),typeof window<"u"&&"ontouchstart"in window&&(a.ontouchstart=l=>I(l,n)),a.onclick=l=>j(l,n+1)),a.ondblclick=l=>V(l,n+1),t.parentNode.insertBefore(a,t)},ve=e=>{e.onmousedown=void 0,e.onclick=void 0,e.ondblclick=void 0,e.remove()},$=()=>{var e;const t=Array.from(((e=p.value)==null?void 0:e.children)||[]);for(const n of t)n.className.includes("splitpanes__splitter")&&ve(n);let i=0;for(const n of t)n.className.includes("splitpanes__pane")&&(!i&&u.firstSplitter?H(i,n,!0):i&&H(i,n),i++)},me=({uid:e,...t})=>{const i=d.value[e];for(const[n,a]of Object.entries(t))i[n]=a},pe=e=>{var t;let i=-1;Array.from(((t=p.value)==null?void 0:t.children)||[]).some(n=>(n.className.includes("splitpanes__pane")&&i++,n.isSameNode(e.el))),s.value.splice(i,0,{...e,index:i}),s.value.forEach((n,a)=>n.index=a),h.value&&U(()=>{$(),q({addedPane:s.value[i]}),S("pane-add",{pane:s.value[i]})})},fe=e=>{const t=s.value.findIndex(n=>n.id===e);s.value[t].el=null;const i=s.value.splice(t,1)[0];s.value.forEach((n,a)=>n.index=a),U(()=>{$(),S("pane-remove",{pane:i}),q({removedPane:{...i}})})},q=(e={})=>{!e.addedPane&&!e.removedPane?ze():s.value.some(t=>t.givenSize!==null||t.min||t.max<100)?xe(e):he(),h.value&&S("resized")},he=()=>{const e=100/x.value;let t=0;const i=[],n=[];for(const a of s.value)a.size=Math.max(Math.min(e,a.max),a.min),t-=a.size,a.size>=a.max&&i.push(a.id),a.size<=a.min&&n.push(a.id);t>.1&&J(t,i,n)},ze=()=>{let e=100;const t=[],i=[];let n=0;for(const l of s.value)e-=l.size,l.givenSize!==null&&n++,l.size>=l.max&&t.push(l.id),l.size<=l.min&&i.push(l.id);let a=100;if(e>.1){for(const l of s.value)l.givenSize===null&&(l.size=Math.max(Math.min(e/(x.value-n),l.max),l.min)),a-=l.size;a>.1&&J(a,t,i)}},xe=({addedPane:e,removedPane:t}={})=>{let i=100/x.value,n=0;const a=[],l=[];(e?.givenSize??null)!==null&&(i=(100-e.givenSize)/(x.value-1));for(const o of s.value)n-=o.size,o.size>=o.max&&a.push(o.id),o.size<=o.min&&l.push(o.id);if(!(Math.abs(n)<.1)){for(const o of s.value)e?.givenSize!==null&&e?.id===o.id||(o.size=Math.max(Math.min(i,o.max),o.min)),n-=o.size,o.size>=o.max&&a.push(o.id),o.size<=o.min&&l.push(o.id);n>.1&&J(n,a,l)}},J=(e,t,i)=>{let n;e>0?n=e/(x.value-t.length):n=e/(x.value-i.length),s.value.forEach((a,l)=>{if(e>0&&!t.includes(a.id)){const o=Math.max(Math.min(a.size+n,a.max),a.min),f=o-a.size;e-=f,a.size=o}else if(!i.includes(a.id)){const o=Math.max(Math.min(a.size+n,a.max),a.min),f=o-a.size;e-=f,a.size=o}}),Math.abs(e)>.1&&U(()=>{h.value&&console.warn("Splitpanes: Could not resize panes correctly due to their constraints.")})},S=(e,t=void 0,i=!1)=>{const n=t?.index??v.value.activeSplitter??null;m(e,{...t,...n!==null&&{index:n},...i&&n!==null&&{prevPane:s.value[n-(u.firstSplitter?1:0)],nextPane:s.value[n+(u.firstSplitter?0:1)]},panes:s.value.map(a=>({min:a.min,max:a.max,size:a.size}))})};B(()=>u.firstSplitter,()=>$()),Z(()=>{ce(),$(),q(),S("ready"),h.value=!0}),ee(()=>h.value=!1);const Se=()=>{var e;return we("div",{ref:p,class:R.value},(e=P.default)==null?void 0:e.call(P))};return M("panes",s),M("indexedPanes",d),M("horizontal",z(()=>u.horizontal)),M("requestUpdate",me),M("onPaneAdd",pe),M("onPaneRemove",fe),M("onPaneClick",ie),(e,t)=>(w(),te(Me(Se)))}},Y={__name:"pane",props:{size:{type:[Number,String]},minSize:{type:[Number,String],default:0},maxSize:{type:[Number,String],default:100}},setup(k){var c;const m=k,u=L("requestUpdate"),P=L("onPaneAdd"),s=L("horizontal"),d=L("onPaneRemove"),x=L("onPaneClick"),p=(c=ge())==null?void 0:c.uid,h=L("indexedPanes"),v=z(()=>h.value[p]),g=E(null),R=z(()=>{const r=isNaN(m.size)||m.size===void 0?0:parseFloat(m.size);return Math.max(Math.min(r,N.value),b.value)}),b=z(()=>{const r=parseFloat(m.minSize);return isNaN(r)?0:r}),N=z(()=>{const r=parseFloat(m.maxSize);return isNaN(r)?100:r}),I=z(()=>{var r;return`${s.value?"height":"width"}: ${(r=v.value)==null?void 0:r.size}%`});return B(()=>R.value,r=>u({uid:p,size:r})),B(()=>b.value,r=>u({uid:p,min:r})),B(()=>N.value,r=>u({uid:p,max:r})),Z(()=>{P({id:p,el:g.value,min:b.value,max:N.value,givenSize:m.size===void 0?null:R.value,size:R.value})}),ee(()=>d(p)),(r,y)=>(w(),C("div",{ref_key:"paneEl",ref:g,class:"splitpanes__pane",onClick:y[0]||(y[0]=j=>A(x)(j,r._.uid)),style:Pe(I.value)},[D(r.$slots,"default")],4))}},Oe={class:"split-pane-container"},Be={class:"email-list-pane"},Ce={class:"email-detail-pane"},Ie={key:1,class:"single-pane"},$e={__name:"SplitPaneLayout",setup(k){const c=ne(),m=z(()=>c.splitLayout?.mode||"none");z(()=>c.splitLayout?.showDetailPane||!1);const u=z(()=>{const d=c.splitLayout?.paneSizes||{right:[40,60],bottom:[60,40]};return m.value==="right"?d.right:d.bottom}),P=d=>{c.splitLayout||(c.splitLayout={mode:"none",selectedEmail:null,showDetailPane:!1,paneSizes:{right:[40,60],bottom:[60,40]}}),m.value==="right"?c.splitLayout.paneSizes.right=d:m.value==="bottom"&&(c.splitLayout.paneSizes.bottom=d),localStorage.setItem("emailSplitLayout",JSON.stringify(c.splitLayout))},s=z(()=>typeof window<"u"?window.innerWidth<1025:!1);return B(s,d=>{d&&m.value!=="none"&&c.setSplitMode("none")},{immediate:!0}),(d,x)=>(w(),C("div",Oe,[m.value!=="none"?(w(),te(A(Ne),{key:0,class:"default-theme",horizontal:m.value==="bottom",onResize:P},{default:T(()=>[F(A(Y),{size:u.value[0],"min-size":"30"},{default:T(()=>[Q("div",Be,[D(d.$slots,"list",{},void 0,!0)])]),_:3},8,["size"]),F(A(Y),{size:u.value[1],"min-size":"30"},{default:T(()=>[Q("div",Ce,[D(d.$slots,"detail",{},void 0,!0)])]),_:3},8,["size"])]),_:3},8,["horizontal"])):(w(),C("div",Ie,[D(d.$slots,"list",{},void 0,!0)]))]))}},We=ae($e,[["__scopeId","data-v-6d9d4c68"]]),De={class:"layout-mode-selector"},Ae={__name:"LayoutModeSelector",setup(k){const c=ne(),m=[{value:"none",icon:"View",tooltip:"无阅读窗格 - 点击邮件跳转到详情页"},{value:"right",icon:"Grid",tooltip:"右侧阅读窗格 - 邮件列表在左，详情在右"},{value:"bottom",icon:"Menu",tooltip:"底部阅读窗格 - 邮件列表在上，详情在下"}],u=z(()=>c.splitLayout?.mode||"none"),P=s=>{if(typeof window<"u"&&window.innerWidth<1025&&s!=="none"){X.warning("移动端仅支持无阅读窗格模式");return}c.setSplitMode(s),s!=="none"&&c.splitLayout?.selectedEmail&&(c.splitLayout.showDetailPane=!0),localStorage.setItem("emailSplitLayout",JSON.stringify(c.splitLayout)),X.success(`已切换到${m.find(d=>d.value===s)?.tooltip}`)};return(s,d)=>{const x=be,p=Re;return w(),C("div",De,[(w(),C(Le,null,Ee(m,h=>F(p,{key:h.value,content:h.tooltip,placement:"bottom"},{default:T(()=>[F(x,{type:u.value===h.value?"primary":"default",icon:h.icon,size:"small",circle:"",onClick:v=>P(h.value),class:ke({"active-mode":u.value===h.value})},null,8,["type","icon","onClick","class"])]),_:2},1032,["content"])),64))])}}},He=ae(Ae,[["__scopeId","data-v-193c7a39"]]);export{He as L,We as S};

import{A as w,F as O,bm as j,aI as q,a as z,b5 as R,L as b,q as W,O as D,a7 as F,P as G,T as H,y as S,b8 as K,a1 as I,N as T,bn as h,v as k,V as B,bk as M,bo as Y,at as l}from"./index-92mnh-J5.js";function Z(e,t){let s;const a=w(!1),n=O({...e,originalPosition:"",originalOverflow:"",visible:!1});function o(r){n.text=r}function u(){const r=n.parent,d=f.ns;if(!r.vLoadingAddClassList){let c=r.getAttribute("loading-number");c=Number.parseInt(c)-1,c?r.setAttribute("loading-number",c.toString()):(S(r,d.bm("parent","relative")),r.removeAttribute("loading-number")),S(r,d.bm("parent","hidden"))}g(),m.unmount()}function g(){var r,d;(d=(r=f.$el)==null?void 0:r.parentNode)==null||d.removeChild(f.$el)}function L(){var r;e.beforeClose&&!e.beforeClose()||(a.value=!0,clearTimeout(s),s=setTimeout(i,400),n.visible=!1,(r=e.closed)==null||r.call(e))}function i(){if(!a.value)return;const r=n.parent;a.value=!1,r.vLoadingAddClassList=void 0,u()}const x=z({name:"ElLoading",setup(r,{expose:d}){const{ns:c,zIndex:P}=R("loading");return d({ns:c,zIndex:P}),()=>{const A=n.spinner||n.svg,E=b("svg",{class:"circular",viewBox:n.svgViewBox?n.svgViewBox:"0 0 50 50",...A?{innerHTML:A}:{}},[b("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})]),V=n.text?b("p",{class:c.b("text")},[n.text]):void 0;return b(H,{name:c.b("fade"),onAfterLeave:i},{default:W(()=>[D(F("div",{style:{backgroundColor:n.background||""},class:[c.b("mask"),n.customClass,n.fullscreen?"is-fullscreen":""]},[b("div",{class:c.b("spinner")},[E,V])]),[[G,n.visible]])])})}}}),m=j(x);Object.assign(m._context,t??{});const f=m.mount(document.createElement("div"));return{...q(n),setText:o,removeElLoadingChild:g,close:L,handleAfterLeave:i,vm:f,get $el(){return f.$el}}}let y;const C=function(e={}){if(!K)return;const t=J(e);if(t.fullscreen&&y)return y;const s=Z({...t,closed:()=>{var n;(n=t.closed)==null||n.call(t),t.fullscreen&&(y=void 0)}},C._context);Q(t,t.parent,s),_(t,t.parent,s),t.parent.vLoadingAddClassList=()=>_(t,t.parent,s);let a=t.parent.getAttribute("loading-number");return a?a=`${Number.parseInt(a)+1}`:a="1",t.parent.setAttribute("loading-number",a),t.parent.appendChild(s.$el),I(()=>s.visible.value=t.visible),t.fullscreen&&(y=s),s},J=e=>{var t,s,a,n;let o;return T(e.target)?o=(t=document.querySelector(e.target))!=null?t:document.body:o=e.target||document.body,{parent:o===document.body||e.body?document.body:o,background:e.background||"",svg:e.svg||"",svgViewBox:e.svgViewBox||"",spinner:e.spinner||!1,text:e.text||"",fullscreen:o===document.body&&((s=e.fullscreen)!=null?s:!0),lock:(a=e.lock)!=null?a:!1,customClass:e.customClass||"",visible:(n=e.visible)!=null?n:!0,beforeClose:e.beforeClose,closed:e.closed,target:o}},Q=async(e,t,s)=>{const{nextZIndex:a}=s.vm.zIndex||s.vm._.exposed.zIndex,n={};if(e.fullscreen)s.originalPosition.value=h(document.body,"position"),s.originalOverflow.value=h(document.body,"overflow"),n.zIndex=a();else if(e.parent===document.body){s.originalPosition.value=h(document.body,"position"),await I();for(const o of["top","left"]){const u=o==="top"?"scrollTop":"scrollLeft";n[o]=`${e.target.getBoundingClientRect()[o]+document.body[u]+document.documentElement[u]-Number.parseInt(h(document.body,`margin-${o}`),10)}px`}for(const o of["height","width"])n[o]=`${e.target.getBoundingClientRect()[o]}px`}else s.originalPosition.value=h(t,"position");for(const[o,u]of Object.entries(n))s.$el.style[o]=u},_=(e,t,s)=>{const a=s.vm.ns||s.vm._.exposed.ns;["absolute","fixed","sticky"].includes(s.originalPosition.value)?S(t,a.bm("parent","relative")):k(t,a.bm("parent","relative")),e.fullscreen&&e.lock?k(t,a.bm("parent","hidden")):S(t,a.bm("parent","hidden"))};C._context=null;const p=Symbol("ElLoading"),v=e=>`element-loading-${Y(e)}`,$=(e,t)=>{var s,a,n,o;const u=t.instance,g=r=>B(t.value)?t.value[r]:void 0,L=r=>{const d=T(r)&&u?.[r]||r;return w(d)},i=r=>L(g(r)||e.getAttribute(v(r))),x=(s=g("fullscreen"))!=null?s:t.modifiers.fullscreen,m={text:i("text"),svg:i("svg"),svgViewBox:i("svgViewBox"),spinner:i("spinner"),background:i("background"),customClass:i("customClass"),fullscreen:x,target:(a=g("target"))!=null?a:x?void 0:e,body:(n=g("body"))!=null?n:t.modifiers.body,lock:(o=g("lock"))!=null?o:t.modifiers.lock},f=C(m);f._context=N._context,e[p]={options:m,instance:f}},U=(e,t)=>{for(const s of Object.keys(e))M(e[s])&&(e[s].value=t[s])},N={mounted(e,t){t.value&&$(e,t)},updated(e,t){const s=e[p];if(!t.value){s?.instance.close(),e[p]=null;return}s?U(s.options,B(t.value)?t.value:{text:e.getAttribute(v("text")),svg:e.getAttribute(v("svg")),svgViewBox:e.getAttribute(v("svgViewBox")),spinner:e.getAttribute(v("spinner")),background:e.getAttribute(v("background")),customClass:e.getAttribute(v("customClass"))}):$(e,t)},unmounted(e){var t;(t=e[p])==null||t.instance.close(),e[p]=null}};N._context=null;function ee(e){return l.post("/share/create",e)}function te(e){return l.get(`/share/info/${e}`,{sharePageRequest:!0})}function se(e,t){return l.get(`/share/emails/${e}`,{params:t,sharePageRequest:!0})}function ae(e){return l.get("/share/list",{params:e})}function ne(e){return l.delete(`/share/${e}`)}function re(){return l.get("/setting/query").then(e=>((e.data||e).shareWhitelist||"").split(",").filter(a=>a.trim()))}function oe(e){const t=e.join(",");return l.put("/setting/set",{shareWhitelist:t})}function le(e){const{shareId:t,...s}=e;return t?l.get(`/share/logs/${t}`,{params:s}):l.get("/share/globalStats",{params:s}).then(a=>(console.log("全局统计API响应:",a),console.log("response.accessLogs:",a?.accessLogs),a&&a.accessLogs?(console.log("找到accessLogs，数据长度:",a.accessLogs.length),{data:{list:a.accessLogs,total:a.total||a.accessLogs.length,page:a.page||1,pageSize:a.pageSize||20}}):(console.log("accessLogs不存在，返回空数据"),{data:{list:[],total:0}})))}function ie(e,t={}){return l.get(`/share/stats/${e}`,{params:t})}function ce(e){return l.post(`/share/${e}/refresh-token`)}function ue(e,t,s={}){return l.post("/share/batch",{action:e,shareIds:t,...s})}function de(e,t){return l.post(`/share/${e}/update-limit`,{otpLimitDaily:t})}function ge(e,t){return l.post(`/share/${e}/update-display-limit`,{verificationCodeLimit:t})}function fe(e,t){return l.patch(`/share/${e}/name`,{shareName:t})}function ve(e,t){return l.patch(`/share/${e}/expire`,{expireTime:t})}function me(e,t){return l.patch(`/share/${e}/advanced-settings`,t)}function be(e){return l.get("/share/globalStats",{params:e})}function he(e){return l.get(`/share/access-detail/${e}`)}export{me as a,ue as b,ee as c,ae as d,le as e,be as f,re as g,he as h,ie as i,fe as j,de as k,ge as l,ve as m,ne as n,te as o,se as p,ce as r,oe as u,N as v};
